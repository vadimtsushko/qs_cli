//////THIS IS AUTOGENERATED FILE. DO NOT EDIT IT DIRECTLY!!!!!!!!!!!!!

SET СуммаПродажи = Money(Sum({$<ТипДокумента={'Sales'}, ТипПериода={'Current'}>}Сумма),'# ##0,00');
SET СуммаПродажи.Label = Продажи руб.;
SET СуммаПродажи.Comment = Сумма продаж в руб.;
SET СуммаПродажиТыс = Money(Sum({$<ТипДокумента={'Sales'}, ТипПериода={'Current'}>}Сумма)/1000,'# ##0,00');
SET СуммаПродажиТыс.Label = Продажи тыс.руб.;
SET СуммаПродажиТыс.Comment = Сумма продаж в тыс. руб.;
SET СуммаПродажиТысЧеки = Money(Sum({$<ТипДокумента={'Sales'}, ТипПериода={'Current'}>}Сумма)/1000,'# ##0');
SET СуммаПродажиТысЧеки.Label = Продажи тыс.руб.;
SET СуммаПродажиТысЧеки.Comment = Сумма продаж в тыс. руб.;
let СуммаПродажиТысНавигатор = replace(replace('Money(Sum({$<@(Измерение(ГруппаИзмерений)), ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>}Сумма)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаПродажиТысНавигатор.Label = Продажи тыс.руб.;
SET СуммаПродажиТысНавигатор.Comment = Сумма продаж в тыс. руб.;
SET ПланПродаж = Money(Sum({<_ФлагДействующаяДата={1},ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} Сумма),'# ##0,00');
SET ПланПродаж.Label = План Продаж, руб;
SET ПланПродаж.Comment = План Продаж (за неполный месяц)  руб;
SET ПланПродажТыс = Money(Sum({<_ФлагДействующаяДата={1},ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} Сумма)/1000,'# ##0,00');
SET ПланПродажТыс.Label = План Продаж тыс.руб.;
SET ПланПродажТыс.Comment = План Продаж (за неполный месяц) в тыс. руб.;
SET ПланПродажПолный = Money(Sum({<ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} Сумма),'# ##0,00');
SET ПланПродажПолный.Label = План Продаж за полный месяц, руб;
SET ПланПродажПолный.Comment = План Продаж (за полный месяц)  руб;
SET ПланПродажПолныйТыс = Money(Sum({<ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} Сумма)/1000,'# ##0,00');
SET ПланПродажПолныйТыс.Label = План Продаж за полный месяц, в тыс. руб.;
SET ПланПродажПолныйТыс.Comment = План Продаж (за полный месяц)  в тыс. руб.;
let ПФ_Продажи = replace(replace('Money(@(СуммаПродажи)/@(ПланПродаж),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_Продажи.Label = % вып. плана Продаж;
SET ПФ_Продажи.Comment = Факт отнесенный к плану по продажам;
let П_Ф_Продажи = replace(replace('Money((@(СуммаПродажи)-@(ПланПродаж)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_Продажи.Label = ∆ ПФ Продажи;
SET П_Ф_Продажи.Comment = План минус факт по продажам, руб.;
let П_Ф_ПродажиТыс = replace(replace('Money((@(СуммаПродажи)-@(ПланПродаж))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ПродажиТыс.Label = ∆ П-Ф Продажи тыс. руб.;
SET П_Ф_ПродажиТыс.Comment = План минус факт по продажам тыс. руб.;
SET ПродажиПредГодРуб = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год'}>}Сумма),'# ##0,00');
SET ПродажиПредГодРуб.Label = Продажи пред. (1) Год, руб.;
SET ПродажиПредГодРуб.Comment = Cумма продажи за предыдущий год, руб.;
SET ПродажиПредГод = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год'}>}Сумма)/1000,'# ##0,00');
SET ПродажиПредГод.Label = Продажи пред. (1) Год, тыс. руб.;
SET ПродажиПредГод.Comment = Cумма продажи за предыдущий год тыс.руб.;
SET ПродажиПредГод2Руб = Money((sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год-2'}>}Сумма)),'# ##0,00');
SET ПродажиПредГод2Руб.Label = Продажи пред. (2) Год, руб.;
SET ПродажиПредГод2Руб.Comment = Cумма продажи за предпредыдущий год руб.;
SET ПродажиПредГод2 = Money((sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год-2'}>}Сумма)/1000),'# ##0,00');
SET ПродажиПредГод2.Label = Продажи пред. (2) Год, тыс. руб.;
SET ПродажиПредГод2.Comment = Cумма продажи за предпредыдущий год тыс.руб.;
SET ПродажиПредГодДеньНедели = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодДеньНедели'}>}Сумма)/1000,'# ##0,00');
SET ПродажиПредГодДеньНедели.Label = Продажи пред. (1) Год тот же день недели, тыс. руб.;
SET ПродажиПредГодДеньНедели.Comment = Cумма продажи за предыдущий год тот же день недели, тыс.руб.;
SET ПродажиПредГодДеньНеделиРуб = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодДеньНедели'}>}Сумма),'# ##0,00');
SET ПродажиПредГодДеньНеделиРуб.Label = Продажи пред. (1) Год тот же день недели, руб.;
SET ПродажиПредГодДеньНеделиРуб.Comment = Cумма продажи за предыдущий год тот же день недели, руб.;
SET ПродажиПредГод2ДеньНедели = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год2ДеньНедели'}>}Сумма)/1000,'# ##0,00');
SET ПродажиПредГод2ДеньНедели.Label = Продажи пред. (2) Год тот же день недели, тыс.руб.;
SET ПродажиПредГод2ДеньНедели.Comment = Cумма продажи за предпредыдущий год тот же день недели, тыс.руб.;
SET ПродажиПредГод2ДеньНеделиРуб = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год2ДеньНедели'}>}Сумма),'# ##0,00');
SET ПродажиПредГод2ДеньНеделиРуб.Label = Продажи пред. (2) Год тот же день недели, руб.;
SET ПродажиПредГод2ДеньНеделиРуб.Comment = Cумма продажи за предпредыдущий год тот же день недели, руб.;
let ПроцентПродажиПредГод = replace(replace('Money(@(СуммаПродажиТыс)/@(ПродажиПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредГод.Label = % изм.Продаж к пред. (1) Год;
SET ПроцентПродажиПредГод.Comment = Процент Продажи к предыдущему году;
let ПроцентПродажиПредГодНавигатор = replace(replace('Money(Sum({$<ТипДокумента={~~~Sales~~~}, @(Измерение(ГруппаИзмерений)), ТипПериода={~~~Current~~~}>}Сумма) / sum({<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1}, @(Измерение(ГруппаИзмерений)), ТипПериода={~~~Год~~~}>}Сумма),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредГодНавигатор.Label = % изм.Продаж к пред. (1) Год;
SET ПроцентПродажиПредГодНавигатор.Comment = Процент Продажи к предыдущему году;
let ПроцентПродажиПредГод2 = replace(replace('Money(@(СуммаПродажиТыс)/@(ПродажиПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредГод2.Label = % изм.Продаж к пред. (2) Год;
SET ПроцентПродажиПредГод2.Comment = Процент Продажи к предпредыдущему году;
let СуммаРостаПродажиПредГод = replace(replace('Money(@(СуммаПродажиТыс)-@(ПродажиПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиПредГод.Label = ∆ изм. Продаж к пред. (1) Год;
SET СуммаРостаПродажиПредГод.Comment = Сумма роста Продажи к предыдущему году;
let СуммаРостаПродажиПредГод2 = replace(replace('Money(@(СуммаПродажиТыс)-@(ПродажиПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиПредГод2.Label = ∆ изм. Продаж к пред. (2) Год;
SET СуммаРостаПродажиПредГод2.Comment = Сумма роста Продажи к предпредыдущему году;
let ПроцентПродажиПредГодДеньНедели = replace(replace('Money(@(СуммаПродажиТыс)/@(ПродажиПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредГодДеньНедели.Label = % Продажи к пред. (1) Год тот же день недели, тыс.руб.;
SET ПроцентПродажиПредГодДеньНедели.Comment = Процент Продажи к предыдущему году тот же день недели тыс.руб.;
let ПроцентПродажиПредГод2ДеньНедели = replace(replace('Money(@(СуммаПродажиТыс)/@(ПродажиПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредГод2ДеньНедели.Label = % Продажи к пред. (2) Год тот же день недели, тыс.руб.;
SET ПроцентПродажиПредГод2ДеньНедели.Comment = Процент Продажи к предпредыдущему году тот же день недели тыс.руб.;
let СуммаРостаПродажиПредГодДеньНедели = replace(replace('Money(@(СуммаПродажиТыс)-@(ПродажиПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиПредГодДеньНедели.Label = Сумма роста Продаж к пред. (1) Год тот же день недели, тыс.руб.;
SET СуммаРостаПродажиПредГодДеньНедели.Comment = Сумма роста Продажи к предыдущему году тот же день недели, тыс.руб.;
let СуммаРостаПродажиПредГод2ДеньНедели = replace(replace('Money(@(СуммаПродажиТыс)-@(ПродажиПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиПредГод2ДеньНедели.Label = Сумма роста Продаж к пред. (2) Год тот же день недели тыс.руб.;
SET СуммаРостаПродажиПредГод2ДеньНедели.Comment = Сумма роста Продажи к предпредыдущему году тот же день недели тыс.руб.;
SET ПродажиПредМесРуб = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяц'}>}Сумма),'# ##0,00');
SET ПродажиПредМесРуб.Label = Продажи пред мес, руб.;
SET ПродажиПредМесРуб.Comment = Cумма продажи за предыдущий мес руб.;
SET ПродажиПредМес = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяц'}>}Сумма)/1000,'# ##0,00');
SET ПродажиПредМес.Label = Продажи пред мес, тыс.руб.;
SET ПродажиПредМес.Comment = Cумма продажи за предыдущий мес тыс.руб.;
let ПроцентПродажиПредМес = replace(replace('Money(@(СуммаПродажиТыс)/@(ПродажиПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиПредМес.Label = % Продажи к пред мес;
SET ПроцентПродажиПредМес.Comment = Процент Продажи к предыдущему месяцу;
let СуммаРостаПродажиПредМес = replace(replace('Money(@(СуммаПродажиТыс)-@(ПродажиПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиПредМес.Label = Сумма роста Продаж к пред мес;
SET СуммаРостаПродажиПредМес.Comment = Сумма роста Продажи к предыдущему месяцу;
let ДоляСуммыПродажГруппы = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} Сумма)/Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL <@(Измерение(ГруппаСклад))> Сумма), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыПродажГруппы.Label = Доля продаж в магазине;
SET ДоляСуммыПродажГруппы.Comment = Доля продаж товара в магазине;
let ДоляСуммыПродажСклад = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} Сумма)/Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL <@(Измерение(ГруппаКлассификатор))> Сумма), @(Измерение(ГруппаКлассификатор)), @(Измерение(ГруппаСклад))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыПродажСклад.Label = Доля продаж в группе товаров;
SET ДоляСуммыПродажСклад.Comment = Доля продаж в группе товаров;
let ДоляСуммыПродажКомпании = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} Сумма)/Sum({<Склад,ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL Сумма), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыПродажКомпании.Label = Доля продаж по компании;
SET ДоляСуммыПродажКомпании.Comment = Доля продаж товара по компании в целом;
let ДоляСуммыПродажКомпанииКонструктор = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} Сумма)/Sum({<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL Сумма), @(Измерение(ГруппаИзмерений)), @(Измерение(ГруппаИзмерений2))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыПродажКомпанииКонструктор.Label = Доля продаж по компании;
SET ДоляСуммыПродажКомпанииКонструктор.Comment = Доля продаж товара по компании в целом;
SET СуммаПродажиПроверкаТыс = Money(Sum({$<ТипДокумента={'TestDataSales'}, ТипПериода={'Current'}>}Сумма)/1000,'# ##0,00');
SET СуммаПродажиПроверкаТыс.Label = Продажи проверка тыс.руб.;
SET СуммаПродажиПроверкаТыс.Comment = Сумма продаж проверка в тыс. руб.;
let СуммаПродажиРасхожденияТыс = replace(replace('Money(@(СуммаПродажиТыс) - @(СуммаПродажиПроверкаТыс),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаПродажиРасхожденияТыс.Label = Дельта проверка тыс.руб.;
SET СуммаПродажиРасхожденияТыс.Comment = Дельта продаж проверка в тыс. руб.;
SET РейтингНоменклатурыПоКомпанииТОABC = Min(РейтингНоменклатурыПоКомпанииТО);
SET РейтингНоменклатурыПоКомпанииТОABC.Label = Рейтинг продаж по компании;
SET РейтингНоменклатурыПоКомпанииТОABC.Comment = Рейтинг продаж товара по компании в целом;
SET РейтингНоменклатурыПоМагазинуТОABC = Min(РейтингНоменклатурыПоМагазинуТО);
SET РейтингНоменклатурыПоМагазинуТОABC.Label = Рейтинг продаж по магазину;
SET РейтингНоменклатурыПоМагазинуТОABC.Comment = Рейтинг продаж товара в рамках магазина;
SET КоэффициентВариации = Money(avg(_XyzНоменклатураКоэффВариацииЗаМесяц),'# ##0,00');
SET КоэффициентВариации.Label = Коэффициент Вариации;
SET КоэффициентВариации.Comment = Коэффициент вариации (для расчета XYZ) средненедельный показатель за последние 120 дней;
SET ПродажиКоличество = Money(Sum({$<ТипДокумента ={'Sales'},ТипПериода={'Current'}>}Количество),'# ##0,0');
SET ПродажиКоличество.Label = Кол Проданого товара, шт;
SET ПродажиКоличество.Comment = Количество проданного товара, шт;
SET ПродажиКоличествоБезШкалыЛиквидности = Money(Sum({$<ТипДокумента ={'Sales'},ШкалаЛиквидности,ТипПериода={'Current'}>}Количество),'# ##0,00');
SET ПродажиКоличествоБезШкалыЛиквидности.Label = Кол Продано, шт;
SET ПродажиКоличествоБезШкалыЛиквидности.Comment = Количество проданного товара, шт;
SET ДнейВПериоде = Floor((Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-Min({<_ФлагДействующаяДата={1}>}  TOTAL Дата)+1)/3);
let УсловиеПериод1 = replace(replace('Дата={">@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)))"}','~~~', chr(39)), '@(', chr(36) & '(');
let УсловиеПериод2 = replace(replace('Дата={">@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)*2))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)))"}','~~~', chr(39)), '@(', chr(36) & '(');
let УсловиеПериод3 = replace(replace('Дата={">@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)*3))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)*2))"}','~~~', chr(39)), '@(', chr(36) & '(');
let УсловиеПериод4 = replace(replace('Дата={">=@(=Date(Min({<_ФлагДействующаяДата={1}>} TOTAL Дата)))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} TOTAL Дата)-@(ДнейВПериоде)*3))"}','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод1 = replace(replace('Money(Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~},@(УсловиеПериод1)>}Количество),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод1Заголовок = replace(replace('~~~Продажи c ~~~  & Min({<@(УсловиеПериод1)>} Дата) & ~~~ по ~~~ & Max({<@(УсловиеПериод1)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод2 = replace(replace('Money(Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~},@(УсловиеПериод2)>}Количество),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод2Заголовок = replace(replace('~~~Продажи c ~~~  & Min({<@(УсловиеПериод2)>} Дата) & ~~~ по ~~~ & Max({<@(УсловиеПериод2)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод3 = replace(replace('Money(Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~},@(УсловиеПериод3)>}Количество),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод3Заголовок = replace(replace('~~~Продажи c ~~~  & Min({<@(УсловиеПериод3)>} Дата) & ~~~ по ~~~ & Max({<@(УсловиеПериод3)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод4 = replace(replace('Money(Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~},@(УсловиеПериод4)>}Количество),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиКоличествоПериод4Заголовок = replace(replace('~~~Продажи c ~~~  & Min({<@(УсловиеПериод4)>} Дата) & ~~~ по ~~~ & Max({<@(УсловиеПериод4)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
SET УсловиеПоказаПериод4 = Max(Дата)-Min(Дата)>3 AND Mod(Max(Дата)-Min(Дата)+1,3);
SET ПродажиКоличествоПредМес = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяц'}>}Количество),'# ##0,00');
SET ПродажиКоличествоПредМес.Label = Продажи количество пред мес;
SET ПродажиКоличествоПредМес.Comment = Количество продано за предыдущий мес;
let ПроцентПродажиКоличествоПредМес = replace(replace('Money(@(ПродажиКоличество)/@(ПродажиКоличествоПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиКоличествоПредМес.Label = % Количество продано к пред мес;
SET ПроцентПродажиКоличествоПредМес.Comment = Процент Количество проданных к предыдущему месяцу;
let СуммаРостаПродажиКоличествоПредМес = replace(replace('Money(@(ПродажиКоличество)-@(ПродажиКоличествоПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиКоличествоПредМес.Label = ∆ изм. Количество продано к пред мес;
SET СуммаРостаПродажиКоличествоПредМес.Comment = Сумма роста Количество продано к предыдущему месяцу;
SET ПродажиКоличествоПредГод = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год'}>}Количество),'# ##0');
SET ПродажиКоличествоПредГод.Label = Продажи количество пред. (1) Год, шт;
SET ПродажиКоличествоПредГод.Comment = Количество продано за предыдущий год, шт;
let ПроцентПродажиКоличествоПредГод = replace(replace('Money(@(ПродажиКоличество)/@(ПродажиКоличествоПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиКоличествоПредГод.Label = % Количество продано к пред. (1) Год;
SET ПроцентПродажиКоличествоПредГод.Comment = Процент Количество проданных к предыдущему году;
let СуммаРостаПродажиКоличествоПредГод = replace(replace('Money(@(ПродажиКоличество)-@(ПродажиКоличествоПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиКоличествоПредГод.Label = ∆ изм. Количество продано к пред. (1) Год, шт;
SET СуммаРостаПродажиКоличествоПредГод.Comment = Сумма роста Количество продано к предыдущему году, шт;
SET ПродажиКоличествоПредГод2 = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год-2'}>}Количество),'# ##0,00');
SET ПродажиКоличествоПредГод2.Label = Продажи количество пред. (2) Год, шт;
SET ПродажиКоличествоПредГод2.Comment = Количество продано за предпредыдущий год, шт;
let ПроцентПродажиКоличествоПредГод2 = replace(replace('Money(@(ПродажиКоличество)/@(ПродажиКоличествоПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиКоличествоПредГод2.Label = % Количество продано к пред. (2) Год;
SET ПроцентПродажиКоличествоПредГод2.Comment = Процент Количество проданных к предпредыдущему году;
let СуммаРостаПродажиКоличествоПредГод2 = replace(replace('Money(@(ПродажиКоличество)-@(ПродажиКоличествоПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиКоличествоПредГод2.Label = ∆ изм. Количество продано к пред. (2) Год, шт;
SET СуммаРостаПродажиКоличествоПредГод2.Comment = Сумма роста Количество продано к предпредыдущему году, шт;
SET ПродажиКоличествоПредГодДеньНедели = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодДеньНедели'}>}Количество),'# ##0,00');
SET ПродажиКоличествоПредГодДеньНедели.Label = Продажи количество пред. (1) Год тот же день недели, шт;
SET ПродажиКоличествоПредГодДеньНедели.Comment = Количество продано за предыдущий год, шт;
let ПроцентПродажиКоличествоПредГодДеньНедели = replace(replace('Money(@(ПродажиКоличество)/@(ПродажиКоличествоПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиКоличествоПредГодДеньНедели.Label = % Количество продано к пред. (1) Год тот же день недели;
SET ПроцентПродажиКоличествоПредГодДеньНедели.Comment = Процент Количество проданных к предыдущему году тот же день недели;
let СуммаРостаПродажиКоличествоПредГодДеньНедели = replace(replace('Money(@(ПродажиКоличество)-@(ПродажиКоличествоПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиКоличествоПредГодДеньНедели.Label = ∆ изм. Количество продано к пред. (1) Год тот же день недели, шт;
SET СуммаРостаПродажиКоличествоПредГодДеньНедели.Comment = Сумма роста Количество продано к предыдущему году тот же день недели, шт;
SET ПродажиКоличествоПредГод2ДеньНедели = Money(sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год2ДеньНедели'}>}Количество),'# ##0,00');
SET ПродажиКоличествоПредГод2ДеньНедели.Label = Продажи количество пред. (2) Год тот же день недели, шт;
SET ПродажиКоличествоПредГод2ДеньНедели.Comment = Количество продано за предпредыдущий год тот же день недели, шт;
let ПроцентПродажиКоличествоПредГод2ДеньНедели = replace(replace('Money(@(ПродажиКоличество)/@(ПродажиКоличествоПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПродажиКоличествоПредГод2ДеньНедели.Label = % Количество продано к пред. (2) Год тот же день недели;
SET ПроцентПродажиКоличествоПредГод2ДеньНедели.Comment = Процент Количество проданных к предпредыдущему году тот же день недели;
let СуммаРостаПродажиКоличествоПредГод2ДеньНедели = replace(replace('Money(@(ПродажиКоличество)-@(ПродажиКоличествоПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПродажиКоличествоПредГод2ДеньНедели.Label = ∆ изм. Количество продано к пред. (2) Год тот же день недели, шт;
SET СуммаРостаПродажиКоличествоПредГод2ДеньНедели.Comment = Сумма роста Количество продано к предпредыдущему году тот же день недели, шт;
SET СуммаВП = Money(Sum({$<ТипДокумента = {'Sales'},ТипПериода={'Current'}>} ВП),'# ##0,00');
SET СуммаВП.Label = ВП, руб;
SET СуммаВП.Comment = Валовая прибыль с НДС, руб.;
let СуммаВПТыс = replace(replace('Money(@(СуммаВП)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаВПТыс.Label = ВП, тыс.руб.;
SET СуммаВПТыс.Comment = Валовая прибыль в тыс.руб.;
let СуммаВПТысЧеки = replace(replace('Money(@(СуммаВП)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаВПТысЧеки.Label = ВП, тыс.руб.;
SET СуммаВПТысЧеки.Comment = Валовая прибыль в тыс.руб.;
SET ПланВП = Money(Sum({<_ФлагДействующаяДата={1},ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} ВП),'# ##0,00');
SET ПланВП.Label = План ВП, руб;
SET ПланВП.Comment = План валовой прибыли (за неполный месяц) руб;
SET ПланВПТыс = Money(Sum({<_ФлагДействующаяДата={1},ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} ВП)/1000,'# ##0,00');
SET ПланВПТыс.Label = План ВП, тыс.руб.;
SET ПланВПТыс.Comment = План валовой прибыли (за неполный месяц) тыс. руб.;
SET ПланВППолный = Money(Sum({<ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} ВП),'# ##0,00');
SET ПланВППолный.Label = План ВП полный месяц, руб;
SET ПланВППолный.Comment = План валовой прибыли (за полный месяц), руб;
SET ПланВППолныйТыс = Money(Sum({<ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} ВП)/1000,'# ##0,00');
SET ПланВППолныйТыс.Label = План ВП полный месяц, тыс.руб.;
SET ПланВППолныйТыс.Comment = План валовой прибыли (за полный месяц) тыс. руб.;
let ПФ_ВП = replace(replace('Money(@(СуммаВП)/@(ПланВП),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_ВП.Label = % вып. плана ВП;
SET ПФ_ВП.Comment = Факт отнесенный к плану по валовой прибыли;
let П_Ф_ВП = replace(replace('Money(@(СуммаВП)-@(ПланВП),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ВП.Label = ∆ ПФ ВП;
SET П_Ф_ВП.Comment = Факт отнесенный к плану по валовой прибыли;
let П_Ф_ВПТыс = replace(replace('Money((@(СуммаВП)-@(ПланВП))/1000,~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ВПТыс.Label = ∆ П-Ф ВП, тыс.руб.;
SET П_Ф_ВПТыс.Comment = Факт отнесенный к плану по валовой прибыли, тыс. руб.;
SET ВППредГод = Money((sum({<ТипДокумента = {'Sales'}, _ФлагДействующаяДата={1},ТипПериода={'Год'}>}ВП)/1000),'# ##0,00');
SET ВППредГод.Label = ВП пред год, тыс.руб.;
SET ВППредГод.Comment = Валовая прибыль за в предыдущий год тыс.руб.;
let ПроцентВППредГод = replace(replace('Money(@(СуммаВПТыс)/@(ВППредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентВППредГод.Label = % изм. ВП к пред. (1) Год;
SET ПроцентВППредГод.Comment = Процент валовой прибыли к предыдущему году;
let СуммаРостаВППредГод = replace(replace('Money(@(СуммаВПТыс)-@(ВППредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаВППредГод.Label = ∆ изм. ВП. к пред. (1) Год, тыс. руб.;
SET СуммаРостаВППредГод.Comment = Сумма роста валовой прибыли к предыдущему году;
SET ВППредГод2 = Money((sum({<ТипДокумента = {'Sales'}, _ФлагДействующаяДата={1},ТипПериода={'Год-2'}>}ВП)/1000),'# ##0,00');
SET ВППредГод2.Label = ВП пред. (2) Год, тыс.руб.;
SET ВППредГод2.Comment = Валовая прибыль за вычетом себестоимости и НДС за предпредыдущий год тыс.руб.;
let ПроцентВППредГод2 = replace(replace('Money(@(СуммаВПТыс)/@(ВППредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентВППредГод2.Label = % изм. ВП к пред. (2) Год;
SET ПроцентВППредГод2.Comment = Процент валовой прибыли к предпредыдущему году;
let СуммаРостаВППредГод2 = replace(replace('Money(@(СуммаВПТыс)-@(ВППредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаВППредГод2.Label = ∆ изм. ВП к пред. (2) Год, тыс. руб.;
SET СуммаРостаВППредГод2.Comment = Сумма роста валовой прибыли к предпредыдущему году;
SET ВППредГодДеньНедели = Money((sum({<ТипДокумента = {'Sales'}, _ФлагДействующаяДата={1},ТипПериода={'Год'}>}ВП)/1000),'# ##0,00');
SET ВППредГодДеньНедели.Label = ВП пред год тот же день недели, тыс.руб.;
SET ВППредГодДеньНедели.Comment = Валовая прибыль за в предыдущий год тот же день недели, тыс.руб.;
let ПроцентВППредГодДеньНедели = replace(replace('Money(@(СуммаВПТыс)/@(ВППредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентВППредГодДеньНедели.Label = % изм. ВП к пред. (1) Год тот же день недели;
SET ПроцентВППредГодДеньНедели.Comment = Процент валовой прибыли к предыдущему году тот же день недели;
let СуммаРостаВППредГодДеньНедели = replace(replace('Money(@(СуммаВПТыс)-@(ВППредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаВППредГодДеньНедели.Label = ∆ изм. ВП. к пред. (1) Год тот же день недели, тыс. руб.;
SET СуммаРостаВППредГодДеньНедели.Comment = Сумма роста валовой прибыли к предыдущему году тот же день недели;
SET ВППредГод2ДеньНедели = Money((sum({<ТипДокумента = {'Sales'}, _ФлагДействующаяДата={1},ТипПериода={'Год-2'}>}ВП)/1000),'# ##0,00');
SET ВППредГод2ДеньНедели.Label = ВП пред. (2) Год тот же день недели, тыс.руб.;
SET ВППредГод2ДеньНедели.Comment = Валовая прибыль за вычетом себестоимости и НДС за предпредыдущий год тот же день недели, тыс.руб.;
let ПроцентВППредГод2ДеньНедели = replace(replace('Money(@(СуммаВПТыс)/@(ВППредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентВППредГод2ДеньНедели.Label = % изм. ВП к пред. (2) Год тот же день недели;
SET ПроцентВППредГод2ДеньНедели.Comment = Процент валовой прибыли к предпредыдущему году тот же день недели;
let СуммаРостаВППредГод2ДеньНедели = replace(replace('Money(@(СуммаВПТыс)-@(ВППредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаВППредГод2ДеньНедели.Label = ∆ изм. ВП к пред. (2) Год тот же день недели, тыс. руб.;
SET СуммаРостаВППредГод2ДеньНедели.Comment = Сумма роста валовой прибыли к предпредыдущему году тот же день недели;
SET ВППредМес = Money((sum({<ТипДокумента = {'Sales'}, _ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}ВП)/1000),'# ##0,00');
SET ВППредМес.Label = ВП пред месяц, тыс.руб.;
SET ВППредМес.Comment = Валовая прибыль за вычетом себестоимости и НДС за предыдущий месяц тыс.руб.;
let ПроцентВППредМес = replace(replace('Money(@(СуммаВПТыс)/@(ВППредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентВППредМес.Label = % ВП к пред месяцу;
SET ПроцентВППредМес.Comment = Процент валовой прибыли к предыдущему месяцу;
let СуммаРостаВППредМес = replace(replace('Money(@(СуммаВПТыс)-@(ВППредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаВППредМес.Label = ∆ изм. ВП к пред месяцу;
SET СуммаРостаВППредМес.Comment = Сумма роста валовой прибыли к предыдущему месяцу;
let ДоляСуммыНаценкиГруппы = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} ВП)/Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL <@(Измерение(ГруппаСклад))> ВП), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыНаценкиГруппы.Label = Доля ВП группы по магазину;
SET ДоляСуммыНаценкиГруппы.Comment = Доля валовой прибыли группы товара по магазину;
let ДоляСуммыНаценкиСклад = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} ВП)/Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL <@(Измерение(ГруппаКлассификатор))> ВП), @(Измерение(ГруппаКлассификатор)), @(Измерение(ГруппаСклад))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыНаценкиСклад.Label = Доля ВП склада по группе;
SET ДоляСуммыНаценкиСклад.Comment = Доля валовой прибыли склада по группе товаров;
let ДоляСуммыНаценкиКомпании = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} ВП)/Sum({<Склад,ТипДокумента={~~~Sales~~~}, ТипПериода={~~~Current~~~}>} TOTAL ВП), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыНаценкиКомпании.Label = Доля ВП по компании;
SET ДоляСуммыНаценкиКомпании.Comment = Доля валовой прибыли по компании в целом;
SET СуммаНаценкиПроверкаТыс = Money(Sum({$<ТипДокумента={'TestDataSales'}, ТипПериода={'Current'}>}ВП)/1000,'# ##0,00');
SET СуммаНаценкиПроверкаТыс.Label = ВП проверка тыс.руб.;
SET СуммаНаценкиПроверкаТыс.Comment = Сумма валовой прибыли проверка в тыс. руб.;
let СуммаНаценкиРасхожденияТыс = replace(replace('Money(@(СуммаВПТыс) - @(СуммаНаценкиПроверкаТыс),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаНаценкиРасхожденияТыс.Label = Дельта ВП тыс.руб.;
SET СуммаНаценкиРасхожденияТыс.Comment = Дельта валовой прибыли проверка в тыс. руб.;
let ПрцРентВП = replace(replace('Money((@(СуммаВП)/@(СуммаПродажи)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцРентВП.Label = % Маржи;
SET ПрцРентВП.Comment = % Маржи;
let ПланРентВП = replace(replace('Money((@(ПланВП)/@(ПланПродаж)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланРентВП.Label = План по % Маржи;
SET ПланРентВП.Comment = План по %  Маржи;
let ПланРентВППолный = replace(replace('Money((@(ПланВППолный)/@(ПланПродажПолный)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланРентВППолный.Label = План по % Маржи полный месяц;
SET ПланРентВППолный.Comment = План по % Маржи полный месяц;
let ПФРентВП = replace(replace('Money((@(ПрцРентВП)/@(ПланРентВП)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФРентВП.Label = ПФ % Маржи;
SET ПФРентВП.Comment = ПФ % Маржи;
let П_Ф_РентВП = replace(replace('Money((@(ПланРентВП)-@(ПрцРентВП)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_РентВП.Label = П-Ф % Маржи;
SET П_Ф_РентВП.Comment = П-Ф % Маржи;
let РентВППредГод = replace(replace('Money((@(ВППредГод)/@(ПродажиПредГод)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET РентВППредГод.Label = % Маржи пред. (1) Год;
SET РентВППредГод.Comment = % Маржи за предыдущий год;
let ПроцентРентВППредГод = replace(replace('Money(@(ПрцРентВП)/@(РентВППредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентРентВППредГод.Label = % изм. % Маржи к пред. (1) Год;
SET ПроцентРентВППредГод.Comment = Процент Маржи к предыдущему году;
let СуммаРостаРентВППредГод = replace(replace('Money(@(ПрцРентВП)-@(РентВППредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаРентВППредГод.Label = ∆ изм. % Маржи к пред. (1) Год;
SET СуммаРостаРентВППредГод.Comment = сумма изм % Маржи к предыдущему году;
let РентВППредГод2 = replace(replace('Money((@(ВППредГод2)/@(ПродажиПредГод2)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET РентВППредГод2.Label = % Маржи пред. (2) Год;
SET РентВППредГод2.Comment = % Маржи за предпредыдущий год;
let ПроцентРентВППредГод2 = replace(replace('Money(@(ПрцРентВП)/@(РентВППредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентРентВППредГод2.Label = % изм. % Маржи к пред. (2) Год;
SET ПроцентРентВППредГод2.Comment = Процент изм. % Маржи к предыдущему году;
let СуммаРостаРентВППредГод2 = replace(replace('Money(@(ПрцРентВП)-@(РентВППредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаРентВППредГод2.Label = ∆ изм. % Маржи к пред. (2) Год;
SET СуммаРостаРентВППредГод2.Comment = сумма изм. % Маржи к предпредыдущему году;
let РентВППредГодДеньНедели = replace(replace('Money((@(ВППредГод)/@(ПродажиПредГодДеньНедели)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET РентВППредГодДеньНедели.Label = % Маржи пред. (1) Год;
SET РентВППредГодДеньНедели.Comment = % Маржи за предыдущий год;
let ПроцентРентВППредГодДеньНедели = replace(replace('Money(@(ПрцРентВП)/@(РентВППредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентРентВППредГодДеньНедели.Label = % изм. % Маржи к пред. (1) Год;
SET ПроцентРентВППредГодДеньНедели.Comment = Процент изменения % Маржи к предыдущему году;
let СуммаРостаРентВППредГодДеньНедели = replace(replace('Money(@(ПрцРентВП)-@(РентВППредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаРентВППредГодДеньНедели.Label = ∆ изм. % Маржи к пред. (1) Год;
SET СуммаРостаРентВППредГодДеньНедели.Comment = Сумма изм % Маржи к предыдущему году;
let РентВППредГод2ДеньНедели = replace(replace('Money((@(ВППредГод2)/@(ПродажиПредГод2ДеньНедели)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET РентВППредГод2ДеньНедели.Label = % Маржи пред. (2) Год;
SET РентВППредГод2ДеньНедели.Comment = % Маржи за предпредыдущий год;
let ПроцентРентВППредГод2ДеньНедели = replace(replace('Money(@(ПрцРентВП)/@(РентВППредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентРентВППредГод2ДеньНедели.Label = % изм. % Маржи к пред. (2) Год;
SET ПроцентРентВППредГод2ДеньНедели.Comment = Процент  изм. % Маржи к предыдущему году;
let СуммаРостаРентВППредГод2ДеньНедели = replace(replace('Money(@(ПрцРентВП)-@(РентВППредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаРентВППредГод2ДеньНедели.Label = ∆ изм. % Маржи к пред. (2) Год;
SET СуммаРостаРентВППредГод2ДеньНедели.Comment = Сумма изм. % Маржи к предпредыдущему году;
let РентВППредМес = replace(replace('Money((@(ВППредМес)/@(ПродажиПредМес)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET РентВППредМес.Label = % Маржи пред месяц;
SET РентВППредМес.Comment = % Маржи за предпредыдущий месяц;
let ПроцентРентВППредМес = replace(replace('Money(@(ПрцРентВП)/@(РентВППредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентРентВППредМес.Label = % изм. % Маржи к пред. месяцу;
SET ПроцентРентВППредМес.Comment = Процент  изм. % Маржи к предыдущему месяцу;
let СуммаРостаРентВППредМес = replace(replace('Money(@(ПрцРентВП)-@(РентВППредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаРентВППредМес.Label = ∆ изм. % Маржи к пред месяцу;
SET СуммаРостаРентВППредМес.Comment = Сумма изм. % Маржи к предпредыдущему месяцу;
let ПрцНаценки = replace(replace('Money((@(СуммаВП)/@(УчСебестоимостьПолный)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценки.Label = % Наценки;
SET ПрцНаценки.Comment = % Наценки;
let ПрцНаценкиЧеки = replace(replace('Money((@(СуммаВП)/@(УчСебестоимостьПолный)),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиЧеки.Label = % Наценки;
SET ПрцНаценкиЧеки.Comment = % Наценки;
let ПрцНаценкиПредГод = replace(replace('Money((@(ВППредГод)/@(УчСебестоимостьПолныйПредГод)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиПредГод.Label = % Наценки пред.(1) Год;
SET ПрцНаценкиПредГод.Comment = % Наценки за предыдущий год;
let ПроцентПрцНаценкиПредГод = replace(replace('Money(@(ПрцНаценки)/@(ПрцНаценкиПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПрцНаценкиПредГод.Label = % изм. Наценки к пред.(1) Год;
SET ПроцентПрцНаценкиПредГод.Comment = Процент Наценки к предыдущему году;
let СуммаРостаПрцНаценкиПредГод = replace(replace('Money(@(ПрцНаценки)-@(ПрцНаценкиПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПрцНаценкиПредГод.Label = ∆ изм. Наценки к пред.(1) Год;
SET СуммаРостаПрцНаценкиПредГод.Comment = Сумма изм Наценки к предыдущему году;
let ПрцНаценкиПредМесяц = replace(replace('Money((@(ВППредМес)/@(УчСебестоимостьПолныйПредМесяц)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиПредМесяц.Label = % Наценки пред месяц;
SET ПрцНаценкиПредМесяц.Comment = % Наценки за предыдущий месяц;
let ПроцентПрцНаценкаПредМес = replace(replace('Money(@(ПрцНаценки)/@(ПрцНаценкиПредМесяц),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПрцНаценкаПредМес.Label = % Наценки к пред месяцу;
SET ПроцентПрцНаценкаПредМес.Comment = Процент Наценки к предыдущему месяцу;
let СуммаРостаПрцНаценкаПредМес = replace(replace('Money(@(ПрцНаценки)-@(ПрцНаценкиПредМесяц),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПрцНаценкаПредМес.Label = ∆ изм. Наценки к пред месяцу;
SET СуммаРостаПрцНаценкаПредМес.Comment = Сумма изм Наценки к предыдущему месяцу;
let ПрцНаценкиПредГод2 = replace(replace('Money((@(ВППредГод2)/@(УчСебестоимостьПолныйПредГод2)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиПредГод2.Label = % Наценки пред.(2) Год;
SET ПрцНаценкиПредГод2.Comment = % Наценки за предпредыдущий год;
let ПроцентПрцНаценкиПредГод2 = replace(replace('Money(@(ПрцНаценки)/@(ПрцНаценкиПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПрцНаценкиПредГод2.Label = % изм. Наценки к пред.(2) Год;
SET ПроцентПрцНаценкиПредГод2.Comment = Процент Наценки к предпредыдущему году;
let СуммаРостаПрцНаценкиПредГод2 = replace(replace('Money(@(ПрцНаценки)-@(ПрцНаценкиПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПрцНаценкиПредГод2.Label = ∆ изм. Наценки к пред.(2) Год;
SET СуммаРостаПрцНаценкиПредГод2.Comment = Сумма изм Наценки к предпредыдущему году;
let ПрцНаценкиПредГодДеньНедели = replace(replace('Money((@(ВППредГод)/@(УчСебестоимостьПолныйПредГодДеньНедели)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиПредГодДеньНедели.Label = % Наценки пред.(1) Год тот же день недели;
SET ПрцНаценкиПредГодДеньНедели.Comment = % Наценки за предыдущий год тот же день недели;
let ПроцентПрцНаценкиПредГодДеньНедели = replace(replace('Money(@(ПрцНаценки)/@(ПрцНаценкиПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПрцНаценкиПредГодДеньНедели.Label = % изм. Наценки к пред.(1) Год тот же день недели;
SET ПроцентПрцНаценкиПредГодДеньНедели.Comment = Процент Наценки к предыдущему году тот же день недели;
let СуммаРостаПрцНаценкиПредГодДеньНедели = replace(replace('Money(@(ПрцНаценки)-@(ПрцНаценкиПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПрцНаценкиПредГодДеньНедели.Label = ∆ изм. Наценки к пред.(1) Год тот же день недели;
SET СуммаРостаПрцНаценкиПредГодДеньНедели.Comment = Сумма изм Наценки к предыдущему году тот же день недели;
let ПрцНаценкиПредГод2ДеньНедели = replace(replace('Money((@(ВППредГод2)/@(УчСебестоимостьПолныйПредГод2ДеньНедели)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПрцНаценкиПредГод2ДеньНедели.Label = % Наценки пред.(2) Год тот же день недели;
SET ПрцНаценкиПредГод2ДеньНедели.Comment = % Наценки за предпредыдущий год тот же день недели;
let ПроцентПрцНаценкиПредГод2ДеньНедели = replace(replace('Money(@(ПрцНаценки)/@(ПрцНаценкиПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПрцНаценкиПредГод2ДеньНедели.Label = % изм. Наценки к пред.(2) Год тот же день недели;
SET ПроцентПрцНаценкиПредГод2ДеньНедели.Comment = Процент Наценки к предпредыдущему году тот же день недели;
let СуммаРостаПрцНаценкиПредГод2ДеньНедели = replace(replace('Money(@(ПрцНаценки)-@(ПрцНаценкиПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаПрцНаценкиПредГод2ДеньНедели.Label = ∆ изм. Наценки к пред.(2) Год тот же день недели;
SET СуммаРостаПрцНаценкиПредГод2ДеньНедели.Comment = Сумма изм Наценки к предпредыдущему году тот же день недели;
let ПланПрцНаценка = replace(replace('Money(@(ПланПродажТыс)/(@(ПланПродажТыс)-@(ПланВПТыс))-1,~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланПрцНаценка.Label = План по % Наценки;
SET ПланПрцНаценка.Comment = План по % Наценки;
let ПланПрцНаценкаПолный = replace(replace('Money(@(ПланПродажПолныйТыс)/(@(ПланПродажПолныйТыс)-@(ПланВППолныйТыс))-1,~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланПрцНаценкаПолный.Label = План по % Наценки полный месяц;
SET ПланПрцНаценкаПолный.Comment = План по % Наценки полный месяц;
let ПФПрцНаценка = replace(replace('Money(@(ПрцНаценки)/@(ПланПрцНаценка),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФПрцНаценка.Label = ПФ % Наценки;
SET ПФПрцНаценка.Comment = ПФ % Наценки;
let П_Ф_ПрцНаценка = replace(replace('Money(@(ПрцНаценки)-@(ПланПрцНаценка),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ПрцНаценка.Label = ∆ П-Ф % Наценки;
SET П_Ф_ПрцНаценка.Comment = П-Ф % Наценки;
let ОстаткиКоличествоСреднее = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~Current~~~}>} Количество) / @(КоличествоДней)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиКоличествоСреднее.Label = Среднедневные Остатки за период, шт.;
SET ОстаткиКоличествоСреднее.Comment = Остатки среднее количество, шт;
let ОстатокШтукНаКонецПериода_Формула = replace(replace('Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам),Дата={"@(=Max({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1}>} Дата))"}>} Количество)','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокШтукНаКонецПериода = replace(replace('Money(@(ОстатокШтукНаКонецПериода_Формула),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокШтукНаКонецПериода.Label = Остатки на конец периода, шт;
SET ОстатокШтукНаКонецПериода.Comment = Складские остатки в штуках на конец периода, шт;
let ОстатокШтукНаКонецМесяца = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам)>} Количество),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокШтукНаКонецМесяца.Label = Остатки на конец месяца, шт;
SET ОстатокШтукНаКонецМесяца.Comment = Складские остатки в штуках на конец месяца, шт;
let ОстатокСебестоимостьНаКонецПериода_Формула = replace(replace('Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам),Дата={"@(=Max({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1}>} Дата))"}>} Себестоимость)','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокСебестоимостьНаКонецПериода = replace(replace('Money(@(ОстатокСебестоимостьНаКонецПериода_Формула),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьНаКонецПериода.Label = Остатки по себестоимости, руб;
SET ОстатокСебестоимостьНаКонецПериода.Comment = Складские остатки по себестоимости на конец периода, руб;
let ОстатокСебестоимостьНаКонецПериодаТыс = replace(replace('Money(@(ОстатокСебестоимостьНаКонецПериода_Формула)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьНаКонецПериодаТыс.Label = Остатки по себестоимости на конец, тыс.руб.;
SET ОстатокСебестоимостьНаКонецПериодаТыс.Comment = Складские остатки по себестоимости на конец периода, тыс.руб.;
let ОстатокСебестоимостьНаКонецПериодаТысМесяц = replace(replace('Money(fabs(Aggr(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,ГодМесяц,ШкалаЛиквидностиИсторическая)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьНаКонецПериодаТысМесяц.Label = Остатки по себестоимости, тыс.руб.;
SET ОстатокСебестоимостьНаКонецПериодаТысМесяц.Comment = Складские остатки по себестоимости на конец месяца, тыс.руб.;
let ОстатокСебестоимостьНаКонецМесяца = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьНаКонецМесяца.Label = Остатки в СЦ на конец месяца, тыс.руб.;
SET ОстатокСебестоимостьНаКонецМесяца.Comment = Складские остатки в СЦ на конец месяца, тыс.руб.;
let ОстатокСебестоимостьБезТранспортныхНаКонецПериода_Формула = replace(replace('Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам),Дата={"@(=Max({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1}>} Дата))"}>} СебестоимостьБезТранспортных)','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокСебестоимостьБезТранспортныхНаКонецПериодаТыс = replace(replace('Money(@(ОстатокСебестоимостьБезТранспортныхНаКонецПериода_Формула)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьБезТранспортныхНаКонецПериодаТыс.Label = Остатки в ЗЦ, тыс.руб.;
SET ОстатокСебестоимостьБезТранспортныхНаКонецПериодаТыс.Comment = Складские остатки в ЗЦ на конец периода, тыс.руб.;
let ОстатокСебестоимостьБезТранспортныхМесяц = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},@(СбросФильтраПоОстаткам)>} СебестоимостьБезТранспортных)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьБезТранспортныхМесяц.Label = Остатки в ЗЦ на конец месяца, тыс.руб.;
SET ОстатокСебестоимостьБезТранспортныхМесяц.Comment = Складские остатки в ЗЦ на конец месяца, тыс.руб.;
let ТранспортныеМесяц = replace(replace('Money((@(УчСебестоимостьПолный)-@(УчСебестоимостьБезТранспортныхПолный))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ТранспортныеМесяц.Label = Расходы на товарный транспорт, тыс.руб.;
SET ТранспортныеМесяц.Comment = Расходы на товарный транспорт, тыс.руб.;
let ОстатокШтукНаКонецДня_Формула = replace(replace('(Sum({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Sum~~~},ТипДокумента={~~~InventTrans~~~}>} Количество) + Sum({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Eom~~~},ТипДокумента={~~~OnHandEoM~~~}>} Количество))','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокШтукНаКонецДня = replace(replace('Money(@(ОстатокШтукНаКонецДня_Формула),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокШтукНаКонецДня.Label = Остаток на конец периода, шт;
SET ОстатокШтукНаКонецДня.Comment = Складские остатки в штуках на конец дня, шт;
let ОстатокСебестоимостьНаКонецДня_Формула = replace(replace('(Sum({<@(СбросФильтраПоОстаткам),ТипПериода={~~~OnHand_Sum~~~},ТипДокумента={~~~InventTrans~~~}>} Себестоимость) + Sum({<@(СбросФильтраПоОстаткам),ТипПериода={~~~OnHand_Eom~~~},ТипДокумента={~~~OnHandEoM~~~}>} Себестоимость))','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокСебестоимостьНаКонецДня = replace(replace('Money(@(ОстатокСебестоимостьНаКонецДня_Формула),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокСебестоимостьНаКонецДня.Label = Себестоимость остатков на конец дня, руб;
SET ОстатокСебестоимостьНаКонецДня.Comment = Себестоимость складских остатков на конец дня, руб;
let ОстатокШтукНаПоследнийДеньВыборки_Формула = replace(replace('(Sum({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Sum~~~}, Дата={"@(=Max({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1}>} Дата))"},ТипДокумента={~~~InventTrans~~~}>} Количество) + Sum({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Eom~~~}, Дата={"@(=Max({<@(СбросФильтраПоОстаткам),_ФлагДействующаяДата={1}>} Дата))"},ТипДокумента={~~~OnHandEoM~~~}>} Количество))','~~~', chr(39)), '@(', chr(36) & '(');
let ОстатокШтукНаПоследнийДеньВыборки = replace(replace('Money(@(ОстатокШтукНаПоследнийДеньВыборки_Формула),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ПродажиСуммаСреднедневные = replace(replace('Money((@(СуммаПродажи) / Count({<_ФлагДействующаяДата={1}>} TOTAL DISTINCT Дата)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСуммаСреднедневные.Label = Среденедневная покупка, руб;
SET ПродажиСуммаСреднедневные.Comment = Среднедневная сумма продаж за выбранный период, руб;
let ПродажиКоличествоСреднедневные = replace(replace('Money((@(ПродажиКоличество) / Count({<_ФлагДействующаяДата={1}>} TOTAL DISTINCT Дата)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиКоличествоСреднедневные.Label = Среднедневная покупка за выбранный период, шт;
SET ПродажиКоличествоСреднедневные.Comment = Среднедневное количество проданного товара за выбранный период, шт;
let T30 = replace(replace('Money(Sum({$<ТипДокумента ={~~~Sales~~~},ТипПериода={~~~Current~~~},Год,Месяц,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ДеньИНомерНедели, Дата={~~~>=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)-29))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)))~~~}>} Количество)/30,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET T30.Label = Ср мес продажи (30), шт;
SET T30.Comment = Среднедневная покупка, за последние 30 дней от конечной даты выбранного периода, шт;
let ЗапасыВДнях30 = replace(replace(' Money(if((@(T30))=0 and (@(ОстатокШтукНаКонецПериода_Формула))>0,30000, if((@(ОстатокШтукНаКонецПериода_Формула))<>0 and (@(T30))<=0,0, if((@(ОстатокШтукНаКонецПериода_Формула))<=0 and (@(T30))>0,0, if((@(ОстатокШтукНаКонецПериода_Формула))=0 and (@(T30))=0,0, (@(ОстатокШтукНаКонецПериода_Формула))/(@(T30)))))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ЗапасыВДнях30.Label = Запас в Днях (30);
SET ЗапасыВДнях30.Comment = Запасы в днях на конец периода (исходя из продаж за 30 дней);
let T90 = replace(replace('Money(Sum({$<ТипДокумента ={~~~Sales~~~},ТипПериода={~~~Current~~~},Год,Месяц,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ДеньИНомерНедели, Дата={~~~>=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)-89))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)))~~~}>} Количество)/90,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET T90.Label = Ср мес продажи (90), шт;
SET T90.Comment = Среднедневная покупка, за последние 90 дней от конечной даты выбранного периода, шт;
let ЗапасыВДнях90 = replace(replace(' Money(if((@(T30))=0 and (@(ОстатокШтукНаКонецПериода_Формула))>0,30000, if((@(ОстатокШтукНаКонецПериода_Формула))<>0 and (@(T90))<=0,0, if((@(ОстатокШтукНаКонецПериода_Формула))<=0 and (@(T90))>0,0, if((@(ОстатокШтукНаКонецПериода_Формула))=0 and (@(T90))=0,0, (@(ОстатокШтукНаКонецПериода_Формула))/(@(T90)))))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ЗапасыВДнях90.Label = Запас в Днях (90);
SET ЗапасыВДнях90.Comment = Запасы в днях на конец периода (исходя из продаж 90 дней);
SET T30ТорговыеДни = Money(Sum({$<ТипДокумента ={'Sales'},ТипПериода={'Current'} >} Количество)/ Sum({<ТипДокумента={'OutOfStock'},ТипПериода={'Current'} >} Скидка),'# ##0,00');
SET T30ТорговыеДни.Label = Ср мес продажи (месяц с учетом наличия), шт;
SET T30ТорговыеДни.Comment = Среднедневная продажа, за месяц с учетом наличия, шт;
let T30ТорговыеДниПоКомпании = replace(replace('Money(@(T30ТорговыеДни)*(Sum(If(Aggr(@(ОстатокШтукНаКонецПериода),СкладСсылка,НоменклатураСсылка)>0,1,0))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET T30ТорговыеДниПоКомпании.Label = Ср мес продажи (месяц с учетом наличия), шт;
SET T30ТорговыеДниПоКомпании.Comment = Среднедневная продажа, за месяц с учетом наличия, шт;
let T30ТорговыеДниДинамика = replace(replace('(Sum({<@(СбросФильтраПоОстаткамПоДням),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Sum~~~},ТипДокумента={~~~InventTrans~~~},Год,Месяц,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ДеньИНомерНедели, Дата={~~~>=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)-29))<=@(=Date(Max({<_ФлагДействующаяДата={1}>} Дата)))~~~}>} Количество) + Sum({<@(СбросФильтраПоОстаткамПоДням),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Eom~~~},ТипДокумента={~~~OnHandEoM~~~},Год,Месяц,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ДеньИНомерНедели, Дата={~~~>=@(=Date(Min({<_ФлагДействующаяДата={1}>} Дата)-29))<=@(=Date(Min({<_ФлагДействующаяДата={1}>} Дата)))~~~}>} Количество))','~~~', chr(39)), '@(', chr(36) & '(');
SET T30ТорговыеДниДинамика.Label = Ср мес продажи (30), шт;
SET T30ТорговыеДниДинамика.Comment = Среднедневная покупка, за последние 30 дней от конечной даты выбранного периода, шт;
let ЗапасыПоТорговымДням30 = replace(replace(' Money(if(alt(@(T30ТорговыеДни),0)=0 and (@(ОстатокШтукНаКонецПериода_Формула))>0,30000, if((@(ОстатокШтукНаКонецПериода_Формула))<>0 and (@(T30ТорговыеДни))<=0,0, if((@(ОстатокШтукНаКонецПериода_Формула))<=0 and (@(T30ТорговыеДни))>0,0, if((@(ОстатокШтукНаКонецПериода_Формула))=0 and alt(@(T30ТорговыеДни),0)=0,0, (@(ОстатокШтукНаКонецПериода_Формула))/(@(T30ТорговыеДни)))))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ЗапасыПоТорговымДням30.Label = Запас в Днях (месяц с учетом наличия);
SET ЗапасыПоТорговымДням30.Comment = Запасы в днях на конец периода (исходя из продаж и наличия за месяц);
let ЗапасыПоТорговымДням30ПоКомпании = replace(replace(' Money(if(alt(@(T30ТорговыеДниПоКомпании),0)=0 and (@(ОстатокШтукНаКонецПериода_Формула))>0,30000, if((@(ОстатокШтукНаКонецПериода_Формула))<>0 and (@(T30ТорговыеДниПоКомпании))<=0,0, if((@(ОстатокШтукНаКонецПериода_Формула))<=0 and (@(T30ТорговыеДниПоКомпании))>0,0, if((@(ОстатокШтукНаКонецПериода_Формула))=0 and alt(@(T30ТорговыеДниПоКомпании),0)=0,0, (@(ОстатокШтукНаКонецПериода_Формула))/(@(T30ТорговыеДниПоКомпании)))))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ЗапасыПоТорговымДням30ПоКомпании.Label = Запас в Днях (месяц с учетом наличия);
SET ЗапасыПоТорговымДням30ПоКомпании.Comment = Запасы в днях на конец периода (исходя из продаж и наличия за месяц);
SET СбросФильтраПоОстаткам = КлиентСсылка,Клиент;
SET СбросФильтраПоПланам = НоменклатураКод,НоменклатураНаименование,Уровень4,Уровень3,ШкалаЛиквидности;
SET ПоляПоиска = НоменклатураНаименование,Логист,КатегорийныйМенеджер,МенеджерПродаж,Клиент,Бренд,Группа,Подгруппа,РекламнаяАкцияИстория;
let ОстаткиСебестоимость = replace(replace('Sum({<@(СбросФильтраПоОстаткам),ТипДокумента={~~~OnHandEoM~~~}, _ДеньПоПорядку={~~~@(=Max({<_ФлагДействующаяДата={1},_КонецНеделиМесяца={1}>} _ДеньПоПорядку))~~~}, ТипПериода={~~~Current~~~}>} Себестоимость)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиСебестоимость.Label = Остатки на конец полного (мес) периода по себестоимости, руб;
SET ОстаткиСебестоимость.Comment = Остаток себестоимость на конец выбранного периода, руб;
let ОстаткиСебестоимостьПоШкалеЛиквидности = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~Current~~~},Канал,КодКлиента,Клиент,ГруппаКлиента>} Себестоимость) / @(КоличествоДней))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиСебестоимостьПоШкалеЛиквидности.Label = Остатки средние, руб;
SET ОстаткиСебестоимостьПоШкалеЛиквидности.Comment = Остатки средняя себестоимость по суммам, руб;
let ОстаткиСебестоимостьТыс = replace(replace('Money((@(ОстаткиСебестоимость)/1000),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиСебестоимостьТыс.Label = Остатки на конец полного (мес) периода в сред Закуп. Ценах, тыс.руб.;
SET ОстаткиСебестоимостьТыс.Comment = Остаток себестоимость на конец выбранного периода тыс. руб.;
let ОстаткиТыс = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} Себестоимость) / (Sum({<_КонецМесяца={1},ТипПериода={~~~Current~~~}>} _ДниДляСреднихОстатков))/1000),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиТыс.Label = Остатки средние, тыс.руб;
SET ОстаткиТыс.Comment = Остатки себестоимость среднедневная за выбранный период, тыс. руб.;
let Остатки = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} Себестоимость) / Sum({<_КонецМесяца={1},ТипПериода={~~~Current~~~}>} _ДниДляСреднихОстатков)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET Остатки.Label = Остатки средние, руб;
SET Остатки.Comment = Остатки себестоимость среднедневная за выбранный период, рублей;
let ДоляСуммыОстатковГруппы = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/Sum({$<ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} TOTAL <@(Измерение(ГруппаСклад))> Себестоимость), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыОстатковГруппы.Label = Доля остатков группы по магазину;
SET ДоляСуммыОстатковГруппы.Comment = Доля остатков группы товара по магазину;
let ДоляСуммыОстатковСклад = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/Sum({$<ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} TOTAL <@(Измерение(ГруппаКлассификатор))> Себестоимость), @(Измерение(ГруппаКлассификатор)), @(Измерение(ГруппаСклад))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыОстатковСклад.Label = Доля остатков склада по группе;
SET ДоляСуммыОстатковСклад.Comment = Доля остатков склада по группе товаров;
let ДоляСуммыОстатковКомпании = replace(replace('Money(Aggr( Sum({$<ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/Sum({<Склад,ТипДокумента={~~~OnHandSum~~~}, ТипПериода={~~~Current~~~},@(СбросФильтраПоОстаткам)>} TOTAL Себестоимость), @(Измерение(ГруппаСклад)), @(Измерение(ГруппаКлассификатор))),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСуммыОстатковКомпании.Label = Доля остатков по компании;
SET ДоляСуммыОстатковКомпании.Comment = Доля остатков по компании в целом;
let ПланОстатки = replace(replace('Money(Sum({$<ТипДокумента = {~~~OnHand_Plan~~~},ТипПериода={~~~Current~~~}>} Себестоимость) / @(КоличествоДнейВключаяБудущийПериод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланОстатки.Label = План остатки, руб;
SET ПланОстатки.Comment = Плановые остатки средние (расчет), руб;
let ПланОстаткиТыс = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHand_Plan~~~},ТипПериода={~~~Current~~~}>} Себестоимость) / @(КоличествоДнейВключаяБудущийПериод))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланОстаткиТыс.Label = План остатки , тыс.руб.;
SET ПланОстаткиТыс.Comment = Плановые остатки средние (расчет) , тыс. руб.;
let ПланОборачиваемость = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHand_Plan~~~},ТипПериода={~~~Current~~~}>} Себестоимость) / (@(ПланПродажПолный)- @(ПланВППолный))),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПланОборачиваемость.Label = План оборачиваемость;
SET ПланОборачиваемость.Comment = План по оборачиваемости;
let ПФ_Остатки = replace(replace('Money(@(ОстаткиТыс)/@(ПланОстаткиТыс),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_Остатки.Label = % отношения к плановым Остатков в сред. Закуп. Ценах;
SET ПФ_Остатки.Comment = Факт отнесенный к плану по остаткам;
let П_Ф_Остатки = replace(replace('Money( (-@(ПланОстатки)+(@(ОстаткиТыс)/1000)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_Остатки.Label = ∆ П-Ф остатков, руб.;
SET П_Ф_Остатки.Comment = План минус  факт по остаткам;
let П_Ф_ОстаткиТыс = replace(replace('Money((@(П_Ф_Остатки))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ОстаткиТыс.Label = ∆ П-Ф остатков тыс. руб.;
SET П_Ф_ОстаткиТыс.Comment = План минус  факт по остаткам;
let ОстаткиПредГодОбщие = replace(replace('Money((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~КонецМесяцаГод~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредГодОбщие.Label = Остатки пред год, руб;
SET ОстаткиПредГодОбщие.Comment = Остатки себестоимость по суммам за предыдущий год, руб;
let ОстаткиПредГод = replace(replace('Money((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~КонецМесяцаГод~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000) / Sum({<_КонецМесяца={1},ТипПериода={~~~КонецМесяцаГод~~~}>} _ДнейПрошлогоПериодаВМесяце),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредГод.Label = Остатки средние пред.(1) Год, руб;
SET ОстаткиПредГод.Comment = Остатки  средняя себестоимость по суммам за предыдущий год, руб;
let ПроцентОстаткиПредГод = replace(replace('Money((@(ОстаткиТыс))/(@(ОстаткиПредГод)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиПредГод.Label = % Остатков к пред году;
SET ПроцентОстаткиПредГод.Comment = Процент Остатков к предыдущему году;
let СуммаРостаОстаткиПредГод = replace(replace('Money((@(ОстаткиТыс))-(@(ОстаткиПредГод)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиПредГод.Label = СуммаРостаОстатков к пред году;
SET СуммаРостаОстаткиПредГод.Comment = СуммаРоста Остатков к предыдущему году;
let ОстаткиПредГод2Общие = replace(replace('Money((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~КонецМесяцаГод2~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредГод2Общие.Label = Остатки пред.(2) Год, руб;
SET ОстаткиПредГод2Общие.Comment = Остатки себестоимость по суммам за предпредыдущий год, руб;
let ОстаткиПредГод2 = replace(replace('Money(((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~КонецМесяцаГод2~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000) / Sum({<_КонецМесяца={1},ТипПериода={~~~КонецМесяцаГод2~~~}>} _ДнейПрошлогоПериодаВМесяце)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредГод2.Label = Остатки средние пред.(2) Год, руб;
SET ОстаткиПредГод2.Comment = Остатки  средняя себестоимость по суммам за предпредыдущий год, руб;
let ПроцентОстаткиПредГод2 = replace(replace('Money((@(ОстаткиТыс))/(@(ОстаткиПредГод2)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиПредГод2.Label = % Остатков к пред.(2) Году;
SET ПроцентОстаткиПредГод2.Comment = Процент Остатков к предпредыдущему го;
let СуммаРостаОстаткиПредГод2 = replace(replace('Money((@(ОстаткиТыс))-(@(ОстаткиПредГод2)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиПредГод2.Label = СуммаРоста Остатков к пред.(2) Году;
SET СуммаРостаОстаткиПредГод2.Comment = СуммаРоста Остатков к предпредыдущему году;
let ОстаткиПредМесОбщие = replace(replace('Money((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~ГодМесяц~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредМесОбщие.Label = Остатки пред месяц, руб;
SET ОстаткиПредМесОбщие.Comment = Остатки себестоимость по суммам за предыдущий месяц, руб;
let ОстаткиПредМес = replace(replace('Money(((Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~ГодМесяц~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000) / Sum({<_КонецМесяца={1},ТипПериода={~~~КонецМесяца~~~}>} _ДнейПрошлогоПериодаВМесяце)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиПредМес.Label = Остатки средние пред месяц, руб;
SET ОстаткиПредМес.Comment = Остатки  средняя себестоимость по суммам за предыдущий месяц, руб;
let ПроцентОстаткиПредМес = replace(replace('Money((@(ОстаткиТыс))/(@(ОстаткиПредМес)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиПредМес.Label = % Остатков к пред месяцу;
SET ПроцентОстаткиПредМес.Comment = Процент Остатков к предыдущему месяцу;
let СуммаРостаОстаткиПредМес = replace(replace('Money((@(ОстаткиТыс))-(@(ОстаткиПредМес)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиПредМес.Label = СуммаРоста Остатков к пред месяцу;
SET СуммаРостаОстаткиПредМес.Comment = СуммаРоста Остатков к предыдущему месяцу;
SET СуммаОстаткиПроверкаТыс = Money(Sum({$<ТипДокумента={'TestDataOnHand'}, ТипПериода={'Current'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаОстаткиПроверкаТыс.Label = Остатки проверка тыс.руб.;
SET СуммаОстаткиПроверкаТыс.Comment = Сумма остатков проверка в тыс. руб.;
let СуммаОстаткиРасхожденияТыс = replace(replace('Money(@(ОстатокСебестоимостьНаКонецПериодаТыс) - @(СуммаОстаткиПроверкаТыс),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаОстаткиРасхожденияТыс.Label = Дельта проверка тыс.руб.;
SET СуммаОстаткиРасхожденияТыс.Comment = Дельта остатки проверка в тыс. руб.;
SET КоличествоОстаткиПроверка = Money(Sum({$<ТипДокумента={'TestDataOnHand'}, ТипПериода={'Current'}>}Количество),'# ##0,00');
SET КоличествоОстаткиПроверка.Label = Остатки проверка штук;
SET КоличествоОстаткиПроверка.Comment = Сумма остатков проверка штук;
let КоличествоОстаткиРасхождения = replace(replace('Money(@(ОстатокШтукНаКонецПериода) - @(КоличествоОстаткиПроверка),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоОстаткиРасхождения.Label = Дельта проверка штук;
SET КоличествоОстаткиРасхождения.Comment = Дельта остатки проверка штук;
SET УчСебестоимостьПолный = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Current'}>}Себестоимость)),'# ##0,0');
SET УчСебестоимостьПолный.Label = Себестоимость, руб;
SET УчСебестоимостьПолный.Comment = Учетная себестоимость, руб;
SET УчСебестоимостьПолныйТысРуб = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Current'}>}Себестоимость))/1000,'# ##0,0');
SET УчСебестоимостьПолныйТысРуб.Label = Себестоимость продаж, тыс.руб.;
SET УчСебестоимостьПолныйТысРуб.Comment = Учетная себестоимость, тыс.руб.;
SET УчСебестоимостьБезТранспортныхПолный = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Current'}>}СебестоимостьБезТранспортных)),'# ##0,0');
SET УчСебестоимостьБезТранспортныхПолный.Label = Себестоимость без транспортных, руб;
SET УчСебестоимостьБезТранспортныхПолный.Comment = Учетная себестоимость без транспортных, руб;
SET УчСебестоимостьПолныйПредГод = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год'}>}Себестоимость)/1000),'# ##0,0');
SET УчСебестоимостьПолныйПредГод.Label = Себестоимость пред год, руб;
SET УчСебестоимостьПолныйПредГод.Comment = Учетная себестоимость за предыдущий год, руб;
SET УчСебестоимостьПолныйПредГод2 = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год-2'}>}Себестоимость)/1000),'# ##0,0');
SET УчСебестоимостьПолныйПредГод2.Label = Себестоимость пред.(2) Год, руб;
SET УчСебестоимостьПолныйПредГод2.Comment = Учетная себестоимость за предпредыдущий год, руб;
SET УчСебестоимостьПолныйПредГодДеньНедели = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'ГодДеньНедели'}>}Себестоимость)/1000),'# ##0,0');
SET УчСебестоимостьПолныйПредГодДеньНедели.Label = Себестоимость пред год тот же день недели, руб;
SET УчСебестоимостьПолныйПредГодДеньНедели.Comment = Учетная себестоимость за предыдущий год тот же день недели, руб;
SET УчСебестоимостьПолныйПредГод2ДеньНедели = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год2ДеньНедели'}>}Себестоимость)/1000),'# ##0,0');
SET УчСебестоимостьПолныйПредГод2ДеньНедели.Label = Себестоимость пред.(2) Год тот же день недели, руб;
SET УчСебестоимостьПолныйПредГод2ДеньНедели.Comment = Учетная себестоимость за предпредыдущий год тот же день недели, руб;
SET УчСебестоимостьПолныйПредМесяц = Money((Sum({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}Себестоимость)/1000),'# ##0,0');
SET УчСебестоимостьПолныйПредМесяц.Label = Себестоимость пред месяц, руб;
SET УчСебестоимостьПолныйПредМесяц.Comment = Учетная себестоимость за предыдущий месяц, руб;
let Оборачиваемость = replace(replace('Money((Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~Current~~~}>} Себестоимость)  / (@(ПродажиСебестоимостьИзОстатков))),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET Оборачиваемость.Label = Оборачиваемость, дни;
SET Оборачиваемость.Comment = Оборачиваемость (считается только вплоть до месяцов), дни;
let ПродажиСебестоимостьИзОстатков = replace(replace('Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~Current~~~}>} Сумма)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСебестоимостьИзОстатков.Label = Себестоимость продаж, руб;
SET ПродажиСебестоимостьИзОстатков.Comment = Себестоимость продаж, руб;
let ПродажиСебестоимостьИзОстатковПредГод = replace(replace('Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~Год~~~}>} Сумма)/1000','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСебестоимостьИзОстатковПредГод.Label = Себестоимость продаж, руб;
SET ПродажиСебестоимостьИзОстатковПредГод.Comment = Себестоимость продаж, руб;
let ПродажиСебестоимостьИзОстатковПредГод2 = replace(replace('Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~Год-2~~~}>} Сумма)/1000','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСебестоимостьИзОстатковПредГод2.Label = Себестоимость продаж, руб;
SET ПродажиСебестоимостьИзОстатковПредГод2.Comment = Себестоимость продаж, руб;
let ПродажиСебестоимостьИзОстатковПредМесяц = replace(replace('Sum({$<ТипДокумента = {~~~OnHandSum~~~},@(СбросФильтраПоОстаткам),ТипПериода={~~~ГодМесяц~~~}>} Сумма)/1000','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСебестоимостьИзОстатковПредМесяц.Label = Себестоимость продаж, руб;
SET ПродажиСебестоимостьИзОстатковПредМесяц.Comment = Себестоимость продаж, руб;
let НормаОборачиваемость = replace(replace('Money(Avg({$<ТипДокумента={~~~TurnoverPlan~~~},@(СбросФильтраПоОстаткам),ШкалаЛиквидности,ТипПериода={~~~Current~~~}>} Количество),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET НормаОборачиваемость.Label = Норматив оборачиваемости, дни;
SET НормаОборачиваемость.Comment = Норматив оборачиваемости по третьему уровню классификатора, дни;
let ПФ_Оборачиваемость = replace(replace('Money((@(Оборачиваемость)/@(ПланОборачиваемость)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_Оборачиваемость.Label = % вып. плана Оборачиваемости;
SET ПФ_Оборачиваемость.Comment = ПФ Оборачиваемость;
let П_Ф_Оборачиваемость = replace(replace('Money((-@(ПланОборачиваемость)+@(Оборачиваемость)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_Оборачиваемость.Label = ∆ П-Ф Оборачиваемость, дни;
SET П_Ф_Оборачиваемость.Comment = План минус  факт по оборачиваемости;
let ОборачиваемостьПредГод = replace(replace('Money(((@(ОстаткиПредГодОбщие))/(@(ПродажиСебестоимостьИзОстатковПредГод))),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОборачиваемостьПредГод.Label = Оборачиваемость пред. (1) Год, дни;
SET ОборачиваемостьПредГод.Comment = Оборачиваемость за предыдущий год, дни;
let ПроцентОборачиваемостьПредГод = replace(replace('Money(@(Оборачиваемость)/@(ОборачиваемостьПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОборачиваемостьПредГод.Label = % изм. Оборачиваемости к пред. (1) Год;
SET ПроцентОборачиваемостьПредГод.Comment = Процент Оборачиваемости к предыдущему году;
let СуммаРостаОборачиваемостьПредГод = replace(replace('Money(@(Оборачиваемость)-@(ОборачиваемостьПредГод),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОборачиваемостьПредГод.Label = ∆ изм. Оборачиваемости к пред. (1) Год, дни;
SET СуммаРостаОборачиваемостьПредГод.Comment = СуммаРоста Оборачиваемости к предыдущему году;
let ОборачиваемостьПредГод2 = replace(replace('Money(((@(ОстаткиПредГод2Общие))/(@(ПродажиСебестоимостьИзОстатковПредГод2))),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОборачиваемостьПредГод2.Label = Оборачиваемость пред. (2) Год, дни;
SET ОборачиваемостьПредГод2.Comment = Оборачиваемость за предпредыдущий год, дни;
let ПроцентОборачиваемостьПредГод2 = replace(replace('Money(@(Оборачиваемость)/@(ОборачиваемостьПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОборачиваемостьПредГод2.Label = % изм. Оборачиваемости к пред. (2) Год;
SET ПроцентОборачиваемостьПредГод2.Comment = Процент Оборачиваемости к предыдущему году;
let СуммаРостаОборачиваемостьПредГод2 = replace(replace('Money(@(Оборачиваемость)-@(ОборачиваемостьПредГод2),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОборачиваемостьПредГод2.Label = ∆ изм. Оборачиваемости к пред. (2) Год, дни;
SET СуммаРостаОборачиваемостьПредГод2.Comment = СуммаРоста Оборачиваемости к предыдущему году;
let ОборачиваемостьПредМес = replace(replace('Money(((@(ОстаткиПредМесОбщие))/(@(ПродажиСебестоимостьИзОстатковПредМесяц))),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОборачиваемостьПредМес.Label = Оборачиваемость пред мес, дни;
SET ОборачиваемостьПредМес.Comment = Оборачиваемость за предыдущий месяц, дни;
let ПроцентОборачиваемостьПредМес = replace(replace('Money(@(Оборачиваемость)/@(ОборачиваемостьПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОборачиваемостьПредМес.Label = % Оборачиваемости к пред мес;
SET ПроцентОборачиваемостьПредМес.Comment = Процент Оборачиваемости к предыдущему месяц;
let СуммаРостаОборачиваемостьПредМес = replace(replace('Money(@(Оборачиваемость)-@(ОборачиваемостьПредМес),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОборачиваемостьПредМес.Label = СуммаРоста Оборачиваемости к пред мес;
SET СуммаРостаОборачиваемостьПредМес.Comment = СуммаРоста Оборачиваемости к предыдущему месяц;
SET СуммаСкидки = Money((Sum({$<ТипДокумента={'Sales'},ТипПериода={'Current'}>}Скидка)),'# ##0,00');
SET СуммаСкидки.Label = Сумма скидки, руб;
SET СуммаСкидки.Comment = Сумма предоставленной скидки в руб.;
SET СуммаСкидкиТыс = Money((Sum({$<ТипДокумента={'Sales'},ТипПериода={'Current'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТыс.Label = Сумма скидки, тыс.руб.;
SET СуммаСкидкиТыс.Comment = Сумма предоставленной скидки в тыс. руб.;
SET СуммаСкидкиТысПредГод = Money((Sum({$<ТипДокумента={'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТысПредГод.Label = Сумма скидки пред. (1) Год, тыс.руб.;
SET СуммаСкидкиТысПредГод.Comment = Сумма предоставленной скидки за пред год в тыс. руб.;
let ПроцентСуммаСкидкиТысПредГод = replace(replace('Money(@(СуммаСкидкиТыс)/@(СуммаСкидкиТысПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаСкидкиТысПредГод.Label = % изм.суммы Скидки к пред. (1) Год;
SET ПроцентСуммаСкидкиТысПредГод.Comment = Процент Суммы скидки к предыдущему году;
let СуммаРостаСуммаСкидкиТысПредГод = replace(replace('Money(@(СуммаСкидкиТыс)-@(СуммаСкидкиТысПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаСкидкиТысПредГод.Label = ∆ изм. %Скидок к пред. (1) Год;
SET СуммаРостаСуммаСкидкиТысПредГод.Comment = Изменение Суммы скидки к предыдущему году;
SET СуммаСкидкиТысПредГод2 = Money((Sum({$<ТипДокумента={'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год-2'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТысПредГод2.Label = Сумма скидки пред. (2) Год, тыс.руб.;
SET СуммаСкидкиТысПредГод2.Comment = Сумма предоставленной скидки за предпред год в тыс. руб.;
let ПроцентСуммаСкидкиТысПредГод2 = replace(replace('Money(@(СуммаСкидкиТыс)/@(СуммаСкидкиТысПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаСкидкиТысПредГод2.Label = % изм.суммы скидки к пред. (2) Год;
SET ПроцентСуммаСкидкиТысПредГод2.Comment = Процент суммы скидки к пердпредыдущему году;
let СуммаРостаСуммаСкидкиТысПредГод2 = replace(replace('Money(@(СуммаСкидкиТыс)-@(СуммаСкидкиТысПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаСкидкиТысПредГод2.Label = ∆ изм. %Скидок к пред. (2) Год;
SET СуммаРостаСуммаСкидкиТысПредГод2.Comment = Изменение суммы скидки к предпредыдущему году;
SET СуммаСкидкиТысПредГодДеньНедели = Money((Sum({$<ТипДокумента={'Sales'},_ФлагДействующаяДата={1},ТипПериода={'ГодДеньНедели'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТысПредГодДеньНедели.Label = Сумма скидки пред. (1) Год тот же день недели, тыс.руб.;
SET СуммаСкидкиТысПредГодДеньНедели.Comment = Сумма предоставленной скидки за пред год тот же день недели в тыс. руб.;
let ПроцентСуммаСкидкиТысПредГодДеньНедели = replace(replace('Money(@(СуммаСкидкиТыс)/@(СуммаСкидкиТысПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаСкидкиТысПредГодДеньНедели.Label = % изм.суммы Скидки к пред. (1) Год тот же день недели;
SET ПроцентСуммаСкидкиТысПредГодДеньНедели.Comment = Процент Суммы скидки к предыдущему году тот же день недели;
let СуммаРостаСуммаСкидкиТысПредГодДеньНедели = replace(replace('Money(@(СуммаСкидкиТыс)-@(СуммаСкидкиТысПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаСкидкиТысПредГодДеньНедели.Label = ∆ изм. %Скидок к пред. (1) Год тот же день недели;
SET СуммаРостаСуммаСкидкиТысПредГодДеньНедели.Comment = Изменение Суммы скидки к предыдущему году тот же день недели;
SET СуммаСкидкиТысПредГод2ДеньНедели = Money((Sum({$<ТипДокумента={'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Год2ДеньНедели'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТысПредГод2ДеньНедели.Label = Сумма скидки пред. (2) Год тот же день недели, тыс.руб.;
SET СуммаСкидкиТысПредГод2ДеньНедели.Comment = Сумма предоставленной скидки за предпредыдущий год тот же день недели в тыс. руб.;
let ПроцентСуммаСкидкиТысПредГод2ДеньНедели = replace(replace('Money(@(СуммаСкидкиТыс)/@(СуммаСкидкиТысПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаСкидкиТысПредГод2ДеньНедели.Label = % изм.суммы скидки к пред. (2) Год тот же день недели;
SET ПроцентСуммаСкидкиТысПредГод2ДеньНедели.Comment = Процент суммы скидки к пердпредыдущему году тот же день недели;
let СуммаРостаСуммаСкидкиТысПредГод2ДеньНедели = replace(replace('Money(@(СуммаСкидкиТыс)-@(СуммаСкидкиТысПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаСкидкиТысПредГод2ДеньНедели.Label = ∆ изм. %Скидок к пред. (2) Год тот же день недели;
SET СуммаРостаСуммаСкидкиТысПредГод2ДеньНедели.Comment = Изменение суммы скидки к предпредыдущему году тот же день недели;
SET СуммаСкидкиТысПредМес = Money((Sum({$<ТипДокумента={'Sales'},_ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}Скидка)/1000),'# ##0,00');
SET СуммаСкидкиТысПредМес.Label = Сумма скидки пред мес, тыс.руб.;
SET СуммаСкидкиТысПредМес.Comment = Сумма предоставленной скидки за предыдущий месяц в тыс. руб.;
let ПроцентСуммаСкидкиТысПредМес = replace(replace('Money(@(СуммаСкидкиТыс)/@(СуммаСкидкиТысПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаСкидкиТысПредМес.Label = % Суммы скидки к пред мес;
SET ПроцентСуммаСкидкиТысПредМес.Comment = Процент Суммы скидки к предыдущему месяцу;
let СуммаРостаСуммаСкидкиТысПредМес = replace(replace('Money(@(СуммаСкидкиТыс)-@(СуммаСкидкиТысПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаСкидкиТысПредМес.Label = Изменение суммы скидки к пред мес;
SET СуммаРостаСуммаСкидкиТысПредМес.Comment = Изменение Суммы скидки к предыдущему месяцу;
let ПроцентСкидки = replace(replace('Money(alt(@(СуммаСкидки)/(@(СуммаПродажи)+@(СуммаСкидки)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидки.Label = Процент скидки;
SET ПроцентСкидки.Comment = Процент предоставленной скидки;
let ПроцентСкидкиПредГод = replace(replace('Money(alt(@(СуммаСкидкиТысПредГод)/(@(ПродажиПредГод)+@(СуммаСкидкиТысПредГод)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиПредГод.Label = % Скидки пред. (1) Год;
SET ПроцентСкидкиПредГод.Comment = Процент предоставленной скидки за пред год;
let ПроцентПроцентСкидкиПредГод = replace(replace('Money(@(ПроцентСкидки)/@(ПроцентСкидкиПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПроцентСкидкиПредГод.Label = % изм. %Скидки к пред. (1) Год;
SET ПроцентПроцентСкидкиПредГод.Comment = Процент от Процента скидки к предыдущему году;
let СуммаРостаСПроцентСкидкиПредГод = replace(replace('Money(@(ПроцентСкидки)-@(ПроцентСкидкиПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСПроцентСкидкиПредГод.Label = ∆ изм. %Скидок к пред. (1) Год;
SET СуммаРостаСПроцентСкидкиПредГод.Comment = Изменение от Процента скидки к предыдущему году;
let ПроцентСкидкиПредГод2 = replace(replace('Money(alt(@(СуммаСкидкиТысПредГод2)/(@(ПродажиПредГод2)+@(СуммаСкидкиТысПредГод2)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиПредГод2.Label = % Скидки пред. (2) Год;
SET ПроцентСкидкиПредГод2.Comment = Процент предоставленной скидки за предпред год;
let ПроцентПроцентСкидкиПредГод2 = replace(replace('Money(@(ПроцентСкидки)/@(ПроцентСкидкиПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПроцентСкидкиПредГод2.Label = % изм. %Скидки к пред. (2) Год;
SET ПроцентПроцентСкидкиПредГод2.Comment = Процент от Процента скидки к предпредыдущему году;
let СуммаРостаСПроцентСкидкиПредГод2 = replace(replace('Money(@(ПроцентСкидки)-@(ПроцентСкидкиПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСПроцентСкидкиПредГод2.Label = ∆ изм. %Скидок к пред. (2) Год;
SET СуммаРостаСПроцентСкидкиПредГод2.Comment = Изменение от Процента скидки к предпредыдущему году;
let ПроцентСкидкиПредМес = replace(replace('Money(alt(@(СуммаСкидкиТысПредМес)/(@(ПродажиПредМес)+@(СуммаСкидкиТысПредМес)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиПредМес.Label = Процент скидки пред мес;
SET ПроцентСкидкиПредМес.Comment = Процент предоставленной скидки  предыдущего месяца;
let ПроцентПроцентСкидкиПредМес = replace(replace('Money(@(ПроцентСкидки)/@(ПроцентСкидкиПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентПроцентСкидкиПредМес.Label = % Процента скидки к пред мес;
SET ПроцентПроцентСкидкиПредМес.Comment = Процент от Процента скидки к предыдущему месяцу;
let СуммаРостаСПроцентСкидкиПредМес = replace(replace('Money(@(ПроцентСкидки)-@(ПроцентСкидкиПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСПроцентСкидкиПредМес.Label = Изменение процента скидки к пред мес;
SET СуммаРостаСПроцентСкидкиПредМес.Comment = Изменение от Процента скидки к предыдущему месяцу;
SET ПредМесГраницаКрасного = 0.95;
SET ПредМесГраницаЗеленого = 1.05;
SET ПредМесГраницаКрасного2 = 0.90;
SET ПредМесГраницаЗеленого2 = 1.10;
let ГруппаПланГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_План=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) месяц~~~ ,0.8,0))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаПГГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_ПГ=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) месяц~~~,0.8,0))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаПланСкидкаГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_План=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) месяц~~~,1.2,10000000000))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаПГСкидкаГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_ПГ=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) месяц~~~,1.2,10000000000))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаПланОстаткиГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_План=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_План=~~~% изм. к пред (-1) месяц~~~,1.2,10000000000))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаПГОстаткиГраницаКрасного = replace(replace('@(=if(_ГруппаПоказателей_ПГ=~~~% изм. План-Факт~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-2) год~~~ or _ГруппаПоказателей_ПГ=~~~% изм. к пред (-1) месяц~~~,1.2,10000000000))','~~~', chr(39)), '@(', chr(36) & '(');
SET ПредГодГраницаКрасного = 0.90;
SET ПредГодГраницаЗеленого = 1.10;
SET ПредГодГраницаКрасного2 = 0.80;
SET ПредГодГраницаЗеленого2 = 1.20;
let ЦветФонаМатрица = replace(replace('if(@(КоличествоСКУОстаток)=0, rgb(255,60,60), if( @(СуммаПродажиТыс)=0, LightCyan(), if (@(ГруппаВыражение(ПоказательАбс,~~~Факт~~~))>=0 , ColorMix1 (Fabs(@(=Alt(Only({ПоказательАбс} _ГП_ПоказательАбс_ФлагОстатки),0)) - (@(ГруппаВыражение(ПоказательАбс,~~~Факт~~~))/max(TOTAL<НоменклатураНаименование> aggr(@(ГруппаВыражение(ПоказательАбс,~~~Факт~~~)),НоменклатураНаименование,@(Измерение(ГруппаСклад)))))) , ARGB(0, 250, 250, 120), ARGB(250, 80, 242, 100)), RGB(250, 250, 120) )))','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбранныеПоляКалендаря = =if(GetSelectedCount(Дата)>0, ',Дата={"' & GetFieldSelections(Дата,'","',1000) &'"}', '') & if(GetSelectedCount(Год)>0, ',Год={"' & GetFieldSelections(Год,'","',1000) &'"}', '') & if(GetSelectedCount(Месяц)>0, ',Месяц={"' & GetFieldSelections(Месяц,'","',1000) &'"}', '');
SET ГрупповоеВыражение_ФорматТыс = If(IsNull(Only({$1 <ГП_$1={$2}>}  _ГП_$1_ФорматТыс)),'млн','тыс');
SET ГрупповоеВыражение_ФорматМлн = If(IsNull(Only({$1 <ГП_$1={$2}>}  _ГП_$1_ФорматМлн)),'мрд','млн');
SET ГрупповоеВыражение_ОтносительныйПоказатель = (Only({$1 <ГП_$1={$2}>}  _ГП_$1_ФлагОтносительныйПоказатель) = 1);
SET ГрупповоеВыражение_ФорматМрд = If(IsNull(Only({$1 <ГП_$1={$2}>}  _ГП_$1_ФорматМлрд)),'трн','мрд');
SET ПоказатьОстаткиПоМесяцам = (only(_Группа$1)='Дата'  or only(_Группа$1)='Неделя' or only(_Группа$1)='Посл 8 Дней') and (only(_ГруппаПоказателей_$2)='Остатки' or only(_ГруппаПоказателей_$2)='Оборачиваемость');
SET СтрелкаТренда = if ($1 = 0 OR IsNull($1), null(), 'qmem://<builtin>/' & if($1 >= 1.20,'Arrow_N_G.png', if($1 >= 1.051,'Arrow_NE_G.png', if($1 >= 1.05 ,'Arrow_NE_G.png', if($1 >= 1,'Arrow_E_Y.png', if($1 >= .95 ,'Arrow_W_Y.png', if($1 >= .801  ,'Arrow_SE_R.png', if($1 >= .80 ,'Arrow_S_R.png', if($1 >= 0 ,'Arrow_S_R.png','Arrow_S_R.png') ))))))));
SET СтрелкаТренда.Label = СтрелкаТренда;
let ТрендПродажиПредГод = replace(replace('if (@(ПроцентПродажиПредГод) = 0 OR IsNull(@(ПроцентПродажиПредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентПродажиПредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентПродажиПредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентПродажиПредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентПродажиПредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентПродажиПредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентПродажиПредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентПродажиПредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентПродажиПредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендПродажиПредГод.Comment = Тренд продаж к предыдущему году;
let ТрендВППредГод = replace(replace('if (@(ПроцентВППредГод) = 0 OR IsNull(@(ПроцентВППредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентВППредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентВППредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентВППредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентВППредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентВППредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентВППредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентВППредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентВППредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендВППредГод.Comment = Тренд ВП к предыдущему году;
let ТрендРентВППредГод = replace(replace('if (@(ПроцентРентВППредГод) = 0 OR IsNull(@(ПроцентРентВППредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентРентВППредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентРентВППредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентРентВППредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентРентВППредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентРентВППредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентРентВППредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентРентВППредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентРентВППредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендРентВППредГод.Comment = Тренд рентабельности ВП к предыдущему году;
let ТрендОборачиваемостьПредГод = replace(replace('if (@(ПроцентОборачиваемостьПредГод) = 0 OR IsNull(@(ПроцентОборачиваемостьПредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентОборачиваемостьПредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентОборачиваемостьПредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендОборачиваемостьПредГод.Comment = Тренд оборачиваемости к предыдущему году;
let ТрендОстаткиПредГод = replace(replace('if (@(ПроцентОстаткиПредГод) = 0 OR IsNull(@(ПроцентОстаткиПредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентОстаткиПредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентОстаткиПредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентОстаткиПредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентОстаткиПредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентОстаткиПредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентОстаткиПредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентОстаткиПредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентОстаткиПредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендОстаткиПредГод.Comment = Тренд остатков к предыдущему году;
let ТрендСуммаСкидкиПредГод = replace(replace('if (@(ПроцентСуммаСкидкиТысПредГод) = 0 OR IsNull(@(ПроцентСуммаСкидкиТысПредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентСуммаСкидкиТысПредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентСуммаСкидкиТысПредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендСуммаСкидкиПредГод.Comment = Тренд суммы скидки к предыдущему году;
let ТрендПроцентСкидкиПредГод = replace(replace('if (@(ПроцентПроцентСкидкиПредГод) = 0 OR IsNull(@(ПроцентПроцентСкидкиПредГод)), null(), ~~~qmem://<builtin>/~~~ & if(@(ПроцентПроцентСкидкиПредГод) >= 1.20,~~~Arrow_N_G.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= 1.051,~~~Arrow_NE_G.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= 1.05 ,~~~Arrow_NE_G.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= 1,~~~Arrow_E_Y.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= .95 ,~~~Arrow_W_Y.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= .801  ,~~~Arrow_SE_R.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= .80 ,~~~Arrow_S_R.png~~~, if(@(ПроцентПроцентСкидкиПредГод) >= 0 ,~~~Arrow_S_R.png~~~,~~~Arrow_S_R.png~~~) ))))))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ТрендПроцентСкидкиПредГод.Comment = Тренд процента скидок к предыдущему году;
let КоличествоДней = replace(replace('=COUNT(DISTINCT {1<_ФлагДействующаяДата={1} @(ВыбранныеПоляКалендаря)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоДней.Label = КоличествоДней;
let КоличествоДнейВключаяБудущийПериод = replace(replace('=COUNT(DISTINCT {1<_ФлагДействующаяДата= @(ВыбранныеПоляКалендаря)>} Дата)','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаВыражение = replace(replace('@(@(=Only({$1 <ГП_$1={$2}>}  _ГП_$1)))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаЗаголовок = replace(replace('@(=Only({$1 <ГП_$1={$2}>}  _ГП_$1) & ~~~.Заголовок~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаОписание = replace(replace('@(=Only({$1 <ГП_$1={$2}>}  _ГП_$1) & ~~~.Описание~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаВыражениеПредГодОтладка = replace(replace('Only({$1 <ГП_$1={@(=chr(39) & Only({<ГП_ТипПоказателя={ПредГод}>} _ГП_ТипПоказателя) & chr(39))}>}  _ГП_$1)','~~~', chr(39)), '@(', chr(36) & '(');
SET ГруппаВыражениеОтладка = Only({$1 <ГП_$1={$2}>}  _ГП_$1);
let Измерение = replace(replace('@(=Only({$1} _$1_Измерение))','~~~', chr(39)), '@(', chr(36) & '(');
let Календарь = replace(replace('@(=If(Only({$2} _ГП_$2_ФлагОстатки)= 1 AND (only({$1} _$1)=~~~Дата~~~  or only({$1} _$1)=~~~Неделя~~~ or only({$1} _$1)=~~~Посл 8 Дней~~~),~~~ГодМесяц~~~,Only({$1} _$1_Измерение)))','~~~', chr(39)), '@(', chr(36) & '(');
let ВыбранКлассификатор = replace(replace('~~~@(Измерение($1))~~~=~~~[Классификатор товаров]~~~','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбранКлассификатор.Comment = Пример:    ВыбранКлассификатор(ГруппаКлассификатор) или ВыбранКлассификатор(ГруппаИзмерений);
let ВыбранНоменклатура = replace(replace('~~~@(Измерение($1))~~~=~~~НоменклатураНаименование~~~','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбранНоменклатура.Comment = Пример:    ВыбранНоменклатура(ГруппаКлассификатор) или ВыбранНоменклатура(ГруппаИзмерений);
let ВыбранКомпания = replace(replace('~~~@(Измерение($1))~~~=~~~[Компания в целом]~~~','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбранКомпания.Comment = Пример:    ВыбранКомпания(ГруппаСклад) или ВыбранКомпания(ГруппаИзмерений);
let ВыбраноМеню = replace(replace('~~~@(=Only({ГруппаМеню} _ГруппаМеню_Измерение))~~~=~~~$1~~~','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбраноМеню.Comment = Пример:    ВыбраноМеню(DynLFL) или ВыбраноМеню(Abc);
let Выбран1ЗначениеИзмерения = replace(replace('Count(DISTINCT @(Измерение($1))) = 1','~~~', chr(39)), '@(', chr(36) & '(');
SET Выбран1ЗначениеИзмерения.Comment = Пример:    Выбран1ЗначениеИзмерения(ГруппаСклад) или Выбран1ЗначениеИзмерения(ГруппаИзмерений);
let ПоказателиНесовместимы = replace(replace('If(Count({<_ГП_Ошибки_$1={$2}>} _ГП_Ошибки_$1_ГруппаИзмерений)=0,0, If(MinString({<_ГП_Ошибки_$1={$2}>} _ГП_Ошибки_$1_ГруппаИзмерений)=~~~*~~~ AND GetSelectedCount(Канал)>0, -1, Count({<_ГП_Ошибки_$1={$2},_ГП_Ошибки_$1_ГруппаИзмерений={~~~@(=Only(_ГруппаИзмерений))~~~}>} _ГП_Ошибки_$1_ГруппаИзмерений)=1))','~~~', chr(39)), '@(', chr(36) & '(');
SET ПоказателиНесовместимы.Label = ПоказателиНесовместимы;
let СкроллПоказатель = replace(replace('aggr(Rank(@(ГруппаВыражение(ПоказательАбс,~~~Факт~~~)),4),@(=Only(_ГруппаИзмерений_Измерение)))','~~~', chr(39)), '@(', chr(36) & '(');
SET СкроллПоказатель.Label = СкроллПоказатель;
SET СкроллВид = (if(СкроллМакс-СкроллИзмерении<0,1,СкроллИзмерении-СкроллИзмерений2));
let СкроллМакс = replace(replace('(Count(DISTINCT @(=Only(_ГруппаИзмерений_Измерение))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ГруппаВыбранаПоказатель = IsNull(Only(_ГруппаПоказателей_$1)) = 0;
let ПоказательСУчетомНедель = replace(replace('@(=if(Only({$1} _ГП_$1_ФлагОстатки)<> 1 and (Only({$3} _$3)=~~~Дата~~~ or Only({$3} _$3)=~~~Неделя~~~or Only({$3} _$3)=~~~Посл 8 Дней~~~) and WildMatch(Only({$1} _$1),~~~*месяц*~~~)=0, ~~~@(=Only({$1 <ГП_$1={$2}>}  _ГП_$1))~~~ & ~~~ДеньНедели~~~, ~~~@(=Only({$1 <ГП_$1={$2}>}  _ГП_$1))~~~))','~~~', chr(39)), '@(', chr(36) & '(');
let ТрендПредГод = replace(replace('@(=if(Only({$2} _$2)=~~~Дата~~~ or Only({$2} _$2)=~~~Неделя~~~or Only({$2} _$2)=~~~Посл 8 Дней~~~, ~~~$1~~~ & ~~~ДеньНедели~~~, ~~~$1~~~))','~~~', chr(39)), '@(', chr(36) & '(');
SET КрасныйШрифт = Money(Only({<ГП_$1={$2}>}  _ГП_$1_КраснаяГраница));
SET _1.ПустоеВыражение = 'Формула не найдена';
SET __.Empty = '_1.ПустоеВыражение';
let ВыражениеДляКарточки = replace(replace('@(@(=Only({<ГП_$1={$3},_ГруппаПоказателей_$1={$2}>}  _ГП_$1)))','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыражениеДляКарточки.Comment = Пример использования: ВыражениеДляКарточки(ПоказательАбс,'Наценка','ПредМес');
SET ВыражениеДляКарточкиОтладка = Only({<ГП_$1={$3},_ГруппаПоказателей_$1={$2}>}  _ГП_$1);
SET Меню_tab = 0;
SET HomeSheet = 'SH32';
SET Субменю_tab = 0;
SET СкрытьЛисты = 0;
SET ЛистЧеки_Вкладки = 0;
SET Абс_Отн = 1;
SET Проверка_Календаря =  if( GetSelectedCount(Дата)>0,1, if (GetSelectedCount(Год)>0 and  (GetSelectedCount(Полугодие)>0 or GetSelectedCount(Квартал)>0 or GetSelectedCount(Месяц)>0 or GetSelectedCount(ГодПолугодие)>0 or GetSelectedCount(ГодКвартал)>0 or GetSelectedCount(ГодМесяц)>0 or GetSelectedCount(ГодНеделя)>0 or GetSelectedCount(День)>0 or GetSelectedCount(ДеньНедели)>0 or GetSelectedCount(ДеньИНомерНедели)>0 ) ,1,0));
SET Проверка_Календаря.Label = Проверка_Календаря;
SET Проверка_Календаря.Comment = Проверка_Календаря;
let ГруппаВыбрана = replace(replace('IsNull(Only({$1} _ГруппаПоказателей_$1)) = 0 AND Left(Only({$1} _ГруппаПоказателей_$1),1) <> ~~~ ~~~ AND If(@(ВыбранПлановыйПоказатель($1)),@(ФлагПланУстановлен(ГруппаСклад)),-1)','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаВыбрана.Comment = replace(replace('Формула для использовании в Show Condition. Примеры использования: @(ГруппаВыбрана(План)) @(ГруппаВыбрана(ПГ))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаВыбранаБезПлановыхПоказателей = replace(replace('IsNull(Only({$1} _ГруппаПоказателей_$1)) = 0 AND Left(Only({$1} _ГруппаПоказателей_$1),1) <> ~~~ ~~~ AND If(@(ВыбранПлановыйПоказатель($1)),0,@(ФлагПланУстановлен(ГруппаСклад)))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаВыбранаБезПлановыхПоказателей.Comment = replace(replace('Формула для использовании в Show Condition. Примеры использования: @(ГруппаВыбрана(План)) @(ГруппаВыбрана(ПГ))','~~~', chr(39)), '@(', chr(36) & '(');
SET ПоказательВыбран = Left(Only({$1} _ГруппаПоказателей_$1),1) <> ' ';
let ПоказательВыбран.Comment = replace(replace('Формула для использовании в Show Condition. Примеры использования: @(ПоказательВыбран(План)) @(ПоказательВыбран(ПГ))','~~~', chr(39)), '@(', chr(36) & '(');
let ГруппаИзмерений_План = replace(replace('@(=if(@(УстановленФильтрПоИзмерениюБезПлана),0,If(Only({ГруппаИзмерений} _ГруппаИзмерений_Измерение)=~~~[Классификатор товаров]~~~, Only({ГруппаИзмерений <_ГруппаИзмерений={~~~@(=GetCurrentField([Классификатор товаров]))~~~}>} _ГруппаИзмерений_План), Only({ГруппаИзмерений} _ГруппаИзмерений_План))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ГруппаИзмерений_План.Comment = Условие отображения плановых показателей;
let ФлагПланУстановлен = replace(replace('@(=if(@(УстановленФильтрПоИзмерениюБезПлана),0,If(Only({$1} _$1_Измерение)=~~~[Классификатор товаров]~~~, Only({$1 <_$1={~~~@(=GetCurrentField([Классификатор товаров]))~~~}>} _$1_План), Only({$1} _$1_План))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ФлагПланУстановлен.Comment = Условие отображения плановых показателей;
let ВыбранПлановыйПоказатель = replace(replace('@(=Only({$1} _ГруппаПоказателей_$1) = ~~~План~~~ or Only({$1} _ГруппаПоказателей_$1) = ~~~% изм. План-Факт~~~ or Only({$1} _ГруппаПоказателей_$1) = ~~~∆ изм. План-Факт~~~ or Only({$1} _ГруппаПоказателей_$1) = ~~~План за  полный месяц~~~)','~~~', chr(39)), '@(', chr(36) & '(');
let УстановленФильтрПоИзмерениюБезПлана = replace(replace('@(=GetSelectedCount(Подкатегория) +GetSelectedCount(НоменклатураНаименование)+GetSelectedCount(Клиент) +GetSelectedCount(Подкатегория)+GetSelectedCount(Производитель))','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбранПоказательСПланом = (Only({$1} _ГруппаПоказателей_$1) = 'Продажи' OR Only({$1} _ГруппаПоказателей_$1) = 'Валовая прибыль' OR Only({$1} _ГруппаПоказателей_$1) = '% Маржи' OR Only({$1} _ГруппаПоказателей_$1) = 'Остатки' OR Only({$1} _ГруппаПоказателей_$1) = 'Оборачиваемость' OR Only({$1} _ГруппаПоказателей_$1) = 'Проданные SKU, ед.' OR Only({$1} _ГруппаПоказателей_$1) = 'Коэффициент обслуживания, %' OR Only({$1} _ГруппаПоказателей_$1) = 'Коэффициент ТайПо, %' OR Only({$1} _ГруппаПоказателей_$1) = 'ISE, %');
SET ЗаголовокИзмерения = Only({$1} _$1) & Chr(10) & text('Выбрано: ' & Chr(10) &(GetCurrentSelections(Chr(10) ,'= ',',',30)))& Chr(10);
SET ЗаголовокНоменклатураКод = 'Номенклатура Код' & Chr(10) & text('Выбрано: ' & Chr(10) &(GetCurrentSelections(Chr(10) ,'= ',',',30)))& Chr(10);
let ИзмерениеНоменклатураНепустаяСтрока = replace(replace('aggr(If(Min(МатричныйТовар) = 1 OR Alt(@(СуммаПродажиТыс),0)<>0 OR Alt(@(ОстатокШтукНаКонецПериода),0)<> 0 ,НоменклатураКод),НоменклатураКод, СкладКод)','~~~', chr(39)), '@(', chr(36) & '(');
let КоличествоСтрокНоменклатураСклад = replace(replace('Sum(aggr(If(Min(МатричныйТовар) = 1 OR Alt(@(СуммаПродажиТыс),0)<>0 OR Alt(@(ОстатокШтукНаКонецПериода),0)<> 0 ,1, 0),НоменклатураКод,Склад))','~~~', chr(39)), '@(', chr(36) & '(');
SET НичегоНеВыбрано = GetSelectedCount(_ГруппаПоказателей_$1, 0, '$1') = 0;
let ЗаголовокИзмеренияСклад = replace(replace('@(НаименованиеИзмерения(ГруппаСклад)) & Chr(10) & text(~~~Выбрано: ~~~ & Chr(10) &(GetCurrentSelections(Chr(10) ,~~~= ~~~,~~~,~~~,30)))& Chr(10)','~~~', chr(39)), '@(', chr(36) & '(');
let НаименованиеИзмерения = replace(replace('@(=Only({$1} _$1))','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбраноПустоеЗначение = Len(Trim(Only({$1} _$1)))=0;
let ВыбраноЗначение = replace(replace('~~~@(=Only({$1} _$1))~~~=$2','~~~', chr(39)), '@(', chr(36) & '(');
SET ЗаголовокИзмеренияФильтр = Only(_ГруппаФильтр) & Chr(10) & text('Выбрано: ' & Chr(10) &(GetCurrentSelections(Chr(10) ,'= ',',',30)))& Chr(10);
let ГруппаВыражениеПредГод2 = replace(replace('@(@(=Only({<ГП_$1={@(=chr(39) & Only({<ГП_ТипПоказателя={ПредГод2}>} _ГП_ТипПоказателя) & chr(39))}>}  _ГП_$1)))','~~~', chr(39)), '@(', chr(36) & '(');
SET ВыбраноПлановоеИзмерение = WildMatch('Склад,Группа складов,Операционный Директор','*' & Only({$1} _$1) & '*') > 0;
SET ВыбранПоказательКонструктора = SubStringCount(Concat({Конструктор} _ГруппаПоказателей_Конструктор,' | '),$1);
SET НормативOOS = 0.15;
SET ТорговыеДни = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Current'}>} Количество),'# ##0');
SET ТорговыеДни.Label = Торговые дни;
SET ТорговыеДни.Comment = Количество дней наличия на складе на начало торгового дня (с учетом продаж);
SET ТорговыеДниРегламентные = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Current'}>} Сумма),'# ##0');
SET ТорговыеДниРегламентные.Label = Торговые дни регламентные;
SET ТорговыеДниРегламентные.Comment = Максимально возможное количество дней наличия на складе товара;
let ДниДефицитаРегламентные = replace(replace('Money(@(ТорговыеДниРегламентные)-RangeMin(@(ТорговыеДниРегламентные),@(ТорговыеДни)),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДниДефицитаРегламентные.Label = Дни дефицита регламентные;
SET ДниДефицитаРегламентные.Comment = Количество дней отсутствия товара на складах;
let OutOfStock = replace(replace('Money((1-@(ТорговыеДни)/@(ТорговыеДниРегламентные)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET OutOfStock.Label = %OOS;
SET OutOfStock.Comment = Out Of Stock (отношение в днях);
SET ТорговыеДниПредГод = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Год'}>} Количество),'# ##0');
SET ТорговыеДниПредГод.Label = Торговые дни пред год;
SET ТорговыеДниПредГод.Comment = Количество дней наличия на складе на начало торгового дня (с учетом продаж) пред год;
SET ТорговыеДниРегламентныеПредГод = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Год'}>} Сумма),'# ##0');
SET ТорговыеДниРегламентныеПредГод.Label = Торговые дни регламентные пред год;
SET ТорговыеДниРегламентныеПредГод.Comment = Максимально возможное количество дней наличия на складе матричного товара пред год;
let ДниДефицитаРегламентныеПредГод = replace(replace('Money(@(ТорговыеДниРегламентныеПредГод)-RangeMin(@(ТорговыеДниРегламентныеПредГод),@(ТорговыеДниПредГод)),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДниДефицитаРегламентныеПредГод.Label = Дни дефицита регламентные пред год;
SET ДниДефицитаРегламентныеПредГод.Comment = Количество дней отсутствия товара на складах пред год;
let OutOfStockПредГод = replace(replace('Money((1-@(ТорговыеДниПредГод)/@(ТорговыеДниРегламентныеПредГод)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET OutOfStockПредГод.Label = %OOS пред год;
SET OutOfStockПредГод.Comment = Out Of Stock (отношение в днях) пред год;
let ПроцентOutOfStockПредГод = replace(replace('Money(@(OutOfStock)/@(OutOfStockПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентOutOfStockПредГод.Label = %OOS к пред году;
SET ПроцентOutOfStockПредГод.Comment = Процент от %OOS к предыдущему году;
SET ТорговыеДниПредМес = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'ГодМесяц'}>} Количество),'# ##0');
SET ТорговыеДниПредМес.Label = Торговые дни пред месяц;
SET ТорговыеДниПредМес.Comment = Количество дней наличия на складе на начало торгового дня (с учетом продаж) пред месяц;
SET ТорговыеДниРегламентныеПредМес = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'ГодМесяц'}>} Сумма),'# ##0');
SET ТорговыеДниРегламентныеПредМес.Label = Торговые дни регламентные пред месяц;
SET ТорговыеДниРегламентныеПредМес.Comment = Максимально возможное количество дней наличия на складе матричного товара пред месяц;
let ДниДефицитаРегламентныеПредМес = replace(replace('Money(@(ТорговыеДниРегламентныеПредМес)-RangeMin(@(ТорговыеДниРегламентныеПредМес),@(ТорговыеДниПредМес)),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДниДефицитаРегламентныеПредМес.Label = Дни дефицита регламентные пред месяц;
SET ДниДефицитаРегламентныеПредМес.Comment = Количество дней отсутствия товара на складах пред месяц;
let OutOfStockПредМес = replace(replace('Money((1-@(ТорговыеДниПредМес)/@(ТорговыеДниРегламентныеПредМес)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET OutOfStockПредМес.Label = %OOS пред месяц;
SET OutOfStockПредМес.Comment = Out Of Stock (отношение в днях) пред месяц;
let ПроцентOutOfStockПредМес = replace(replace('Money(@(OutOfStock)/@(OutOfStockПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентOutOfStockПредМес.Label = %OOS к пред месяцу;
SET ПроцентOutOfStockПредМес.Comment = Процент от %OOS к предыдущему месяцу;
let СуммаРостаOutOfStockПредМес = replace(replace('Money(@(OutOfStock)-@(OutOfStockПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаOutOfStockПредМес.Label = Рост %OOS к пред месяцу;
SET СуммаРостаOutOfStockПредМес.Comment = Рост %OOS к предыдущему месяцу;
SET ТорговыеДниПредГод2 = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Год-2'}>} Количество),'# ##0');
SET ТорговыеДниПредГод2.Label = Торговые дни предпред год;
SET ТорговыеДниПредГод2.Comment = Количество дней наличия на складе на начало торгового дня (с учетом продаж) предпред год;
SET ТорговыеДниРегламентныеПредГод2 = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Год-2'}>} Сумма),'# ##0');
SET ТорговыеДниРегламентныеПредГод2.Label = Торговые дни регламентные предпред год;
SET ТорговыеДниРегламентныеПредГод2.Comment = Максимально возможное количество дней наличия на складе матричного товара предпред год;
let ДниДефицитаРегламентныеПредГод2 = replace(replace('Money(@(ТорговыеДниРегламентныеПредГод2)-RangeMin(@(ТорговыеДниРегламентныеПредГод2),@(ТорговыеДниПредГод2)),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДниДефицитаРегламентныеПредГод2.Label = Дни дефицита регламентные предпред год;
SET ДниДефицитаРегламентныеПредГод2.Comment = Количество дней отсутствия товара на складах предпред год;
let OutOfStockПредГод2 = replace(replace('Money((1-@(ТорговыеДниПредГод2)/@(ТорговыеДниРегламентныеПредГод2)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET OutOfStockПредГод2.Label = %OOS предпред год;
SET OutOfStockПредГод2.Comment = Out Of Stock (отношение в днях) предпред год;
let ПроцентOutOfStockПредГод2 = replace(replace('Money(@(OutOfStock)/@(OutOfStockПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентOutOfStockПредГод2.Label = %OOS к предпред году;
SET ПроцентOutOfStockПредГод2.Comment = Процент от %OOS к предпредыдущему году;
let Матрица = replace(replace('(Sum({<@(СбросФильтраПоОстаткамПоДням),_ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Sum~~~},ТипДокумента={~~~ChangeMatrix~~~}>} Сумма) + Sum({<@(СбросФильтраПоОстаткамПоДням), _ФлагДействующаяДата={1},ТипПериода={~~~OnHand_Eom~~~},ТипДокумента={~~~OutOfStock~~~}>} ВП))','~~~', chr(39)), '@(', chr(36) & '(');
SET Матрица.Label = Матрица;
SET Матрица.Comment = Статус матрицы;
SET ПланOutOfStock = 0;
SET ПланOutOfStock.Label = Плановый %OOS;
SET ПланOutOfStock.Comment = Плановый %Out Of Stock;
SET ПланOutOfStockПолный = 0;
SET ПланOutOfStockПолный.Label = Плановый %OOS за полный месяц;
SET ПланOutOfStockПолный.Comment = Плановый %Out Of Stock за полный месяц;
let ПФ_OutOfStock = replace(replace('Money((@(OutOfStock))/(@(ПланOutOfStock)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_OutOfStock.Label = ПФ %OOS;
SET ПФ_OutOfStock.Comment = Факт к плану %Out Of Stock;
let П_Ф_OutOfStock = replace(replace('Money((@(OutOfStock))-(@(ПланOutOfStock)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_OutOfStock.Label = ПФ %OOS;
SET П_Ф_OutOfStock.Comment = Факт к плану %Out Of Stock;
SET ДниНаличияНаОстатке = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'Current'}>} Количество),'# ##0');
SET ДниНаличияНаОстатке.Label = Количество дней наличия на складе;
SET ДниНаличияНаОстатке.Comment = Количество дней наличия на складе матричного товара на начало торгового дня (с учетом продаж);
SET ДниНаличияНаОстаткеПредМес = Money(Sum({<ТипДокумента={'OutOfStock'}, ТипПериода={'ГодМесяц'}>} Количество),'# ##0');
SET ДниНаличияНаОстаткеПредМес.Label = Количество дней наличия на складе пред мес;
SET ДниНаличияНаОстаткеПредМес.Comment = Количество дней наличия на складе матричного товара на начало торгового дня (с учетом продаж) предыдущий месяц;
let ВПСреднедневная = replace(replace('Money((@(СуммаВП)/@(ДниНаличияНаОстатке)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ВПСреднедневная.Label = ВП Среднедневная руб.;
SET ВПСреднедневная.Comment = Среднедневная валовая прибыль руб. за выбранный период;
let ВПСреднедневнаяПредрассчитанная = replace(replace('Money((Max({<ТипДокумента={~~~OutOfStock~~~}, ТипПериода={~~~Current~~~}, _МесяцПоПорядку={"@(=Max({<_ФлагДействующаяДата={1}>}_МесяцПоПорядку))"}>} Себестоимость)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ВПСреднедневнаяПредрассчитанная.Label = ВП Среднедневная руб.;
SET ВПСреднедневнаяПредрассчитанная.Comment = Среднедневная валовая прибыль руб. за выбранный период;
let ВПСреднедневнаяПредрассчитаннаяПредМес = replace(replace('Money((Sum({<ТипДокумента={~~~OutOfStock~~~}, ТипПериода={~~~ГодМесяц~~~}, _МесяцПоПорядку={"@(=Max({<_ФлагДействующаяДата={1}>}_МесяцПоПорядку))"}>} Себестоимость)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ВПСреднедневнаяПредрассчитаннаяПредМес.Label = ВП Среднедневная руб.;
SET ВПСреднедневнаяПредрассчитаннаяПредМес.Comment = Среднедневная валовая прибыль руб. за выбранный период;
let ВПСреднедневнаяПредМесТысРуб = replace(replace('Money((@(ВППредМес)/@(ДниНаличияНаОстаткеПредМес)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ВПСреднедневнаяПредМесТысРуб.Label = ВП Среднедневная руб. пред мес;
SET ВПСреднедневнаяПредМесТысРуб.Comment = Среднедневная валовая прибыль руб. за предыдущий месяц;
let УпущеннаяВПТысДинамика = replace(replace('Money(Sum(Aggr(@(ДниДефицитаРегламентные) * @(ВПСреднедневная),НоменклатураСсылка,СкладСсылка))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET УпущеннаяВПТысДинамика.Label = Упущенная прибыль тыс. руб.;
SET УпущеннаяВПТысДинамика.Comment = Упущенная ВП в тыс.руб.;
let УпущеннаяВП = replace(replace('Money(Sum(Aggr(@(ДниДефицитаРегламентные) * @(ВПСреднедневнаяПредрассчитанная),НоменклатураСсылка,СкладСсылка)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET УпущеннаяВП.Label = Упущенная прибыль руб.;
SET УпущеннаяВП.Comment = Упущенная ВП в рублях;
let УпущеннаяВПТыс = replace(replace('Money(Sum(Aggr(@(ДниДефицитаРегламентные) * @(ВПСреднедневнаяПредрассчитанная),НоменклатураСсылка,СкладСсылка))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET УпущеннаяВПТыс.Label = Упущенная прибыль тыс. руб.;
SET УпущеннаяВПТыс.Comment = Упущенная ВП в тыс.руб.;
let УпущеннаяВПТысПредМес = replace(replace('Money(Sum(Aggr(@(ДниДефицитаРегламентныеПредМес) * @(ВПСреднедневнаяПредрассчитаннаяПредМес),НоменклатураСсылка,СкладСсылка))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET УпущеннаяВПТысПредМес.Label = Упущенная прибыль тыс. руб. пред мес;
SET УпущеннаяВПТысПредМес.Comment = Упущенная ВП в тыс.руб. за предыдущий месяц;
let УпущеннаяВПТысДинамикаПредМес = replace(replace('Money(Sum(Aggr(@(ДниДефицитаРегламентныеПредМес) * @(ВПСреднедневнаяПредМесТысРуб),НоменклатураСсылка,СкладСсылка)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET УпущеннаяВПТысДинамикаПредМес.Label = Упущенная прибыль тыс. руб. пред мес;
SET УпущеннаяВПТысДинамикаПредМес.Comment = Упущенная ВП в тыс.руб. за предыдущий месяц;
let ПроцентУпущеннаяВПТысПредМес = replace(replace('Money(@(УпущеннаяВПТыс)/@(УпущеннаяВПТысПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентУпущеннаяВПТысПредМес.Label = % Упущенной прибыли тыс. руб. к пред мес;
SET ПроцентУпущеннаяВПТысПредМес.Comment = Процент Упущенной прибыли к предыдущему месяцу;
let СуммаРостаУпущеннаяВПТысПредМес = replace(replace('Money(@(УпущеннаяВПТыс)-@(УпущеннаяВПТысПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаУпущеннаяВПТысПредМес.Label = Сумма роста Упущенной прибыли к пред мес;
SET СуммаРостаУпущеннаяВПТысПредМес.Comment = Сумма роста Упущенной прибыли к предыдущему месяцу;
SET Мульти_Поиск_Товаров = "";
SET Мульти_Поиск_СкладТовар = "";
SET Тап_на_Вкладке_Остатки =  3;
SET Тап_АнализПродаж =  0;
SET Тап_АнализПродаж.Label = ТТап_АнализПродаж;
SET ЦветПлан = lightRed();
SET ЦветПлан.Label = ЦветПродаж;
SET ЦветПрцПГ = rgb(27,125,156);
SET ЦветПрцПГ.Label = ЦветПродаж;
SET ШрифтЦветПрцПГ = rgb(27,125,156);
SET ШрифтЦветПрцПГ.Label = ЦветПродаж;
SET ЦветОшибки =  rgb(214,231,248);
SET ЦветОшибки.Label = ЦветОшибки;
SET ЦветПродаж =  rgb(98,196,227);
SET ЦветПродаж.Label = ЦветПродаж;
SET ЦветВП =  rgb(173,194,214);
SET ЦветВП.Label = ЦветВП;
SET ЦветОстатки =  rgb(202,225,123);
SET ЦветОстатки.Label = ЦветОстатки;
SET ЦветТрафик =  rgb(202,115,123);
SET ЦветТрафик.Label = ЦветТрафик;
SET ЦветКонверсия =  rgb(202,200,123);
SET ЦветКонверсия.Label = ЦветКонверсия;
SET ЦветКолСделок =  rgb(0,172,172);
SET ЦветКолСделок.Label = ЦветСделок;
SET ЦветКолПродаж =  rgb(211,81,18);
SET ЦветКолПродаж.Label = ЦветКоличестваПродаж;
SET ЦветСуммаОплаты =  rgb(202,160,123);
SET ЦветСуммаОплаты.Label = ЦветСуммаОплаты;
SET ЦветПенетрация =  rgb(74,120,123);
SET ЦветПенетрация.Label = ЦветПенетрация;
SET ЦветСрЧек =  rgb(252,115,98);
SET ЦветСрЧек.Label = ЦветСрЧек;
SET ЦветСуммаСписаний =  rgb(74,120,123);
SET ЦветСуммаСписаний.Label = ЦветСуммаСписаний;
SET ЦветСуммаСкидки =  rgb(237,154,80);
SET ЦветСуммаСкидки.Label = ЦветСуммаСкидки;
SET ЦветПроцентСкидки =  rgb(185,159,83);
SET ЦветПроцентСкидки.Label = ЦветПроцентСкидки;
SET ЦветНаценка =  rgb(156,181,205);
SET ЦветНаценка.Label = ЦветНаценка;
SET ЦветОборачиваемость =  rgb(235,205,40);
SET ЦветОборачиваемость.Label = ЦветОборачиваемость;
SET ЦветПрцНаценка =  rgb(142,152,185);
SET ЦветПрцНаценка.Label = ЦветПрцНаценка;
SET ЦветOutOfStock =  rgb(86,145,203);
SET ЦветOutOfStock.Label = ЦветOutOfStock;
SET ЦветПредГод =  rgb(200,200,200);
SET ЦветПредГод.Label = ЦветПредГод;
SET ЦветПредПредГод =  rgb(220,220,200);
SET ЦветПредПредГод.Label = ЦветПредПредГод;
SET ЦветПФ =  red();
SET ЦветПФ.Label = ЦветПФ;
SET ЦветПроцентПредГод = green();
SET ЦветПроцентПредГод.Label = ЦветПроцентПредГод;
SET ЦветАктКнопки =  rgb(102,255,140);
SET ЦветАктКнопки.Label = ЦветАктКнопки;
SET ЦветНеАктКнопки =  rgb(199,226,226);
SET ЦветНеАктКнопки.Label = ЦветНеАктКнопки;
SET ЦветДлинаЧека =  rgb(86,145,203);
SET ЦветДлинаЧека.Label = ЦветДлинаЧека;
SET СкроллИзмерении = 0;
SET СкроллИзмерений2 = 15;
SET Тап_на_Вкладке_Динамика = 0;
SET Тап_ВидДиаграммы = 0;
SET Показать = 1;
SET Скрыть = 0;
SET ЗаливкаПФ = if ($1 <= 0 OR IsNull($1), rgb(255,255,255), if($1 >= 1.001,rgb(128,255,255), if($1 >= 0.95,rgb(128,255,128), if($1 >= 0.90 ,rgb(225,255,170), if($1 >= 0.8,rgb(255,182,147), if($1 >= 0 ,lightRed(),rgb(255,255,255)) )))));
SET ЗаливкаПФОбратная = if ($1 <= 0 OR IsNull($1), rgb(255,255,255), if($1 <= 0.80,rgb(128,255,255), if($1 <= 0.90,rgb(128,255,128), if($1 <= 0.95 ,rgb(225,255,170), if($1 <= 1.0,rgb(255,182,147), if($1 <= 1000000 ,lightRed(190),rgb(255,255,255)) )))));
let Заливка_ПФ_Продажи = replace(replace('if (@(ПФ_Продажи) <= 0 OR IsNull(@(ПФ_Продажи)), rgb(255,255,255), if(@(ПФ_Продажи) >= 1.001,rgb(128,255,255), if(@(ПФ_Продажи) >= 0.95,rgb(128,255,128), if(@(ПФ_Продажи) >= 0.90 ,rgb(225,255,170), if(@(ПФ_Продажи) >= 0.8,rgb(255,182,147), if(@(ПФ_Продажи) >= 0 ,lightRed(),rgb(255,255,255)) )))))','~~~', chr(39)), '@(', chr(36) & '(');
let Заливка_ПФ_ВП = replace(replace('if (@(ПФ_ВП) <= 0 OR IsNull(@(ПФ_ВП)), rgb(255,255,255), if(@(ПФ_ВП) >= 1.001,rgb(128,255,255), if(@(ПФ_ВП) >= 0.95,rgb(128,255,128), if(@(ПФ_ВП) >= 0.90 ,rgb(225,255,170), if(@(ПФ_ВП) >= 0.8,rgb(255,182,147), if(@(ПФ_ВП) >= 0 ,lightRed(),rgb(255,255,255)) )))))','~~~', chr(39)), '@(', chr(36) & '(');
let Заливка_ПФ_Наценка = replace(replace('if (@(ПФРентВП) <= 0 OR IsNull(@(ПФРентВП)), rgb(255,255,255), if(@(ПФРентВП) >= 1.001,rgb(128,255,255), if(@(ПФРентВП) >= 0.95,rgb(128,255,128), if(@(ПФРентВП) >= 0.90 ,rgb(225,255,170), if(@(ПФРентВП) >= 0.8,rgb(255,182,147), if(@(ПФРентВП) >= 0 ,lightRed(),rgb(255,255,255)) )))))','~~~', chr(39)), '@(', chr(36) & '(');
let Заливка_ПФ_Остатки = replace(replace('if (@(ПФ_Остатки) <= 0 OR IsNull(@(ПФ_Остатки)), rgb(255,255,255), if(@(ПФ_Остатки) <= 0.80,rgb(128,255,255), if(@(ПФ_Остатки) <= 0.90,rgb(128,255,128), if(@(ПФ_Остатки) <= 0.95 ,rgb(225,255,170), if(@(ПФ_Остатки) <= 1.0,rgb(255,182,147), if(@(ПФ_Остатки) <= 1000000 ,lightRed(190),rgb(255,255,255)) )))))','~~~', chr(39)), '@(', chr(36) & '(');
let Заливка_ПФ_Оборачиваемость = replace(replace('if (@(ПФ_Оборачиваемость) <= 0 OR IsNull(@(ПФ_Оборачиваемость)), rgb(255,255,255), if(@(ПФ_Оборачиваемость) <= 0.80,rgb(128,255,255), if(@(ПФ_Оборачиваемость) <= 0.90,rgb(128,255,128), if(@(ПФ_Оборачиваемость) <= 0.95 ,rgb(225,255,170), if(@(ПФ_Оборачиваемость) <= 1.0,rgb(255,182,147), if(@(ПФ_Оборачиваемость) <= 1000000 ,lightRed(190),rgb(255,255,255)) )))))','~~~', chr(39)), '@(', chr(36) & '(');
SET ЦветВычКолонки =  rgb(230,230,230);
SET ЦветВычКолонки.Label = ЦветВычКолонки;
SET ШрифтЦветПФ = Red();
SET ШрифтЦветПФ.Label = ЦветПродаж;
SET ШрифтЦветПлан = rgb(255,255,255);
SET ШрифтЦветПлан.Label = ЦветПродаж;
SET ШрифтЦветПродаж = rgb(255,255,255);
SET ШрифтЦветПродаж.Label = ЦветПродаж;
SET ШрифтЦветВП =  rgb(255,255,255);
SET ШрифтЦветВП.Label = ШрифтЦветВП;
SET ШрифтЦветОстатки =  rgb(80,80,80);
SET ШрифтЦветОстатки.Label = ЦветОстатки;
SET ШрифтЦветТрафик =  rgb(255,255,255);
SET ШрифтЦветТрафик.Label = ЦветТрафик;
SET ШрифтЦветКонверсия =  rgb(80,80,80);
SET ШрифтЦветКонверсия.Label = ЦветКонверсия;
SET ШрифтЦветКолСделок =  rgb(255,255,255);
SET ШрифтЦветКолСделок.Label = ЦветСделок;
SET ШрифтЦветСуммаОплаты =  rgb(255,255,255);
SET ШрифтЦветСуммаОплаты.Label = ЦветСуммаОплаты;
SET ШрифтЦветПенетрация =  rgb(80,80,80);
SET ШрифтЦветПенетрация.Label = ЦветПенетрация;
SET ШрифтЦветСрЧек =  rgb(80,80,80);
SET ШрифтЦветСрЧек.Label = ЦветСрЧек;
SET ШрифтЦветСуммаСкидки =  rgb(80,80,80);
SET ШрифтЦветСуммаСкидки.Label = ЦветСуммаСкидки;
SET ШрифтЦветПроцентСкидки =  rgb(80,80,80);
SET ШрифтЦветПроцентСкидки.Label = ЦветПроцентСкидки;
SET ШрифтЦветНаценка =  rgb(80,80,80);
SET ШрифтЦветНаценка.Label = ЦветНаценка;
SET ШрифтЦветОборачиваемость =  rgb(80,80,80);
SET ШрифтЦветОборачиваемость.Label = ЦветОборачиваемость;
SET ШрифтЦветПрцНаценка =  rgb(80,80,80);
SET ШрифтЦветПрцНаценка.Label = ЦветПрцНаценка;
SET ШрифтЦветOutOfStock =  rgb(255,255,255);
SET ШрифтЦветOutOfStock.Label = ШрифтЦветOutOfStock;
SET ШрифтЦветПредГод =  rgb(80,80,80);
SET ШрифтЦветПредГод.Label = ЦветПредГод;
SET ШрифтЦветПредПредГод =  rgb(80,80,80);
SET ШрифтЦветПредПредГод.Label = ЦветПредПредГод;
SET ТОППодгрупп = 20;
SET ТОППодгрупп.Label = Топ подгрупп;
SET ПродажаПроверкаФакт = Money(Sum({$<ТипДокумента = {VERIFY},ТипПериода={'Current'}>}Сумма),'# ##0,00');
SET ПродажаПроверкаФакт.Label = Проверка продажи ИТОГО;
SET ПродажаПроверкаФакт.Comment = Проверка - суммы продажи из Excel;
let ПродажаПроверкаРасхождение = replace(replace('Money(@(СуммаПродажи) - @(ПродажаПроверкаФакт),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажаПроверкаРасхождение.Label = Проверка продажи расхождение;
SET ПродажаПроверкаРасхождение.Comment = Расхождение с Excel по сумме продаж;
SET ВППроверкаФакт = Money(Sum({$<ТипДокумента = {VERIFY},ТипПериода={'Current'}>}ВП),'# ##0,00');
SET ВППроверкаФакт.Label = Проверка ВП ИТОГО;
SET ВППроверкаФакт.Comment = Проверка - суммы ВП из Excel;
let ВППроверкаРасхождение = replace(replace('Money(@(СуммаВП) - @(ВППроверкаФакт),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ВППроверкаРасхождение.Label = Проверка ВП расхождение;
SET ВППроверкаРасхождение.Comment = Расхождение с Excel по ВП;
SET Динамика = 0;
SET periodSetMode = 0;
LET periodStart = MakeDate(2014);
LET periodEnd = MakeDate(2014);
LET Детально = 0;
LET ВыборСортировка = -1;
LET ВыборТипаГрадиента = 1;
let КоличествоСКУОстаток = replace(replace('Count({<ТипДокумента={~~~OnHandEoM~~~}, _МесяцПоПорядку={~~~@(=Max({<_ФлагДействующаяДата={1}>} _МесяцПоПорядку))~~~}, Количество ={~~~>0~~~},ТипПериода={~~~Current~~~}>} DISTINCT НоменклатураКод)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоСКУОстаток.Label = Кол SKU на остатке;
SET КоличествоСКУОстаток.Comment = Количество SKU на остатке;
SET КоличествоСКУПродано = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1},ТипПериода={'Current'}>} DISTINCT НоменклатураКод),'# ##0,00');
SET КоличествоСКУПродано.Label = Кол SKU продано;
SET КоличествоСКУПродано.Comment = Количество проданных SKU;
SET КоличествоСКУПроданоПредМес = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяц'}>}DISTINCT НоменклатураКод),'# ##0,00');
SET КоличествоСКУПроданоПредМес.Label = Кол SKU продано пред мес;
SET КоличествоСКУПроданоПредМес.Comment = Количество продано SKU за предыдущий мес;
let ПроцентКоличествоСКУПроданоПредМес = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоСКУПроданоПредМес.Label = % Кол SKU продано к пред мес;
SET ПроцентКоличествоСКУПроданоПредМес.Comment = Процент Количество проданных SKU к предыдущему месяцу;
let СуммаРостаКоличествоСКУПроданоПредМес = replace(replace('Money(@(КоличествоСКУПродано)-@(КоличествоСКУПроданоПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоСКУПроданоПредМес.Label = ∆ изм. Кол SKU продано к пред мес;
SET СуммаРостаКоличествоСКУПроданоПредМес.Comment = Сумма роста Количество продано SKU к предыдущему месяцу;
SET КоличествоСКУПроданоПредГод = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год'}>}DISTINCT НоменклатураКод),'# ##0');
SET КоличествоСКУПроданоПредГод.Label = Кол SKU продано пред. (1) Год, шт;
SET КоличествоСКУПроданоПредГод.Comment = Количество продано SKU за предыдущий год, шт;
let ПроцентКоличествоСКУПроданоПредГод = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоСКУПроданоПредГод.Label = % Кол SKU продано к пред. (1) Год;
SET ПроцентКоличествоСКУПроданоПредГод.Comment = Процент Количество проданных SKU к предыдущему году;
let СуммаРостаКоличествоСКУПроданоПредГод = replace(replace('Money(@(КоличествоСКУПродано)-@(КоличествоСКУПроданоПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоСКУПроданоПредГод.Label = ∆ изм. Кол SKU продано к пред. (1) Год, шт;
SET СуммаРостаКоличествоСКУПроданоПредГод.Comment = Сумма роста Количество продано SKU к предыдущему году, шт;
SET КоличествоСКУПроданоПредГод2 = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год-2'}>}DISTINCT НоменклатураКод),'# ##0,00');
SET КоличествоСКУПроданоПредГод2.Label = Кол SKU продано пред. (2) Год, шт;
SET КоличествоСКУПроданоПредГод2.Comment = Количество продано SKU за предпредыдущий год, шт;
let ПроцентКоличествоСКУПроданоПредГод2 = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоСКУПроданоПредГод2.Label = % Кол SKU продано к пред. (2) Год;
SET ПроцентКоличествоСКУПроданоПредГод2.Comment = Процент Количество проданных SKU к предпредыдущему году;
let СуммаРостаКоличествоСКУПроданоПредГод2 = replace(replace('Money(@(КоличествоСКУПродано)-@(КоличествоСКУПроданоПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоСКУПроданоПредГод2.Label = ∆ изм. Кол SKU продано к пред. (2) Год, шт;
SET СуммаРостаКоличествоСКУПроданоПредГод2.Comment = Сумма роста Количество продано SKU к предпредыдущему году, шт;
SET КоличествоСКУПроданоПредГодДеньНедели = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'ГодДеньНедели'}>}DISTINCT НоменклатураКод),'# ##0,00');
SET КоличествоСКУПроданоПредГодДеньНедели.Label = Кол SKU продано пред. (1) Год тот же день недели, шт;
SET КоличествоСКУПроданоПредГодДеньНедели.Comment = Количество продано SKU за предыдущий год, шт;
let ПроцентКоличествоСКУПроданоПредГодДеньНедели = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоСКУПроданоПредГодДеньНедели.Label = % Кол SKU продано к пред. (1) Год тот же день недели;
SET ПроцентКоличествоСКУПроданоПредГодДеньНедели.Comment = Процент Количество проданных SKU к предыдущему году тот же день недели;
let СуммаРостаКоличествоСКУПроданоПредГодДеньНедели = replace(replace('Money(@(КоличествоСКУПродано)-@(КоличествоСКУПроданоПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоСКУПроданоПредГодДеньНедели.Label = ∆ изм. Кол SKU продано к пред. (1) Год тот же день недели, шт;
SET СуммаРостаКоличествоСКУПроданоПредГодДеньНедели.Comment = Сумма роста Количество продано SKU к предыдущему году тот же день недели, шт;
SET КоличествоСКУПроданоПредГод2ДеньНедели = Money(Count({<ТипДокумента = {'Sales'},_ФлагДействующаяДата={1}, ТипПериода={'Год2ДеньНедели'}>}DISTINCT НоменклатураКод),'# ##0,00');
SET КоличествоСКУПроданоПредГод2ДеньНедели.Label = Кол SKU продано пред. (2) Год тот же день недели, шт;
SET КоличествоСКУПроданоПредГод2ДеньНедели.Comment = Количество продано SKU за предпредыдущий год тот же день недели, шт;
let ПроцентКоличествоСКУПроданоПредГод2ДеньНедели = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоСКУПроданоПредГод2ДеньНедели.Label = % Кол SKU продано к пред. (2) Год тот же день недели;
SET ПроцентКоличествоСКУПроданоПредГод2ДеньНедели.Comment = Процент Количество проданных SKU к предпредыдущему году тот же день недели;
let СуммаРостаКоличествоСКУПроданоПредГод2ДеньНедели = replace(replace('Money(@(КоличествоСКУПродано)-@(КоличествоСКУПроданоПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоСКУПроданоПредГод2ДеньНедели.Label = ∆ изм. Кол SKU продано к пред. (2) Год тот же день недели, шт;
SET СуммаРостаКоличествоСКУПроданоПредГод2ДеньНедели.Comment = Сумма роста Количество продано SKU к предпредыдущему году тот же день недели, шт;
SET КоличествоСКУПроданоПлан = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'SalePlan'},ТипПериода={'Current'}>} Количество),'# ##0,00');
SET КоличествоСКУПроданоПлан.Label = Кол SKU продано план;
SET КоличествоСКУПроданоПлан.Comment = Количество проданных SKU план;
let КоличествоСКУПроданоПФ = replace(replace('Money(@(КоличествоСКУПродано)/@(КоличествоСКУПроданоПлан),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоСКУПроданоПФ.Label = ПФ кол SKU продано;
SET КоличествоСКУПроданоПФ.Comment = Количество проданных SKU факт к плану;
let КоличествоСКУПродано_П_Ф = replace(replace('Money(@(КоличествоСКУПродано) - @(КоличествоСКУПроданоПлан),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоСКУПродано_П_Ф.Label = ∆ П-Ф SKU продано;
SET КоличествоСКУПродано_П_Ф.Comment = Количество проданных SKU факт минус план;
let КоличествоСКУМатричныхОстаток = replace(replace('Count({<ТипДокумента={~~~OnHandEoM~~~},МатричныйТовар={~~~Матричный~~~}, _МесяцПоПорядку={~~~@(=Max({<_ФлагДействующаяДата={1}>} _МесяцПоПорядку))~~~}, Количество ={~~~>0~~~},ТипПериода={~~~Current~~~}>} DISTINCT НоменклатураКод)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоличествоСКУМатричныхОстаток.Label = Кол матричных SKU на остатке;
SET КоличествоСКУМатричныхОстаток.Comment = Количество матричных SKU на остатке;
SET КоличествоСКУМатричных = Count({<Год,Месяц,Дата,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ГодМесяц,МатричныйТовар={'Матричный'}>} DISTINCT НоменклатураКод);
SET КоличествоСКУМатричных.Label = Кол матричных SKU план;
SET КоличествоСКУМатричных.Comment = Количество матричных SKU план;
SET МатричностьНаСейчас = Max({<Год,Месяц,Дата,ГодМесяц,Квартал,Полугодие,День,ДеньНедели,ГодМесяц>}МатричныйТовар);
SET МатричностьНаСейчас.Label = Матричность;
SET МатричностьНаСейчас.Comment = Признак матричности на текущий день;
SET ДатаВыводаИзАссортимента = min(ДатаВывода);
SET ДатаВыводаИзАссортимента.Label = Дата вывода из ассортимента;
SET ДатаВыводаИзАссортимента.Comment = Дата вывода из ассортимента;
SET ДатаВводаВАссортимент = min(ДатаВвода);
SET ДатаВводаВАссортимент.Label = Дата ввода в ассортимент;
SET ДатаВводаВАссортимент.Comment = Дата первого ввода в ассортимент;
SET ПослДатаПоследнейПереоценки = min(ДатаПоследнейПереоценки);
SET ПослДатаПоследнейПереоценки.Label = Дата последней переоценки;
SET ПослДатаПоследнейПереоценки.Comment = Дата последней переоценки;
SET ПослЦенаТекущаяРозничная = Money(min(ЦенаТекущаяРозничная),'# ##0,00');
SET ПослЦенаТекущаяРозничная.Label = Розничная цена (на полке), руб;
SET ПослЦенаТекущаяРозничная.Comment = Действующая розничная цена на полке, руб;
SET ПослДатаПоследнейЗакупки = Money(min(ДатаПоследнейЗакупки),'# ##0,00');
SET ПослДатаПоследнейЗакупки.Label = Дата последней закупки;
SET ПослДатаПоследнейЗакупки.Comment = Дата последней закупки;
let GMROI = replace(replace('Money((@(СуммаВП)/Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~Current~~~}>} Себестоимость))*365,~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET GMROI.Label = GMROI;
SET GMROI.Comment = Факт GMROI % доходности на вложенный капитал в % годовых. (Ввловая прибыль отнесенная к остаткам в закупочных ценах);
let Эффективность = replace(replace('Money(((@(СуммаВП))/(Sum({<ТипДокумента = {~~~OnHandSum~~~},ТипПериода={~~~Current~~~}>} Себестоимость) / @(КоличествоДней)))*1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET Эффективность.Label = Доход, руб на 1000 руб остатков.;
SET Эффективность.Comment = Эффективность остатков, руб. ( Сколько рублей мы зарабатываем на 1000 рублей остатков);
let СредняяЦенаПродажи = replace(replace('Money(Avg({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>}Сумма/Количество),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СредняяЦенаПродажи.Label = Розничная цена средняя (факт), руб;
SET СредняяЦенаПродажи.Comment = Средняя фактическая розничная цена за выбранный период, руб;
let СредневзвешаннаяЦенаПродажи = replace(replace('Money(Sum({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>}Сумма)/ Sum({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>} Количество),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СредневзвешаннаяЦенаПродажи.Label = Средневзвешенная цена за период, руб;
SET СредневзвешаннаяЦенаПродажи.Comment = Средневзвешенная розничная цена за выбранный период, руб;
let СредняяСебестоимостьПродажи = replace(replace('Money(Avg({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>}Себестоимость/Количество),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СредняяСебестоимостьПродажи.Label = Средняя себестоимость штуки за период, руб;
SET СредняяСебестоимостьПродажи.Comment = Средняя себестоимость штуки за выбранный период, руб;
let СредневзвешаннаяСебестоимостьПродажи = replace(replace('Money(Sum({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>}Себестоимость)/ Sum({$<ТипДокумента = {~~~Sales~~~},_ФлагДействующаяДата={1},ТипПериода={~~~Current~~~} @(=if($0<>2,~~~~~~,~~~,$1={$2}~~~))>} Количество),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СредневзвешаннаяСебестоимостьПродажи.Label = Средневзвешенная себестоимость за период, руб;
SET СредневзвешаннаяСебестоимостьПродажи.Comment = Средневзвешенная себестоимость за выбранный период, руб;
SET СредневзвешаннаяЦенаЗакупки = Money(Sum(TOTAL<КодСкладНоменклатура> Aggr(Sum({$<ТипДокумента = {'Purch'},_ФлагДействующаяДата={1}, ТипПериода={'Current'}>}Себестоимость)/ Sum({$<ТипДокумента = {'Purch'},_ФлагДействующаяДата={1}, ТипПериода={'Current'}>} Количество),НоменклатураСсылка)),'# ##0,00');
SET СредневзвешаннаяЦенаЗакупки.Label = Средневзвешенная цена закупки за период, руб;
SET СредневзвешаннаяЦенаЗакупки.Comment = Средневзвешенная цена закупки за выбранный период, руб;
let ПродажиСредняяРазоваяПокупкаРуб = replace(replace('Money(Sum({<ТипДокумента = {~~~Sales~~~},ТипПериода={~~~Current~~~}>}Сумма)/@(КоличествоЧеков),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПродажиСредняяРазоваяПокупкаРуб.Label = Средняя разовая покупка, руб;
SET ПродажиСредняяРазоваяПокупкаРуб.Comment = Средняя разовая покупка, руб;
let СреднееКоличествоТовараСделки = replace(replace('Money(Sum({<ТипДокумента = {~~~Sales~~~},ТипПериода={~~~Current~~~}>}Количество)/@(КоличествоЧеков),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднееКоличествоТовараСделки.Label = Средняя разовая покупка, шт;
SET СреднееКоличествоТовараСделки.Comment = Средняя разовая покупка, шт;
let ПотенциальнаяНаценка = replace(replace('Money((@(ОстатокВЦенахПродажНаКонецПериодаРуб) - @(ОстатокСебестоимостьНаКонецПериода_Формула)) / @(ОстатокСебестоимостьНаКонецПериода_Формула),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПотенциальнаяНаценка.Label = Потенциальная Маржа, в %;
SET ПотенциальнаяНаценка.Comment = Потенциальная Маржа исходя из  остатков на конец периода с НДС и текущих цен продаж;
let ОстатокВЦенахПродажНаКонецПериодаРуб = replace(replace('Money(Sum(Aggr(@(ОстатокШтукНаКонецПериода_Формула) * Min(ЦенаТекущаяРозничная), НоменклатураСсылка, СкладСсылка)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокВЦенахПродажНаКонецПериодаРуб.Label = Остатки в дейст. розничных ценах, руб;
SET ОстатокВЦенахПродажНаКонецПериодаРуб.Comment = Складские остатки в действующих розничных ценах продажи на конец периода, в рублях;
let ОстатокВЦенахПродажНаКонецПериодаТысРуб = replace(replace('Money(Sum(Aggr(@(ОстатокШтукНаКонецПериода_Формула) * Min(ЦенаТекущаяРозничная), НоменклатураСсылка, СкладСсылка))/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокВЦенахПродажНаКонецПериодаТысРуб.Label = Остатки в дейст. розничных ценах, тыс.руб.;
SET ОстатокВЦенахПродажНаКонецПериодаТысРуб.Comment = Складские остатки в действующих розничных ценах продажи на конец периода, в тыс.руб.;
let ОстатокВЦенахПоследнейЗакупкиНаКонецПериодаРуб = replace(replace('Money(Sum(Aggr(@(ОстатокШтукНаКонецПериода_Формула) * Min(ЦенаПоследнейЗакупки), НоменклатураСсылка, СкладСсылка)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстатокВЦенахПоследнейЗакупкиНаКонецПериодаРуб.Label = Остатки в посл закуп. Ценах, руб;
SET ОстатокВЦенахПоследнейЗакупкиНаКонецПериодаРуб.Comment = Складские остатки в последних закупочных ценах на конец периода, руб;
SET СуммаЗакупки = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Current'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупки.Label = Сумма закупки руб.;
SET СуммаЗакупки.Comment = Сумма закупки в руб.;
SET СуммаЗакупкиТыс = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Current'}>}СебестоимостьБезТранспортных)/1000,'# ##0,00');
SET СуммаЗакупкиТыс.Label = Сумма закупки тыс.руб.;
SET СуммаЗакупкиТыс.Comment = Сумма закупки в тыс.руб.;
SET СуммаЗакупкиПредГод = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупкиПредГод.Label = Сумма закуплено пред. (1) Год, шт;
SET СуммаЗакупкиПредГод.Comment = Сумма закуплено за предыдущий год, штук;
let ПроцентСуммаЗакупкиПредГод = replace(replace('Money(@(СуммаЗакупкиТыс)/@(СуммаЗакупкиПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаЗакупкиПредГод.Label = % Суммы закуплено к пред. (1) Год;
SET ПроцентСуммаЗакупкиПредГод.Comment = Процент суммы закуплено к предыдущему году;
let СуммаРостаСуммаЗакупкиПредГод = replace(replace('Money(@(СуммаЗакупкиТыс)-@(СуммаЗакупкиПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаЗакупкиПредГод.Label = Рост суммы закуплено к пред. (1) Год, шт;
SET СуммаРостаСуммаЗакупкиПредГод.Comment = Рост суммы закуплено к предыдущему году, штук;
SET СуммаЗакупкиПредМесяц = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'ГодМесяц'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупкиПредМесяц.Label = Сумма закуплено пред месяц, шт;
SET СуммаЗакупкиПредМесяц.Comment = Сумма закуплено за предыдущий месяц, штук;
let ПроцентСуммаЗакупкиПредМесяц = replace(replace('Money(@(СуммаЗакупкиТыс)/@(СуммаЗакупкиПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаЗакупкиПредМесяц.Label = % суммы закуплено к пред месяцу;
SET ПроцентСуммаЗакупкиПредМесяц.Comment = Процент суммы закуплено к предыдущему месяцу;
let СуммаРостаСуммаЗакупкиПредМесяц = replace(replace('Money(@(СуммаЗакупкиТыс)-@(СуммаЗакупкиПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаЗакупкиПредМесяц.Label = Рост суммы закуплено к пред месяцу, шт;
SET СуммаРостаСуммаЗакупкиПредМесяц.Comment = Рост суммы закуплено к предыдущему месяцу, штук;
SET СуммаЗакупкиПредГод2 = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год-2'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупкиПредГод2.Label = Сумма закуплено пред. (2) Год, шт;
SET СуммаЗакупкиПредГод2.Comment = Сумма закуплено за предпредыдущий год, штук;
let ПроцентСуммаЗакупкиПредГод2 = replace(replace('Money(@(СуммаЗакупкиТыс)/@(СуммаЗакупкиПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаЗакупкиПредГод2.Label = % суммы закуплено к пред. (2) Год;
SET ПроцентСуммаЗакупкиПредГод2.Comment = Процент суммы закуплено к предпредыдущий году;
let СуммаРостаСуммаЗакупкиПредГод2 = replace(replace('Money(@(СуммаЗакупкиТыс)-@(СуммаЗакупкиПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаЗакупкиПредГод2.Label = Рост суммы закуплено к пред. (2) Год, шт;
SET СуммаРостаСуммаЗакупкиПредГод2.Comment = Рост суммы закуплено к предпредыдущий году, штук;
SET СуммаЗакупкиПредГодДеньНедели = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'ГодДеньНедели'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупкиПредГодДеньНедели.Label = Сумма закуплено пред. (1) Год тот же день недели, шт;
SET СуммаЗакупкиПредГодДеньНедели.Comment = Сумма закуплено за предыдущий год тот же день недели, штук;
let ПроцентСуммаЗакупкиПредГодДеньНедели = replace(replace('Money(@(СуммаЗакупкиТыс)/@(СуммаЗакупкиПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаЗакупкиПредГодДеньНедели.Label = % суммы закуплено к пред. (1) Год тот же день недели;
SET ПроцентСуммаЗакупкиПредГодДеньНедели.Comment = Процент суммы закуплено к предыдущему году тот же день недели;
let СуммаРостаСуммаЗакупкиПредГодДеньНедели = replace(replace('Money(@(СуммаЗакупкиТыс)-@(СуммаЗакупкиПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаЗакупкиПредГодДеньНедели.Label = Рост суммы закуплено к пред. (1) Год тот же день недели, шт;
SET СуммаРостаСуммаЗакупкиПредГодДеньНедели.Comment = Рост суммы закуплено к предыдущему году, штук;
SET СуммаЗакупкиПредГод2ДеньНедели = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год2ДеньНедели'}>}СебестоимостьБезТранспортных),'# ##0,00');
SET СуммаЗакупкиПредГод2ДеньНедели.Label = Сумма закуплено пред. (2) Год тот же день недели, шт;
SET СуммаЗакупкиПредГод2ДеньНедели.Comment = Сумма закуплено за предпредыдущий год тот же день недели, штук;
let ПроцентСуммаЗакупкиПредГод2ДеньНедели = replace(replace('Money(@(СуммаЗакупкиТыс)/@(СуммаЗакупкиПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммаЗакупкиПредГод2ДеньНедели.Label = % суммы закуплено к пред. (2) Год тот же день недели;
SET ПроцентСуммаЗакупкиПредГод2ДеньНедели.Comment = Процент суммы закуплено к предпредыдущий году тот же день недели;
let СуммаРостаСуммаЗакупкиПредГод2ДеньНедели = replace(replace('Money(@(СуммаЗакупкиТыс)-@(СуммаЗакупкиПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммаЗакупкиПредГод2ДеньНедели.Label = Рост суммы закуплено к пред. (2) Год тот же день недели, шт;
SET СуммаРостаСуммаЗакупкиПредГод2ДеньНедели.Comment = Рост суммы закуплено к предпредыдущий году тот же день недели, штук;
SET КоличествоЗакупки = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Current'}>}Количество),'# ##0,00');
SET КоличествоЗакупки.Label = Количество закуплено, шт;
SET КоличествоЗакупки.Comment = Количество закуплено, шт;
SET КоличествоЗакупкиПредГод = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год'}>}Количество),'# ##0,00');
SET КоличествоЗакупкиПредГод.Label = Количество закуплено пред. (1) Год, шт;
SET КоличествоЗакупкиПредГод.Comment = Количество закуплено за предыдущий год, штук;
let ПроцентКоличествоЗакупкиПредГод = replace(replace('Money(@(КоличествоЗакупки)/@(КоличествоЗакупкиПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЗакупкиПредГод.Label = % количества закуплено к пред. (1) Год;
SET ПроцентКоличествоЗакупкиПредГод.Comment = Процент количества закуплено к предыдущему году;
let СуммаРостаКоличествоЗакупкиПредГод = replace(replace('Money(@(КоличествоЗакупки)-@(КоличествоЗакупкиПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЗакупкиПредГод.Label = Рост количества закуплено к пред. (1) Год, шт;
SET СуммаРостаКоличествоЗакупкиПредГод.Comment = Рост количества закуплено к предыдущему году, штук;
SET КоличествоЗакупкиПредМесяц = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'ГодМесяц'}>}Количество),'# ##0,00');
SET КоличествоЗакупкиПредМесяц.Label = Количество закуплено пред месяц, шт;
SET КоличествоЗакупкиПредМесяц.Comment = Количество закуплено за предыдущий месяц, штук;
let ПроцентКоличествоЗакупкиПредМесяц = replace(replace('Money(@(КоличествоЗакупки)/@(КоличествоЗакупкиПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЗакупкиПредМесяц.Label = % количества закуплено к пред месяцу;
SET ПроцентКоличествоЗакупкиПредМесяц.Comment = Процент количества закуплено к предыдущему месяцу;
let СуммаРостаКоличествоЗакупкиПредМесяц = replace(replace('Money(@(КоличествоЗакупки)-@(КоличествоЗакупкиПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЗакупкиПредМесяц.Label = Рост количества закуплено к пред месяцу, шт;
SET СуммаРостаКоличествоЗакупкиПредМесяц.Comment = Рост количества закуплено к предыдущему месяцу, штук;
SET КоличествоЗакупкиПредГод2 = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год-2'}>}Количество),'# ##0,00');
SET КоличествоЗакупкиПредГод2.Label = Количество закуплено пред. (2) Год, шт;
SET КоличествоЗакупкиПредГод2.Comment = Количество закуплено за предпредыдущий год, штук;
let ПроцентКоличествоЗакупкиПредГод2 = replace(replace('Money(@(КоличествоЗакупки)/@(КоличествоЗакупкиПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЗакупкиПредГод2.Label = % количества закуплено к пред. (2) Год;
SET ПроцентКоличествоЗакупкиПредГод2.Comment = Процент количества закуплено к предпредыдущий году;
let СуммаРостаКоличествоЗакупкиПредГод2 = replace(replace('Money(@(КоличествоЗакупки)-@(КоличествоЗакупкиПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЗакупкиПредГод2.Label = Рост количества закуплено к пред. (2) Год, шт;
SET СуммаРостаКоличествоЗакупкиПредГод2.Comment = Рост количества закуплено к предпредыдущий году, штук;
SET КоличествоЗакупкиПредГодДеньНедели = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'ГодДеньНедели'}>}Количество),'# ##0,00');
SET КоличествоЗакупкиПредГодДеньНедели.Label = Количество закуплено пред. (1) Год тот же день недели, шт;
SET КоличествоЗакупкиПредГодДеньНедели.Comment = Количество закуплено за предыдущий год тот же день недели, штук;
let ПроцентКоличествоЗакупкиПредГодДеньНедели = replace(replace('Money(@(КоличествоЗакупки)/@(КоличествоЗакупкиПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЗакупкиПредГодДеньНедели.Label = % количества закуплено к пред. (1) Год тот же день недели;
SET ПроцентКоличествоЗакупкиПредГодДеньНедели.Comment = Процент количества закуплено к предыдущему году тот же день недели;
let СуммаРостаКоличествоЗакупкиПредГодДеньНедели = replace(replace('Money(@(КоличествоЗакупки)-@(КоличествоЗакупкиПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЗакупкиПредГодДеньНедели.Label = Рост количества закуплено к пред. (1) Год тот же день недели, шт;
SET СуммаРостаКоличествоЗакупкиПредГодДеньНедели.Comment = Рост количества закуплено к предыдущему году, штук;
SET КоличествоЗакупкиПредГод2ДеньНедели = Money(Sum({<ТипДокумента={'Purch'}, ТипПериода={'Год2ДеньНедели'}>}Количество),'# ##0,00');
SET КоличествоЗакупкиПредГод2ДеньНедели.Label = Количество закуплено пред. (2) Год тот же день недели, шт;
SET КоличествоЗакупкиПредГод2ДеньНедели.Comment = Количество закуплено за предпредыдущий год тот же день недели, штук;
let ПроцентКоличествоЗакупкиПредГод2ДеньНедели = replace(replace('Money(@(КоличествоЗакупки)/@(КоличествоЗакупкиПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЗакупкиПредГод2ДеньНедели.Label = % количества закуплено к пред. (2) Год тот же день недели;
SET ПроцентКоличествоЗакупкиПредГод2ДеньНедели.Comment = Процент количества закуплено к предпредыдущий году тот же день недели;
let СуммаРостаКоличествоЗакупкиПредГод2ДеньНедели = replace(replace('Money(@(КоличествоЗакупки)-@(КоличествоЗакупкиПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЗакупкиПредГод2ДеньНедели.Label = Рост количества закуплено к пред. (2) Год тот же день недели, шт;
SET СуммаРостаКоличествоЗакупкиПредГод2ДеньНедели.Comment = Рост количества закуплено к предпредыдущий году тот же день недели, штук;
SET КоличествоЧеков = Money(Sum({<ТипПериода={'Current'}>} _СчетчикЧеков),'# ##0');
SET КоличествоЧеков.Label = Количество чеков, шт;
SET КоличествоЧеков.Comment = Количество чеков, штук;
SET КоличествоЧековТыс = Money(Sum({<ТипПериода={'Current'}>} _СчетчикЧеков ) / 1000,'# ##0');
SET КоличествоЧековТыс.Label = Количество чеков, тыс;
SET КоличествоЧековТыс.Comment = Количество чеков, в тысячах штук;
SET КоличествоЧековПредГод = Money(Sum({<ТипПериода={'Год'}>} _СчетчикЧеков),'# ##0');
SET КоличествоЧековПредГод.Label = Количество чеков пред. (1) Год, шт;
SET КоличествоЧековПредГод.Comment = Количество чеков за предыдущий год, штук;
let ПроцентКоличествоЧековПредГод = replace(replace('Money(@(КоличествоЧеков)/@(КоличествоЧековПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЧековПредГод.Label = % количества чеков к пред. (1) Год;
SET ПроцентКоличествоЧековПредГод.Comment = Процент количества чеков к предыдущему году;
let СуммаРостаКоличествоЧековПредГод = replace(replace('Money(@(КоличествоЧеков)-@(КоличествоЧековПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЧековПредГод.Label = Рост количества чеков к пред. (1) Год, шт;
SET СуммаРостаКоличествоЧековПредГод.Comment = Рост количества чеков к предыдущему году, штук;
SET КоличествоЧековПредМесяц = Money(Sum({<ТипПериода={'ГодМесяц'}>} _СчетчикЧеков),'# ##0');
SET КоличествоЧековПредМесяц.Label = Количество чеков пред месяц, шт;
SET КоличествоЧековПредМесяц.Comment = Количество чеков за предыдущий месяц, штук;
let ПроцентКоличествоЧековПредМесяц = replace(replace('Money(@(КоличествоЧеков)/@(КоличествоЧековПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЧековПредМесяц.Label = % количества чеков к пред месяцу;
SET ПроцентКоличествоЧековПредМесяц.Comment = Процент количества чеков к предыдущему месяцу;
let СуммаРостаКоличествоЧековПредМесяц = replace(replace('Money(@(КоличествоЧеков)-@(КоличествоЧековПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЧековПредМесяц.Label = Рост количества чеков к пред месяцу, шт;
SET СуммаРостаКоличествоЧековПредМесяц.Comment = Рост количества чеков к предыдущему месяцу, штук;
SET КоличествоЧековПредГод2 = Money(Sum({<ТипПериода={'Год-2'}>} _СчетчикЧеков),'# ##0');
SET КоличествоЧековПредГод2.Label = Количество чеков пред. (2) Год, шт;
SET КоличествоЧековПредГод2.Comment = Количество чеков за предпредыдущий год, штук;
let ПроцентКоличествоЧековПредГод2 = replace(replace('Money(@(КоличествоЧеков)/@(КоличествоЧековПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЧековПредГод2.Label = % количества чеков к пред. (2) Год;
SET ПроцентКоличествоЧековПредГод2.Comment = Процент количества чеков к предпредыдущий году;
let СуммаРостаКоличествоЧековПредГод2 = replace(replace('Money(@(КоличествоЧеков)-@(КоличествоЧековПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЧековПредГод2.Label = Рост количества чеков к пред. (2) Год, шт;
SET СуммаРостаКоличествоЧековПредГод2.Comment = Рост количества чеков к предпредыдущий году, штук;
SET КоличествоЧековПредГодДеньНедели = Money(Sum({<ТипПериода={'Год-2'}>} _СчетчикЧеков),'# ##0') Money(Sum({<ТипДокумента = {#CheckCount},ТипПериода={'ГодДеньНедели'}>}Количество),'# ##0,00');
SET КоличествоЧековПредГодДеньНедели.Label = Количество чеков пред. (1) Год тот же день недели, шт;
SET КоличествоЧековПредГодДеньНедели.Comment = Количество чеков за предыдущий год тот же день недели, штук;
let ПроцентКоличествоЧековПредГодДеньНедели = replace(replace('Money(@(КоличествоЧеков)/@(КоличествоЧековПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЧековПредГодДеньНедели.Label = % количества чеков к пред. (1) Год тот же день недели;
SET ПроцентКоличествоЧековПредГодДеньНедели.Comment = Процент количества чеков к предыдущему году тот же день недели;
let СуммаРостаКоличествоЧековПредГодДеньНедели = replace(replace('Money(@(КоличествоЧеков)-@(КоличествоЧековПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЧековПредГодДеньНедели.Label = Рост количества чеков к пред. (1) Год тот же день недели, шт;
SET СуммаРостаКоличествоЧековПредГодДеньНедели.Comment = Рост количества чеков к предыдущему году, штук;
SET КоличествоЧековПредГод2ДеньНедели = Money(Sum({<ТипПериода={'Год2ДеньНедели'}>} _СчетчикЧеков),'# ##0');
SET КоличествоЧековПредГод2ДеньНедели.Label = Количество чеков пред. (2) Год тот же день недели, шт;
SET КоличествоЧековПредГод2ДеньНедели.Comment = Количество чеков за предпредыдущий год тот же день недели, штук;
let ПроцентКоличествоЧековПредГод2ДеньНедели = replace(replace('Money(@(КоличествоЧеков)/@(КоличествоЧековПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоличествоЧековПредГод2ДеньНедели.Label = % количества чеков к пред. (2) Год тот же день недели;
SET ПроцентКоличествоЧековПредГод2ДеньНедели.Comment = Процент количества чеков к предпредыдущий году тот же день недели;
let СуммаРостаКоличествоЧековПредГод2ДеньНедели = replace(replace('Money(@(КоличествоЧеков)-@(КоличествоЧековПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоличествоЧековПредГод2ДеньНедели.Label = Рост количества чеков к пред. (2) Год тот же день недели, шт;
SET СуммаРостаКоличествоЧековПредГод2ДеньНедели.Comment = Рост количества чеков к предпредыдущий году тот же день недели, штук;
SET СуммаПоЧекамТыс = Money(Sum({<ТипПериода={'Current'}>} _СуммаПоЧеку) / 1000,'# ##0');
SET СуммаПоЧекамТыс.Label = Сумма по чекам, т.р.;
SET СуммаПоЧекамТыс.Comment = Сумма по выбранным чекам в тыс. руб.;
SET НаценкаПоЧекамТыс = Money(Sum({<ТипПериода={'Current'}>} _НаценкаПоЧеку) / 1000,'# ##0');
SET НаценкаПоЧекамТыс.Label = ВП по чекам, т.р.;
SET НаценкаПоЧекамТыс.Comment = Валовая прибыль по выбранным чекам в тыс. руб.;
SET ПроцентНаценкиПоЧекам = Money(Sum({<ТипПериода={'Current'}>} _НаценкаПоЧеку) / Sum({<ТипПериода={'Current'}>} _СебестоимостьПоЧеку),'# ##0%');
SET ПроцентНаценкиПоЧекам.Label = %Наценки по чекам.;
SET ПроцентНаценкиПоЧекам.Comment = %Наценки по выбранным чекам в тыс. руб.;
SET СуммаПоЧекамПредГод = Money(Sum({<ТипПериода={'Год'}>} _СуммаПоЧеку),'# ##0');
SET СуммаПоЧекамПредГод.Label = Количество чеков пред. (1) Год, шт;
SET СуммаПоЧекамПредГод.Comment = Количество чеков за предыдущий год, штук;
let СреднийЧек = replace(replace('If(@(КоличествоЧеков) = 0,0,Money(@(СуммаПоЧекам)/@(КоличествоЧеков),~~~# ##0~~~))','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧек.Label = Средний чек, руб;
SET СреднийЧек.Comment = Средний чек, руб;
let СреднийЧекПредГод = replace(replace('Money(@(СуммаПоЧекамПредГод)/@(КоличествоЧековПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекПредГод.Label = Средний чек пред. (1) Год, руб;
SET СреднийЧекПредГод.Comment = Средний чек за предыдущий год, руб;
let ПроцентСреднийЧекПредГод = replace(replace('Money(@(СреднийЧек)/@(СреднийЧекПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСреднийЧекПредГод.Label = % среднего чека к пред. (1) Год;
SET ПроцентСреднийЧекПредГод.Comment = Процент роста среднего чеков к предыдущему году;
let СуммаРостаСреднийЧекПредГод = replace(replace('Money(@(СреднийЧек)-@(СреднийЧекПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСреднийЧекПредГод.Label = Рост среднего чека к пред. (1) Год, руб;
SET СуммаРостаСреднийЧекПредГод.Comment = Рост среднего чека к предыдущему году, руб;
let СреднийЧекПредМесяц = replace(replace('Money(@(ПродажиПредМесяцРуб)/@(КоличествоЧековПредМесяц),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекПредМесяц.Label = Средний чек пред месяц, руб;
SET СреднийЧекПредМесяц.Comment = Средний чек за предыдущий месяц, руб;
let ПроцентСреднийЧекПредМесяц = replace(replace('Money(@(СреднийЧек)/@(СреднийЧекПредМесяц)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСреднийЧекПредМесяц.Label = % среднего чека к пред месяцу;
SET ПроцентСреднийЧекПредМесяц.Comment = Процент среднего чека к предыдущему месяцу;
let СуммаРостаСреднийЧекПредМесяц = replace(replace('Money(@(СреднийЧек)-@(СреднийЧекПредМесяц)),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСреднийЧекПредМесяц.Label = Рост среднего чека к пред месяцу, руб;
SET СуммаРостаСреднийЧекПредМесяц.Comment = Рост среднего чека к предыдущему месяцу, руб;
let СреднийЧекПредГод2 = replace(replace('Money(@(ПродажиПредГод2Руб)/@(КоличествоЧековПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекПредГод2.Label = Средний чек пред. (2) Год, руб;
SET СреднийЧекПредГод2.Comment = Средний чек за предпредыдущий год, руб;
let ПроцентСреднийЧекПредГод2 = replace(replace('Money(@(СреднийЧек)/@(СреднийЧекПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСреднийЧекПредГод2.Label = % среднего чека к пред. (2) Год;
SET ПроцентСреднийЧекПредГод2.Comment = Процент роста среднего чеков к предпредыдущему году;
let СуммаРостаСреднийЧекПредГод2 = replace(replace('Money(@(СреднийЧек)-@(СреднийЧекПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСреднийЧекПредГод2.Label = Рост среднего чека к пред. (2) Год, руб;
SET СуммаРостаСреднийЧекПредГод2.Comment = Рост среднего чека к предпредыдущему году, руб;
let СреднийЧекПредГодДеньНедели = replace(replace('Money(@(ПродажиПредГодДеньНеделиРуб)/@(КоличествоЧековПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекПредГодДеньНедели.Label = Средний чек пред. (1) Год тот же день недели, руб;
SET СреднийЧекПредГодДеньНедели.Comment = Средний чек за предыдущий год тот же день недели, руб;
let ПроцентСреднийЧекПредГодДеньНедели = replace(replace('Money(@(СреднийЧек)/@(СреднийЧекПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСреднийЧекПредГодДеньНедели.Label = % среднего чека к пред. (1) Год тот же день недели;
SET ПроцентСреднийЧекПредГодДеньНедели.Comment = Процент роста среднего чеков к предыдущему году тот же день недели;
let СуммаРостаСреднийЧекПредГодДеньНедели = replace(replace('Money(@(СреднийЧек)-@(СреднийЧекПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСреднийЧекПредГодДеньНедели.Label = Рост среднего чека к пред. (1) Год тот же день недели, руб;
SET СуммаРостаСреднийЧекПредГодДеньНедели.Comment = Рост среднего чека к предыдущему году тот же день недели, руб;
let СреднийЧекПредГод2ДеньНедели = replace(replace('Money(@(ПродажиПредГод2ДеньНеделиРуб)/@(КоличествоЧековПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекПредГод2ДеньНедели.Label = Средний чек пред. (2) Год тот же день недели, руб;
SET СреднийЧекПредГод2ДеньНедели.Comment = Средний чек за предпредыдущий год тот же день недели, руб;
let ПроцентСреднийЧекПредГод2ДеньНедели = replace(replace('Money(@(СреднийЧек)/@(СреднийЧекПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСреднийЧекПредГод2ДеньНедели.Label = % среднего чека к пред. (2) Год тот же день недели;
SET ПроцентСреднийЧекПредГод2ДеньНедели.Comment = Процент роста среднего чеков к предпредыдущему году тот же день недели;
let СуммаРостаСреднийЧекПредГод2ДеньНедели = replace(replace('Money(@(СреднийЧек)-@(СреднийЧекПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСреднийЧекПредГод2ДеньНедели.Label = Рост среднего чека к пред. (2) Год тот же день недели, руб;
SET СуммаРостаСреднийЧекПредГод2ДеньНедели.Comment = Рост среднего чека к предпредыдущему году тот же день недели, руб;
let ДлинаЧека = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~}>} ДлинаЧека)/@(КоличествоЧеков),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧека.Label = Длина чека;
SET ДлинаЧека.Comment = Средняя длина чека (среднее количество строк в чеке);
let ДлинаЧекаПредГод = replace(replace('Money(Sum({<ТипПериода={~~~Год~~~}>} ДлинаЧека)/@(КоличествоЧековПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаПредГод.Label = Длина чека пред. (1) Год;
SET ДлинаЧекаПредГод.Comment = Средняя длина чека за предыдущий год (среднее количество строк в чеке);
SET СбросФильтраПоТрафику = Категория, Подкатегория, Группа, Подгруппа, Производитель, ТорговаяМарка, Коллекция, КатегорийныйМенеджер, Канал;
let Трафик = replace(replace('Money(Sum({<ТипДокумента = {~~~Traffic~~~},ТипПериода={~~~Current~~~},@(СбросФильтраПоТрафику)>} Количество)/1000,~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET Трафик.Label = Трафик, тыс. человек;
SET Трафик.Comment = Трафик, тыс. человек;
let Конверсия = replace(replace('Money((@(КоличествоЧеков))/(@(Трафик)*1000),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET Конверсия.Label = Конверсия %;
SET Конверсия.Comment = Конверсия % посетителей в покупателей;
SET Пенетрация = Money(Sum({<ТипПериода={'Current'}>} _СчетчикЧеков)/ Sum({<ТипПериода={'Current'}, Категория, Группа,НоменклатураКод,НоменклатураНаименование,Подкатегория,Производитель, КатегорийныйМенеджер>} Total <Склад> _СчетчикЧеков),'# ##0,00%');
SET Пенетрация.Label = % Пенетрации;
SET Пенетрация.Comment = % Пенетрации;
let %СвязанныхОтПродажОсновногоТовараПоПодразд = replace(replace(' @(СвязанныеПродажиКолВоSecond)/Sum({$} Total <Склад> _СчетчикЧеков)','~~~', chr(39)), '@(', chr(36) & '(');
SET %СвязанныхОтПродажОсновногоТовараПоПодразд.Label = %Сопутствующих продаж от продаж основного товара;
SET %СвязанныхОтПродажОсновногоТовараПоПодразд.Comment = Процент сопутствующих продаж к продажам по основному товару по городу;
SET СвязанныеПродажиКолВоSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка), ТипПериода={'Current'},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} _СчетчикЧеков ),'# ##0');
SET СвязанныеПродажиКолВоSecond.Label = Количество чеков по сопутствующим продажам, шт;
SET СвязанныеПродажиКолВоSecond.Comment = Количество чеков по сопутствующим продажам, штук;
SET СвязанныеПродажиSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиSecond.Label = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSecond.Comment = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSecondПредМес = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'ГодМесяц'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиSecondПредМес.Label = Сумма продаж по сопутствующим продажам пред мес, тыс. руб.;
SET СвязанныеПродажиSecondПредМес.Comment = Сумма продаж по сопутствующим продажам за предыдущий месяц, тыс. руб.;
let ПроцентСвязанныеПродажиПредМес = replace(replace('Money(@(СвязанныеПродажиSecond)/@(СвязанныеПродажиSecondПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСвязанныеПродажиПредМес.Label = % изм.Продаж к пред. месяцу;
SET ПроцентСвязанныеПродажиПредМес.Comment = Процент Продажи к предыдущему месяцу;
SET СвязаннаяМаржаSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ВП )/1000,'# ##0,00');
SET СвязаннаяМаржаSecond.Label = ВП по сопутствующим продажам, тыс. руб.;
SET СвязаннаяМаржаSecond.Comment = ВП по сопутствующим продажам, тыс. руб.;
let СвязанныйПроцентНаценкиSecond = replace(replace('Money(@(СвязаннаяМаржаSecond)/(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Себестоимость )/1000),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СвязанныйПроцентНаценкиSecond.Label = % Наценки по сопутствующим продажам;
SET СвязанныйПроцентНаценкиSecond.Comment = % Наценки по сопутствующим продажам;
SET СвязанныеПродажиКоличествоSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Количество ),'# ##0');
SET СвязанныеПродажиКоличествоSecond.Label = Количество товара по сопутствующим продажам, шт;
SET СвязанныеПродажиКоличествоSecond.Comment = Количество товара по сопутствующим продажам, штук;
SET СвязанныеПродажиСкидкаSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Скидка )/1000,'# ##0,00');
SET СвязанныеПродажиСкидкаSecond.Label = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаSecond.Comment = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СуммаПоЧеку )/1000,'# ##0');
SET СвязанныеСуммаПоЧекамТысSecond.Label = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысSecond.Comment = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/1000,'# ##0');
SET СвязанныеНаценкаПоЧекамТысSecond.Label = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысSecond.Comment = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеПроцентНаценкиПоЧекамSecond = Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СебестоимостьПоЧеку ),'# ##0%');
SET СвязанныеПроцентНаценкиПоЧекамSecond.Label = Сопутствующий % наценки по чекам;
SET СвязанныеПроцентНаценкиПоЧекамSecond.Comment = Сопутствующий % наценки по чекам;
SET СвязанныеПродажиSecondСУчетомОсновного = Money(sum( {Second<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=$::НоменклатураСсылка+Second::НоменклатураСсылка,ТипДокумента={'Sales'},ТипПериода={'Current'}, НоменклатураНаименование,Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиSecondСУчетомОсновного.Label = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSecondСУчетомОсновного.Comment = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеРозничнаяЦенаSecond = Money(Max( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма/Количество ),'# ##0,00');
SET СвязанныеРозничнаяЦенаSecond.Label = Розничная цена по сопутствующим продажам, руб.;
SET СвязанныеРозничнаяЦенаSecond.Comment = Розничная цена по сопутствующим продажам, руб.;
let ПроцентСкидкиSecond = replace(replace('Num(alt(@(СвязанныеПродажиСкидкаSecond)/(@(СвязанныеПродажиSecond)+@(СвязанныеПродажиСкидкаSecond)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиSecond.Label = Процент скидки по сопутствующим продажам;
SET ПроцентСкидкиSecond.Comment = Процент предоставленной скидки по сопутствующим продажам;
let %ВПСвязанныхОтПродажОсновногоТовараПоПодразд = replace(replace(' Money(@(СвязаннаяМаржаSecond)/Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}>} Total <Склад> ВП),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET %ВПСвязанныхОтПродажОсновногоТовараПоПодразд.Label = %Сопутствующих продаж от продаж основного товара;
SET %ВПСвязанныхОтПродажОсновногоТовараПоПодразд.Comment = Процент Сопутствующих продаж к продажам по основному товару по городу;
let %ПродажСвязанныхОтПродажОсновногоТовараПоПодразд = replace(replace(' Money(@(СвязанныеПродажиSecond)/(Sum({$<ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}>} Total <Склад> Сумма)/1000),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET %ПродажСвязанныхОтПродажОсновногоТовараПоПодразд.Label = %Сопутствующих продаж от продаж основного товара;
SET %ПродажСвязанныхОтПродажОсновногоТовараПоПодразд.Comment = Процент Сопутствующих продаж к продажам по основному товару по городу;
let ДлинаЧекаSecond = replace(replace('Money(sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипПериода={~~~Current~~~},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата, Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} ДлинаЧека)/@(СвязанныеПродажиКолВоSecond),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаSecond.Label = Длина чека;
SET ДлинаЧекаSecond.Comment = Средняя длина чека (среднее количество строк в чеке);
let СреднийЧекSecond = replace(replace('Money((@(СвязанныеПродажиSecond)*1000)/@(СвязанныеПродажиКолВоSecond),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекSecond.Label = Средний чек;
SET СреднийЧекSecond.Comment = Средний чек;
let %СвязанныхПродажSecond = replace(replace(' Money(@(СвязанныеПродажиSecond) / Sum({Second<[НоменклатураСсылка]=,НоменклатураНаименованиеУровня2=,Номенклатура=, НоменклатураСсылка=>} Сумма),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET %СвязанныхПродажSecond.Label = %Продаж по номенклатуре в целом;
SET %СвязанныхПродажSecond.Comment = Процент сопутствующих продаж к продажам по данной номенклатуре в целом;
let ПроцентСопутствующейПенетрации = replace(replace('Money(@(СвязанныеПродажиКолВоSecond)/ Sum({$<ТипПериода={~~~Current~~~}>} TOTAL _СчетчикЧеков),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСопутствующейПенетрации.Label = % Пенетрации по сопутствующим продажам;
SET ПроцентСопутствующейПенетрации.Comment = % Пенетрации по сопутствующим продажам;
let ДоляСвязанныхПродажSecond = replace(replace(' Money(@(СвязанныеПродажиSecond) / (sum( {Second<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка),ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Total Сумма )/1000),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДоляСвязанныхПродажSecond.Label = Доля в сопутствующих продаж, %;
SET ДоляСвязанныхПродажSecond.Comment = Доля в сопутствующих продаж, %;
SET СвязанныеПродажиThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиThird.Label = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиThird.Comment = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиКоличествоThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Количество ),'# ##0,00');
SET СвязанныеПродажиКоличествоThird.Label = Количество товара по сопутствующим продажам, шт;
SET СвязанныеПродажиКоличествоThird.Comment = Количество товара по сопутствующим продажам, шт;
SET СвязаннаяМаржаThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ВП )/1000,'# ##0,00');
SET СвязаннаяМаржаThird.Label = ВП по сопутствующим продажам, тыс. руб.;
SET СвязаннаяМаржаThird.Comment = ВП по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Скидка )/1000,'# ##0,00');
SET СвязанныеПродажиСкидкаThird.Label = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаThird.Comment = Сумма скидки по сопутствующим продажам, тыс. руб.;
let ПроцентСкидкиThird = replace(replace('Num(alt(@(СвязанныеПродажиСкидкаThird)/(@(СвязанныеПродажиThird)+@(СвязанныеПродажиСкидкаThird)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиThird.Label = Процент скидки по сопутствующим продажам;
SET ПроцентСкидкиThird.Comment = Процент предоставленной скидки по сопутствующим продажам;
SET СвязанныеПродажиКолВоThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка), ТипПериода={'Current'},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} _СчетчикЧеков ),'# ##0');
SET СвязанныеПродажиКолВоThird.Label = Количество чеков по сопутствующим продажам, шт;
SET СвязанныеПродажиКолВоThird.Comment = Количество чеков по сопутствующим продажам, штук;
let ПроцентСопутствующейПенетрацииThird = replace(replace('Money(@(СвязанныеПродажиКолВоThird)/ Sum({$<ТипПериода={~~~Current~~~}>} TOTAL _СчетчикЧеков),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСопутствующейПенетрацииThird.Label = % Пенетрации по сопутствующим продажам;
SET ПроцентСопутствующейПенетрацииThird.Comment = % Пенетрации по сопутствующим продажам;
let ДлинаЧекаThird = replace(replace('Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка), ТипПериода={~~~Current~~~},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} ДлинаЧека)/@(СвязанныеПродажиКолВоThird),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаThird.Label = Длина чека;
SET ДлинаЧекаThird.Comment = Средняя длина чека (среднее количество строк в чеке);
let СреднийЧекThird = replace(replace('Money((@(СвязанныеПродажиThird)*1000)/@(СвязанныеПродажиКолВоThird),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекThird.Label = Средний чек;
SET СреднийЧекThird.Comment = Средний чек;
let СвязанныйПроцентНаценкиThird = replace(replace('Money(@(СвязаннаяМаржаThird)/(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Себестоимость )/1000),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СвязанныйПроцентНаценкиThird.Label = % Наценки по сопутствующим продажам;
SET СвязанныйПроцентНаценкиThird.Comment = % Наценки по сопутствующим продажам;
SET СвязанныеСуммаПоЧекамТысThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СуммаПоЧеку )/1000,'# ##0');
SET СвязанныеСуммаПоЧекамТысThird.Label = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысThird.Comment = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/1000,'# ##0');
SET СвязанныеНаценкаПоЧекамТысThird.Label = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысThird.Comment = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеПроцентНаценкиПоЧекамThird = Money(sum( {Third<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/sum( {Third<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>}) * P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СебестоимостьПоЧеку ),'# ##0%');
SET СвязанныеПроцентНаценкиПоЧекамThird.Label = Сопутствующий % наценки по чекам;
SET СвязанныеПроцентНаценкиПоЧекамThird.Comment = Сопутствующий % наценки по чекам;
SET СвязанныеПродажиThirdСУчетомОсновного = Money(sum( {Third<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Third<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) , [НоменклатураСсылка]=($::НоменклатураСсылка)+(Second::НоменклатураСсылка)+(Third::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'},НоменклатураНаименование, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиThirdСУчетомОсновного.Label = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиThirdСУчетомОсновного.Comment = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиFourth.Label = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFourth.Comment = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиКоличествоFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Количество ),'# ##0,00');
SET СвязанныеПродажиКоличествоFourth.Label = Количество товара по сопутствующим продажам, шт;
SET СвязанныеПродажиКоличествоFourth.Comment = Количество товара по сопутствующим продажам, шт;
SET СвязаннаяМаржаFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ВП )/1000,'# ##0,00');
SET СвязаннаяМаржаFourth.Label = ВП по сопутствующим продажам, тыс. руб.;
SET СвязаннаяМаржаFourth.Comment = ВП по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Скидка )/1000,'# ##0,00');
SET СвязанныеПродажиСкидкаFourth.Label = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаFourth.Comment = Сумма скидки по сопутствующим продажам, тыс. руб.;
let ПроцентСкидкиFourth = replace(replace('Num(alt(@(СвязанныеПродажиСкидкаFourth)/(@(СвязанныеПродажиFourth)+@(СвязанныеПродажиСкидкаFourth)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиFourth.Label = Процент скидки по сопутствующим продажам;
SET ПроцентСкидкиFourth.Comment = Процент предоставленной скидки по сопутствующим продажам;
SET СвязанныеПродажиКолВоFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка), ТипПериода={'Current'},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} _СчетчикЧеков ),'# ##0');
SET СвязанныеПродажиКолВоFourth.Label = Количество чеков по сопутствующим продажам, шт;
SET СвязанныеПродажиКолВоFourth.Comment = Количество чеков по сопутствующим продажам, штук;
let ПроцентСопутствующейПенетрацииFourth = replace(replace('Money(@(СвязанныеПродажиКолВоFourth)/ Sum({$<ТипПериода={~~~Current~~~}>} TOTAL _СчетчикЧеков),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСопутствующейПенетрацииFourth.Label = % Пенетрации по сопутствующим продажам;
SET ПроцентСопутствующейПенетрацииFourth.Comment = % Пенетрации по сопутствующим продажам;
let ДлинаЧекаFourth = replace(replace('Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка), ТипПериода={~~~Current~~~},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} ДлинаЧека)/@(СвязанныеПродажиКолВоFourth),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаFourth.Label = Длина чека;
SET ДлинаЧекаFourth.Comment = Средняя длина чека (среднее количество строк в чеке);
let СреднийЧекFourth = replace(replace('Money((@(СвязанныеПродажиFourth)*1000)/@(СвязанныеПродажиКолВоFourth),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекFourth.Label = Средний чек;
SET СреднийЧекFourth.Comment = Средний чек;
let СвязанныйПроцентНаценкиFourth = replace(replace('Money(@(СвязаннаяМаржаFourth)/(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Себестоимость )/1000),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СвязанныйПроцентНаценкиFourth.Label = % Наценки по сопутствующим продажам;
SET СвязанныйПроцентНаценкиFourth.Comment = % Наценки по сопутствующим продажам;
SET СвязанныеСуммаПоЧекамТысFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СуммаПоЧеку )/1000,'# ##0');
SET СвязанныеСуммаПоЧекамТысFourth.Label = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысFourth.Comment = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/1000,'# ##0');
SET СвязанныеНаценкаПоЧекамТысFourth.Label = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысFourth.Comment = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеПроцентНаценкиПоЧекамFourth = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/sum( {Fourth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>}) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка),ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СебестоимостьПоЧеку ),'# ##0%');
SET СвязанныеПроцентНаценкиПоЧекамFourth.Label = Сопутствующий % наценки по чекам;
SET СвязанныеПроцентНаценкиПоЧекамFourth.Comment = Сопутствующий % наценки по чекам;
SET СвязанныеПродажиFourthСУчетомОсновного = Money(sum( {Fourth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Third<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Fourth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) , [НоменклатураСсылка]=($::НоменклатураСсылка)+(Second::НоменклатураСсылка)+(Third::НоменклатураСсылка)+(Fourth::НоменклатураСсылка), ТипДокумента={'Sales'},ТипПериода={'Current'},НоменклатураНаименование, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиFourthСУчетомОсновного.Label = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFourthСУчетомОсновного.Comment = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка), ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиFifth.Label = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFifth.Comment = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиКоличествоFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Количество ),'# ##0,00');
SET СвязанныеПродажиКоличествоFifth.Label = Количество товара по сопутствующим продажам, шт;
SET СвязанныеПродажиКоличествоFifth.Comment = Количество товара по сопутствующим продажам, шт;
SET СвязаннаяМаржаFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ВП )/1000,'# ##0,00');
SET СвязаннаяМаржаFifth.Label = ВП по сопутствующим продажам, тыс. руб.;
SET СвязаннаяМаржаFifth.Comment = ВП по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Скидка )/1000,'# ##0,00');
SET СвязанныеПродажиСкидкаFifth.Label = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаFifth.Comment = Сумма скидки по сопутствующим продажам, тыс. руб.;
let ПроцентСкидкиFifth = replace(replace('Num(alt(@(СвязанныеПродажиСкидкаFifth)/(@(СвязанныеПродажиFifth)+@(СвязанныеПродажиСкидкаFifth)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиFifth.Label = Процент скидки по сопутствующим продажам;
SET ПроцентСкидкиFifth.Comment = Процент предоставленной скидки по сопутствующим продажам;
SET СвязанныеПродажиКолВоFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={'Current'},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СчетчикЧеков ),'# ##0');
SET СвязанныеПродажиКолВоFifth.Label = Количество чеков по сопутствующим продажам, шт;
SET СвязанныеПродажиКолВоFifth.Comment = Количество чеков по сопутствующим продажам, штук;
let ПроцентСопутствующейПенетрацииFifth = replace(replace('Money(@(СвязанныеПродажиКолВоFifth)/ Sum({$<ТипПериода={~~~Current~~~}>} TOTAL _СчетчикЧеков),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСопутствующейПенетрацииFifth.Label = % Пенетрации по сопутствующим продажам;
SET ПроцентСопутствующейПенетрацииFifth.Comment = % Пенетрации по сопутствующим продажам;
let ДлинаЧекаFifth = replace(replace('Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={~~~Current~~~},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ДлинаЧека)/@(СвязанныеПродажиКолВоFifth),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаFifth.Label = Длина чека;
SET ДлинаЧекаFifth.Comment = Средняя длина чека (среднее количество строк в чеке);
let СреднийЧекFifth = replace(replace('Money((@(СвязанныеПродажиFifth)*1000)/@(СвязанныеПродажиКолВоFifth),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекFifth.Label = Средний чек;
SET СреднийЧекFifth.Comment = Средний чек;
let СвязанныйПроцентНаценкиFifth = replace(replace('Money(@(СвязаннаяМаржаFifth)/(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Себестоимость )/1000),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СвязанныйПроцентНаценкиFifth.Label = % Наценки по сопутствующим продажам;
SET СвязанныйПроцентНаценкиFifth.Comment = % Наценки по сопутствующим продажам;
SET СвязанныеСуммаПоЧекамТысFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СуммаПоЧеку )/1000,'# ##0');
SET СвязанныеСуммаПоЧекамТысFifth.Label = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысFifth.Comment = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/1000,'# ##0');
SET СвязанныеНаценкаПоЧекамТысFifth.Label = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысFifth.Comment = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеПроцентНаценкиПоЧекамFifth = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/sum( {Fifth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>}) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СебестоимостьПоЧеку ),'# ##0%');
SET СвязанныеПроцентНаценкиПоЧекамFifth.Label = Сопутствующий % наценки по чекам;
SET СвязанныеПроцентНаценкиПоЧекамFifth.Comment = Сопутствующий % наценки по чекам;
SET СвязанныеПродажиFifthСУчетомОсновного = Money(sum( {Fifth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Third<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Fourth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Fifth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) , [НоменклатураСсылка]=($::НоменклатураСсылка)+(Second::НоменклатураСсылка)+(Third::НоменклатураСсылка)+(Fourth::НоменклатураСсылка)+(Fifth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'},НоменклатураНаименование, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиFifthСУчетомОсновного.Label = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиFifthСУчетомОсновного.Comment = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка), ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиSixth.Label = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSixth.Comment = Сумма продаж по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиКоличествоSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Количество ),'# ##0,00');
SET СвязанныеПродажиКоличествоSixth.Label = Количество товара по сопутствующим продажам, шт;
SET СвязанныеПродажиКоличествоSixth.Comment = Количество товара по сопутствующим продажам, шт;
SET СвязаннаяМаржаSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} ВП )/1000,'# ##0,00');
SET СвязаннаяМаржаSixth.Label = ВП по сопутствующим продажам, тыс. руб.;
SET СвязаннаяМаржаSixth.Comment = ВП по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Скидка )/1000,'# ##0,00');
SET СвязанныеПродажиСкидкаSixth.Label = Сумма скидки по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиСкидкаSixth.Comment = Сумма скидки по сопутствующим продажам, тыс. руб.;
let ПроцентСкидкиSixth = replace(replace('Num(alt(@(СвязанныеПродажиСкидкаSixth)/(@(СвязанныеПродажиSixth)+@(СвязанныеПродажиСкидкаSixth)),0),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСкидкиSixth.Label = Процент скидки по сопутствующим продажам;
SET ПроцентСкидкиSixth.Comment = Процент предоставленной скидки по сопутствующим продажам;
SET СвязанныеПродажиКолВоSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={'Current'},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} _СчетчикЧеков ),'# ##0');
SET СвязанныеПродажиКолВоSixth.Label = Количество чеков по сопутствующим продажам, шт;
SET СвязанныеПродажиКолВоSixth.Comment = Количество чеков по сопутствующим продажам, штук;
let ПроцентСопутствующейПенетрацииSixth = replace(replace('Money(@(СвязанныеПродажиКолВоSixth)/ Sum({$<ТипПериода={~~~Current~~~}>} TOTAL _СчетчикЧеков),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСопутствующейПенетрацииSixth.Label = % Пенетрации по сопутствующим продажам;
SET ПроцентСопутствующейПенетрацииSixth.Comment = % Пенетрации по сопутствующим продажам;
let ДлинаЧекаSixth = replace(replace('Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={~~~Current~~~},Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека>} ДлинаЧека)/@(СвязанныеПродажиКолВоSixth),~~~# ##0,0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ДлинаЧекаSixth.Label = Длина чека;
SET ДлинаЧекаSixth.Comment = Средняя длина чека (среднее количество строк в чеке);
let СреднийЧекSixth = replace(replace('Money((@(СвязанныеПродажиSixth)*1000)/@(СвязанныеПродажиКолВоSixth),~~~# ##0~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СреднийЧекSixth.Label = Средний чек;
SET СреднийЧекSixth.Comment = Средний чек;
let СвязанныйПроцентНаценкиSixth = replace(replace('Money(@(СвязаннаяМаржаSixth)/(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипДокумента={~~~Sales~~~},ТипПериода={~~~Current~~~}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Себестоимость )/1000),~~~# ##0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СвязанныйПроцентНаценкиSixth.Label = % Наценки по сопутствующим продажам;
SET СвязанныйПроцентНаценкиSixth.Comment = % Наценки по сопутствующим продажам;
SET СвязанныеСуммаПоЧекамТысSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СуммаПоЧеку )/1000,'# ##0');
SET СвязанныеСуммаПоЧекамТысSixth.Label = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеСуммаПоЧекамТысSixth.Comment = Сопутствующая сумма по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/1000,'# ##0');
SET СвязанныеНаценкаПоЧекамТысSixth.Label = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеНаценкаПоЧекамТысSixth.Comment = Сопутствующая наценка по чекам, тыс. руб.;
SET СвязанныеПроцентНаценкиПоЧекамSixth = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _НаценкаПоЧеку )/sum( {Sixth<_КлючЗаголовкаЧека = P({$<НоменклатураСсылка =$::НоменклатураСсылка>}) *P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Third<НоменклатураСсылка =Third::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fourth<НоменклатураСсылка =Fourth::НоменклатураСсылка>} _КлючЗаголовкаЧека) *P({Fifth<НоменклатураСсылка =Fifth::НоменклатураСсылка>} _КлючЗаголовкаЧека), [НоменклатураСсылка]=e($::НоменклатураСсылка)*e(Second::НоменклатураСсылка)*e(Third::НоменклатураСсылка)*e(Fourth::НоменклатураСсылка)*e(Fifth::НоменклатураСсылка) ,ТипПериода={'Current'}, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,Дата=$::Дата,Кассир=$::Кассир,ДлинаЧека=$::ДлинаЧека,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} _СебестоимостьПоЧеку ),'# ##0%');
SET СвязанныеПроцентНаценкиПоЧекамSixth.Label = Сопутствующий % наценки по чекам;
SET СвязанныеПроцентНаценкиПоЧекамSixth.Comment = Сопутствующий % наценки по чекам;
SET СвязанныеПродажиSixthСУчетомОсновного = Money(sum( {Sixth<_КлючЗаголовкаЧека = P({Second<НоменклатураСсылка =Second::НоменклатураСсылка>} _КлючЗаголовкаЧека) * P({$<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Third<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Fourth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Fifth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека)* P({Sixth<НоменклатураСсылка =$::НоменклатураСсылка>} _КлючЗаголовкаЧека) , [НоменклатураСсылка]=($::НоменклатураСсылка)+(Second::НоменклатураСсылка)+(Third::НоменклатураСсылка)+(Fourth::НоменклатураСсылка)+(Fifth::НоменклатураСсылка)+(Sixth::НоменклатураСсылка) ,ТипДокумента={'Sales'},ТипПериода={'Current'},НоменклатураНаименование, Год = $::Год,Месяц=$::Месяц,Склад=$::Склад,ДлинаЧека=$::ДлинаЧека,Кассир=$::Кассир,ШкалаСуммаЧека=$::ШкалаСуммаЧека >} Сумма )/1000,'# ##0,00');
SET СвязанныеПродажиSixthСУчетомОсновного.Label = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET СвязанныеПродажиSixthСУчетомОсновного.Comment = Сумма продаж с учетом корзины по сопутствующим продажам, тыс. руб.;
SET ГруппировкаБезДиапазона =  if(round(aggr($2,$1),$3)>0, if(round(aggr($2,$1),$3)>$5,Dual('>' & $5/$6, $5), if(round(aggr($2,$1),$3,$3/2)>=$4,Dual($4/$6 & ' - ' & $5/$6, $4), Dual(Money(Floor(round(aggr({<_ТипДокумента = {'Чек'}>}$2,$1),$3,$3/2),$3)/$6,'#0'),round(aggr({<_ТипДокумента = {'Чек'}>}$2,$1),$3)/$6))), if (round(aggr($2,$1),$3)<0,'Возвр.',null()));
SET ГруппировкаБезДиапазона.Label = ГруппировкаШагГраницыТолькоПоложительные;
SET ГруппировкаШагГраницыТолькоПоложительные =  if(round(aggr($2,$1),$3,$3/2)>0, if(round(aggr($2,$1),$3,$3/2)>$5,Dual('>' & $5/$6, $5), if(round(aggr($2,$1),$3,$3/2)>=$4,Dual($4/$6 & ' - ' & $5/$6, $4), Dual(Money(Floor(round(aggr($2,$1),$3,$3/2),$3)/$6,'#0') & '-' & Money(Floor(round(aggr($2,$1),$3,$3/2),$3)/$6+$3/$6,'#0'), round(aggr($2,$1),$3,$3/2)/$6))), if (round(aggr($2,$1),$3,$3/2)<0,'Возвр.',null()));
SET ГруппировкаШагГраницыТолькоПоложительные.Label = ГруппировкаШагГраницыТолькоПоложительные;
SET ГруппировкаШагГраницыТолькоПоложительные.Comment = Параметры - Измерение для группировки, Выражение, Шаг сегментации, Первая верхняя граница, Вторая верхняя граница,Масштаб;
let РазбивкаПоСуммеЧека = replace(replace(' if(round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2)>0, if(round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2)>@(ШагСегментаЧекВерхГраница2),Dual(~~~>~~~ & @(ШагСегментаЧекВерхГраница2)/1000, @(ШагСегментаЧекВерхГраница2)), if(round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2)>=@(ШагСегментаЧекВерхГраница1),Dual(@(ШагСегментаЧекВерхГраница1)/1000 & ~~~ - ~~~ & @(ШагСегментаЧекВерхГраница2)/1000, @(ШагСегментаЧекВерхГраница1)), Dual(Money(Floor(round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2),@(ШагСегментаЧек))/1000,~~~#0~~~) & ~~~-~~~ & Money(Floor(round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2),@(ШагСегментаЧек))/1000+@(ШагСегментаЧек)/1000,~~~#0~~~), round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2)/1000))), if (round(aggr(@(СуммаЧеков),_КлючЗаголовкаЧека),@(ШагСегментаЧек),@(ШагСегментаЧек)/2)<0,~~~Возвр.~~~,null()))','~~~', chr(39)), '@(', chr(36) & '(');
SET РазбивкаПоСуммеЧека.Label = РазбивкаПоСуммеЧека;
SET ШагДлинаЧекВерхГраница1 = 3;
SET ШагДлинаЧекВерхГраница2 = 6;
let РазбивкаПоДлинеЧека = replace(replace(' if(round(aggr(@(ДлинаЧека),_КлючЗаголовкаЧека),1)>0, if(round(aggr(@(ДлинаЧека),_КлючЗаголовкаЧека),1)>@(ШагДлинаЧекВерхГраница2),Dual(~~~>~~~ & @(ШагДлинаЧекВерхГраница2)/1, @(ШагДлинаЧекВерхГраница2)), if(round(aggr(@(ДлинаЧека),_КлючЗаголовкаЧека),1,1/2)>=@(ШагДлинаЧекВерхГраница1),Dual(@(ШагДлинаЧекВерхГраница1)/1 & ~~~ - ~~~ & @(ШагДлинаЧекВерхГраница2)/1, @(ШагДлинаЧекВерхГраница1)), Dual(Money(Floor(round(aggr({<_ТипДокумента = {~~~Чек~~~}>}@(ДлинаЧека),_КлючЗаголовкаЧека),1,1/2),1)/1,~~~#0~~~),round(aggr({<_ТипДокумента = {~~~Чек~~~}>}@(ДлинаЧека),_КлючЗаголовкаЧека),1)/1))), if (round(aggr(@(ДлинаЧека),_КлючЗаголовкаЧека),1)<0,~~~Возвр.~~~,null()))','~~~', chr(39)), '@(', chr(36) & '(');
SET РазбивкаПоДлинеЧека.Label = РазбивкаПоДлинеЧека;
SET РазбивкаПоДлинеЧека.Comment = Разбивка по длине чека;
let РазбивкаПоРазмеруСкидки = replace(replace('@(ГруппировкаШагГраницыТолькоПоложительные%(_КлючЗаголовкаЧека, (Sum({<_ТипДокумента = {~~~Чек~~~},ТипПериода={~~~Current~~~}>}ПродажиСкидка)/(Sum({<_ТипДокумента = {~~~Чек~~~},ТипПериода={~~~Current~~~}>}ПродажиСкидка)+Sum({<_ТипДокумента = {~~~Чек~~~},ТипПериода={~~~Current~~~}>}Сумма))), 0.05, 0.3, 0.6,1))','~~~', chr(39)), '@(', chr(36) & '(');
SET РазбивкаПоРазмеруСкидки.Label = РазбивкаПоРазмеруСкидки;
SET ШагСегментаЧек = 2000;
SET ШагСегментаЧек.Label = ШагСегментаЧек;
let РазбивкаПоЧасам = replace(replace('@(ГруппировкаШагГраницыТолькоПоложительные(_КлючЗаголовкаЧека, Час, 1, 30, 31,1))','~~~', chr(39)), '@(', chr(36) & '(');
SET РазбивкаПоЧасам.Label = РазбивкаПоЧасам;
SET РазбивкаПоЧасам.Comment = Разбивка по времени покупки (часы);
SET СуммаСписаний = Money(Sum({$<ТипДокумента={'Spis'}, ТипПериода={'Current'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаСписаний.Label = Списания тыс. руб.;
SET СуммаСписаний.Comment = Сумма списаний в тыс. руб.;
SET СуммаСписанийПредГод = Money(sum({$<ТипДокумента = {'Spis'},_ФлагДействующаяДата={1}, ТипПериода={'Год'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаСписанийПредГод.Label = Списания пред. (1) Год, тыс. руб.;
SET СуммаСписанийПредГод.Comment = Cумма cписаний за предыдущий год тыс.руб.;
SET СуммаСписанийПредГод2 = Money((sum({<ТипДокумента = {'Spis'},_ФлагДействующаяДата={1}, ТипПериода={'Год-2'}>}Себестоимость)/1000),'# ##0,00');
SET СуммаСписанийПредГод2.Label = Списания пред. (2) Год, тыс. руб.;
SET СуммаСписанийПредГод2.Comment = Cумма списаний за предпредыдущий год тыс.руб.;
let ПроцентСуммыСписанийПредГод = replace(replace('Money(@(СуммаСписаний)/@(СуммаСписанийПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммыСписанийПредГод.Label = % изм.Продаж к пред. (1) Год;
SET ПроцентСуммыСписанийПредГод.Comment = Процент списаний к предыдущему году;
let ПроцентСуммыСписанийПредГод2 = replace(replace('Money(@(СуммаСписаний)/@(СуммаСписанийПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммыСписанийПредГод2.Label = % изм.Продаж к пред. (2) Год;
SET ПроцентСуммыСписанийПредГод2.Comment = Процент списаний к предпредыдущему году;
let СуммаРостаСуммыСписанийПредГод = replace(replace('Money(@(СуммаСписаний)-@(СуммаСписанийПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммыСписанийПредГод.Label = ∆ изм. Продаж к пред. (1) Год;
SET СуммаРостаСуммыСписанийПредГод.Comment = Сумма роста cписаний к предыдущему году;
let СуммаРостаСуммыСписанийПредГод2 = replace(replace('Money(@(СуммаСписаний)-@(СуммаСписанийПредГод2),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммыСписанийПредГод2.Label = ∆ изм. Продаж к пред. (2) Год;
SET СуммаРостаСуммыСписанийПредГод2.Comment = Сумма роста cписаний к предпредыдущему году;
SET СуммаСписанийПредМес = Money(sum({<ТипДокумента = {'Spis'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяц'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаСписанийПредМес.Label = Списания тыс.руб. пред мес;
SET СуммаСписанийПредМес.Comment = Cумма списаний за предыдущий мес тыс.руб.;
let ПроцентСуммыСписанийПредМес = replace(replace('Money(@(СуммаСписаний)/@(СуммаСписанийПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммыСписанийПредМес.Label = % Списания к пред мес;
SET ПроцентСуммыСписанийПредМес.Comment = Процент списаний к предыдущему месяцу;
let СуммаРостаСуммыСписанийПредМес = replace(replace('Money(@(СуммаСписаний)-@(СуммаСписанийПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммыСписанийПредМес.Label = Сумма роста Продаж к пред мес;
SET СуммаРостаСуммыСписанийПредМес.Comment = Сумма роста cписаний к предыдущему месяцу;
SET СписанияКоличество = Money(Sum({$<ТипДокумента ={'Spis'},ТипПериода={'Current'}>}Количество),'# ##0,00');
SET СписанияКоличество.Label = Кол списанного товара, шт;
SET СписанияКоличество.Comment = Количество списанного товара в штуках;
SET СуммаСписанийПредГодДеньНедели = Money(sum({<ТипДокумента = {'Spis'},_ФлагДействующаяДата={1}, ТипПериода={'ГодДеньНедели'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаСписанийПредГодДеньНедели.Label = Списания пред. (1) Год тот же день недели, тыс. руб.;
SET СуммаСписанийПредГодДеньНедели.Comment = Cумма cписаний за предыдущий тот же день недели год тыс.руб.;
let ПроцентСуммыСписанийПредГодДеньНедели = replace(replace('Money(@(СуммаСписаний)/@(СуммаСписанийПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммыСписанийПредГодДеньНедели.Label = % изм.Продаж к пред. (1) Год тот же день недели;
SET ПроцентСуммыСписанийПредГодДеньНедели.Comment = Процент списаний к предыдущему году тот же день недели;
let СуммаРостаСуммыСписанийПредГодДеньНедели = replace(replace('Money(@(СуммаСписаний)-@(СуммаСписанийПредГодДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммыСписанийПредГодДеньНедели.Label = ∆ изм. Продаж к пред. (1) Год тот же день недели;
SET СуммаРостаСуммыСписанийПредГодДеньНедели.Comment = Сумма роста cписаний к предыдущему году тот же день недели;
SET СуммаСписанийПредГод2ДеньНедели = Money(sum({<ТипДокумента = {'Spis'},_ФлагДействующаяДата={1}, ТипПериода={'Год2ДеньНедели'}>}Себестоимость)/1000,'# ##0,00');
SET СуммаСписанийПредГод2ДеньНедели.Label = Списания пред. (2) Год тот же день недели, тыс. руб.;
SET СуммаСписанийПредГод2ДеньНедели.Comment = Cумма cписаний за предпредыдущий тот же день недели год тыс.руб.;
let ПроцентСуммыСписанийПредГод2ДеньНедели = replace(replace('Money(@(СуммаСписаний)/@(СуммаСписанийПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСуммыСписанийПредГод2ДеньНедели.Label = % изм.Продаж к пред. (2) Год тот же день недели;
SET ПроцентСуммыСписанийПредГод2ДеньНедели.Comment = Процент списаний к предпредыдущему году тот же день недели;
let СуммаРостаСуммыСписанийПредГод2ДеньНедели = replace(replace('Money(@(СуммаСписаний)-@(СуммаСписанийПредГод2ДеньНедели),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСуммыСписанийПредГод2ДеньНедели.Label = ∆ изм. Продаж к пред. (2) Год тот же день недели;
SET СуммаРостаСуммыСписанийПредГод2ДеньНедели.Comment = Сумма роста cписаний к предпредыдущему году тот же день недели;
SET КоэфОбслуживанияПлан = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanKO'},ТипПериода={'Current'}>} Сумма),'# ##0,00%');
SET КоэфОбслуживанияПлан.Label = Коэф обсл план, %;
SET КоэфОбслуживанияПлан.Comment = Коэффициент обслуживания план, %;
SET КоэфОбслуживанияФакт = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanKO'},ТипПериода={'Current'}>} Себестоимость),'# ##0,00%');
SET КоэфОбслуживанияФакт.Label = Коэф обсл факт, %;
SET КоэфОбслуживанияФакт.Comment = Коэффициент обслуживания факт, %;
let КоэфОбслуживанияПФ = replace(replace('Money(@(КоэфОбслуживанияФакт)/@(КоэфОбслуживанияПлан),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоэфОбслуживанияПФ.Label = ПФ Коэф обсл, %;
SET КоэфОбслуживанияПФ.Comment = Коэффициент обслуживания факт к плану, %;
let КоэфОбслуживания_П_Ф = replace(replace('Money(@(КоличествоСКУПродано) - @(КоличествоСКУПроданоПлан),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET КоэфОбслуживания_П_Ф.Label = ∆ П-Ф Коэф обсл, %;
SET КоэфОбслуживания_П_Ф.Comment = Коэффициент обслуживания факт минус план, %;
SET КоэфОбслуживанияФактПредГод = Money(Max({<ТипДокумента = {'PlanKO'},_ФлагДействующаяДата={1},ТипПериода={'Год'}>}Себестоимость),'# ##0,00%');
SET КоэфОбслуживанияФактПредГод.Label = Коэф обсл факт, % пред год;
SET КоэфОбслуживанияФактПредГод.Comment = Коэффициент обслуживания факт, % за предыдущий год;
let ПроцентКоэфОбслуживанияФактПредГод = replace(replace('Money(@(КоэфОбслуживанияФакт)/@(КоэфОбслуживанияФактПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфОбслуживанияФактПредГод.Label = % Коэф обсл факт, % к пред год;
SET ПроцентКоэфОбслуживанияФактПредГод.Comment = Процент коэффициента обслуживания факт, % к предыдущему году;
let СуммаРостаКоэфОбслуживанияФактПредГод = replace(replace('Money(@(КоэфОбслуживанияФакт)-@(КоэфОбслуживанияФактПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфОбслуживанияФактПредГод.Label = Сумма роста Коэф обсл факт, % к пред год;
SET СуммаРостаКоэфОбслуживанияФактПредГод.Comment = Сумма роста коэффициента обслуживания факт, % к предыдущему году;
SET КоэфОбслуживанияФактПредМес = Money(Max({<ТипДокумента = {'PlanKO'},_ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}Себестоимость),'# ##0,00%');
SET КоэфОбслуживанияФактПредМес.Label = Коэф обсл факт, % пред мес;
SET КоэфОбслуживанияФактПредМес.Comment = Коэффициент обслуживания факт, % за предыдущий мес;
let ПроцентКоэфОбслуживанияФактПредМес = replace(replace('Money(@(КоэфОбслуживанияФакт)/@(КоэфОбслуживанияФактПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфОбслуживанияФактПредМес.Label = % Коэф обсл факт, % к пред мес;
SET ПроцентКоэфОбслуживанияФактПредМес.Comment = Процент коэффициента обслуживания факт, % к предыдущему месяцу;
let СуммаРостаКоэфОбслуживанияФактПредМес = replace(replace('Money(@(КоэфОбслуживанияФакт)-@(КоэфОбслуживанияФактПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфОбслуживанияФактПредМес.Label = Сумма роста Коэф обсл факт, % к пред мес;
SET СуммаРостаКоэфОбслуживанияФактПредМес.Comment = Сумма роста коэффициента обслуживания факт, % к предыдущему месяцу;
SET КоэфОбслуживанияФактПредГодДеньНедели = Money(Max({<ТипДокумента = {'PlanKO'},_ФлагДействующаяДата={1},ТипПериода={'ГодДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфОбслуживанияФактПредГодДеньНедели.Label = Коэф обсл факт, % пред. (1) Год тот же день недели;
SET КоэфОбслуживанияФактПредГодДеньНедели.Comment = Коэффициент обслуживания факт, % за предыдущий тот же день недели год;
let ПроцентКоэфОбслуживанияФактПредГодДеньНедели = replace(replace('Money(@(КоэфОбслуживанияФакт)/@(КоэфОбслуживанияФактПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфОбслуживанияФактПредГодДеньНедели.Label = % изм.Коэф обсл факт, % к пред. (1) Год тот же день недели;
SET ПроцентКоэфОбслуживанияФактПредГодДеньНедели.Comment = Процент коэффициента обслуживания факт, % к предыдущему году тот же день недели;
let СуммаРостаКоэфОбслуживанияФактПредГодДеньНедели = replace(replace('Money(@(КоэфОбслуживанияФакт)-@(КоэфОбслуживанияФактПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфОбслуживанияФактПредГодДеньНедели.Label = ∆ изм. Коэф обсл факт, % к пред. (1) Год тот же день недели;
SET СуммаРостаКоэфОбслуживанияФактПредГодДеньНедели.Comment = Сумма роста коэффициента обслуживания факт, % к предыдущему году тот же день недели;
SET КоэфОбслуживанияФактПредГод2ДеньНедели = Money(Max({<ТипДокумента = {'PlanKO'},_ФлагДействующаяДата={1},ТипПериода={'Год2ДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфОбслуживанияФактПредГод2ДеньНедели.Label = Коэф обсл факт, % пред. (2) Год тот же день недели;
SET КоэфОбслуживанияФактПредГод2ДеньНедели.Comment = Коэффициент обслуживания факт, % за предпредыдущий тот же день недели год;
let ПроцентКоэфОбслуживанияФактПредГод2ДеньНедели = replace(replace('Money(@(КоэфОбслуживанияФакт)/@(КоэфОбслуживанияФактПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфОбслуживанияФактПредГод2ДеньНедели.Label = % изм.Коэф обсл факт, % к пред. (2) Год тот же день недели;
SET ПроцентКоэфОбслуживанияФактПредГод2ДеньНедели.Comment = Процент коэффициента обслуживания факт, % к предпредыдущему году тот же день недели;
let СуммаРостаКоэфОбслуживанияФактПредГод2ДеньНедели = replace(replace('Money(@(КоэфОбслуживанияФакт)-@(КоэфОбслуживанияФактПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфОбслуживанияФактПредГод2ДеньНедели.Label = ∆ изм. Коэф обсл факт, % к пред. (2) Год тот же день недели;
SET СуммаРостаКоэфОбслуживанияФактПредГод2ДеньНедели.Comment = Сумма роста коэффициента обслуживания факт, % к предпредыдущему году тот же день недели;
SET КоэфТайПоПлан = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanTP'},ТипПериода={'Current'}>} Сумма),'# ##0,00%');
SET КоэфТайПоПлан.Label = Коэф ТайПо план, %;
SET КоэфТайПоПлан.Comment = Коэффициент тайный покупатель план, %;
SET КоэфТайПо = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanTP'},ТипПериода={'Current'}>} Себестоимость	),'# ##0,00%');
SET КоэфТайПо.Label = Коэф ТайПо факт, %;
SET КоэфТайПо.Comment = Коэффициент тайный покупатель факт, %;
let ПФ_КоэфТайПо = replace(replace('Money(@(КоэфТайПо)/@(КоэфТайПоПлан),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_КоэфТайПо.Label = % вып ТайПо;
SET ПФ_КоэфТайПо.Comment = Факт отнесенный к плану по тайному покупателю, %;
let П_Ф_КоэфТайПо = replace(replace('Money((@(КоэфТайПо)-@(КоэфТайПоПлан)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_КоэфТайПо.Label = ∆ ПФ ТайПо;
SET П_Ф_КоэфТайПо.Comment = План минус факт по тайному покупателю, %;
SET КоэфТайПоПредГод = Money(Max({<ТипДокумента = {'PlanTP'},_ФлагДействующаяДата={1},ТипПериода={'Год'}>}Себестоимость),'# ##0,00%');
SET КоэфТайПоПредГод.Label = Коэф ТайПо факт, % пред год;
SET КоэфТайПоПредГод.Comment = Коэффициент тайный покупатель факт, % за предыдущий год;
let ПроцентКоэфТайПоПредГод = replace(replace('Money(@(КоэфТайПо)/@(КоэфТайПоПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфТайПоПредГод.Label = % Коэф ТайПо факт, % к пред год;
SET ПроцентКоэфТайПоПредГод.Comment = Процент коэффициента тайный покупатель факт, % к предыдущему году;
let СуммаРостаКоэфТайПоПредГод = replace(replace('Money(@(КоэфТайПо)-@(КоэфТайПоПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфТайПоПредГод.Label = Сумма роста Коэф ТайПо факт, % к пред год;
SET СуммаРостаКоэфТайПоПредГод.Comment = Сумма роста коэффициента тайный покупатель факт, % к предыдущему году;
SET КоэфТайПоПредМес = Money(Max({<ТипДокумента = {'PlanTP'},_ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}Себестоимость),'# ##0,00%');
SET КоэфТайПоПредМес.Label = Коэф ТайПо факт, % пред мес;
SET КоэфТайПоПредМес.Comment = Коэффициент тайный покупатель факт, % за предыдущий мес;
let ПроцентКоэфТайПоПредМес = replace(replace('Money(@(КоэфТайПо)/@(КоэфТайПоПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфТайПоПредМес.Label = % Коэф ТайПо факт, % к пред мес;
SET ПроцентКоэфТайПоПредМес.Comment = Процент коэффициента тайный покупатель факт, % к предыдущему месяцу;
let СуммаРостаКоэфТайПоПредМес = replace(replace('Money(@(КоэфТайПо)-@(КоэфТайПоПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфТайПоПредМес.Label = Сумма роста Коэф ТайПо факт, % к пред мес;
SET СуммаРостаКоэфТайПоПредМес.Comment = Сумма роста коэффициента тайный покупатель факт, % к предыдущему месяцу;
SET КоэфТайПоПредГодДеньНедели = Money(Max({<ТипДокумента = {'PlanTP'},_ФлагДействующаяДата={1},ТипПериода={'ГодДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфТайПоПредГодДеньНедели.Label = Коэф ТайПо факт, % пред. (1) Год тот же день недели;
SET КоэфТайПоПредГодДеньНедели.Comment = Коэффициент тайный покупатель факт, % за предыдущий тот же день недели год;
let ПроцентКоэфТайПоПредГодДеньНедели = replace(replace('Money(@(КоэфТайПо)/@(КоэфТайПоПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфТайПоПредГодДеньНедели.Label = % изм.Коэф ТайПо факт, % к пред. (1) Год тот же день недели;
SET ПроцентКоэфТайПоПредГодДеньНедели.Comment = Процент коэффициента тайный покупатель факт, % к предыдущему году тот же день недели;
let СуммаРостаКоэфТайПоПредГодДеньНедели = replace(replace('Money(@(КоэфТайПо)-@(КоэфТайПоПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфТайПоПредГодДеньНедели.Label = ∆ изм. Коэф ТайПо факт, % к пред. (1) Год тот же день недели;
SET СуммаРостаКоэфТайПоПредГодДеньНедели.Comment = Сумма роста коэффициента тайный покупатель факт, % к предыдущему году тот же день недели;
SET КоэфТайПоПредГод2ДеньНедели = Money(Max({<ТипДокумента = {'PlanTP'},_ФлагДействующаяДата={1},ТипПериода={'Год2ДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфТайПоПредГод2ДеньНедели.Label = Коэф обсл ТайПо, % пред. (2) Год тот же день недели;
SET КоэфТайПоПредГод2ДеньНедели.Comment = Коэффициент тайный покупатель факт, % за предпредыдущий тот же день недели год;
let ПроцентКоэфТайПоПредГод2ДеньНедели = replace(replace('Money(@(КоэфТайПо)/@(КоэфТайПоПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфТайПоПредГод2ДеньНедели.Label = % изм.Коэф обсл ТайПо, % к пред. (2) Год тот же день недели;
SET ПроцентКоэфТайПоПредГод2ДеньНедели.Comment = Процент коэффициента тайный покупатель факт, % к предпредыдущему году тот же день недели;
let СуммаРостаКоэфТайПоПредГод2ДеньНедели = replace(replace('Money(@(КоэфТайПо)-@(КоэфТайПоПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфТайПоПредГод2ДеньНедели.Label = ∆ изм. Коэф ТайПо факт, % к пред. (2) Год тот же день недели;
SET СуммаРостаКоэфТайПоПредГод2ДеньНедели.Comment = Сумма роста коэффициента тайный покупатель факт, % к предпредыдущему году тот же день недели;
SET КоэфISEПлан = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanISE'},ТипПериода={'Current'}>} Сумма),'# ##0,00%');
SET КоэфISEПлан.Label = Коэф ISE план, %;
SET КоэфISEПлан.Comment = Коэффициент ISE план, %;
SET КоэфISE = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'PlanISE'},ТипПериода={'Current'}>} Себестоимость),'# ##0');
SET КоэфISE.Label = Коэф ISE факт, выполнен или нет;
SET КоэфISE.Comment = Коэффициент ISE факт, выполнен или нет;
let ПФ_КоэфISE = replace(replace('Money(@(КоэфISE)/@(КоэфISEПлан),~~~# ##0,0%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПФ_КоэфISE.Label = % вып ISE;
SET ПФ_КоэфISE.Comment = Факт отнесенный к плану по ISE, %;
let П_Ф_ISE = replace(replace('Money((@(КоэфISE)-@(КоэфISEПлан)),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET П_Ф_ISE.Label = ∆ ПФ ISE;
SET П_Ф_ISE.Comment = План минус факт по ISE, %;
SET КоэфISEПредГод = Money(Max({<ТипДокумента = {'PlanISE'},_ФлагДействующаяДата={1},ТипПериода={'Год'}>}Себестоимость),'# ##0,00%');
SET КоэфISEПредГод.Label = Коэф ISE факт, % пред год;
SET КоэфISEПредГод.Comment = Коэффициент ISE факт, % за предыдущий год;
let ПроцентКоэфISEПредГод = replace(replace('Money(@(КоэфISE)/@(КоэфISEПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфISEПредГод.Label = % Коэф ISE факт, % к пред год;
SET ПроцентКоэфISEПредГод.Comment = Процент коэффициента ISE факт, % к предыдущему году;
let СуммаРостаКоэфISEПредГод = replace(replace('Money(@(КоэфISE)-@(КоэфISEПредГод),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфISEПредГод.Label = Сумма роста Коэф ISE факт, % к пред год;
SET СуммаРостаКоэфISEПредГод.Comment = Сумма роста коэффициента ISE факт, % к предыдущему году;
SET КоэфISEПредМес = Money(Max({<ТипДокумента = {'PlanISE'},_ФлагДействующаяДата={1},ТипПериода={'ГодМесяц'}>}Себестоимость),'# ##0,00%');
SET КоэфISEПредМес.Label = Коэф ISE факт, % пред мес;
SET КоэфISEПредМес.Comment = Коэффициент ISE факт, % за предыдущий мес;
let ПроцентКоэфISEПредМес = replace(replace('Money(@(КоэфISE)/@(КоэфISEПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфISEПредМес.Label = % Коэф ISE факт, % к пред мес;
SET ПроцентКоэфISEПредМес.Comment = Процент коэффициента ISE факт, % к предыдущему месяцу;
let СуммаРостаКоэфISEПредМес = replace(replace('Money(@(КоэфISE)-@(КоэфISEПредМес),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфISEПредМес.Label = Сумма роста Коэф ISE факт, % к пред мес;
SET СуммаРостаКоэфISEПредМес.Comment = Сумма роста коэффициента ISE факт, % к предыдущему месяцу;
SET КоэфISEПредГодДеньНедели = Money(Max({<ТипДокумента = {'PlanISE'},_ФлагДействующаяДата={1},ТипПериода={'ГодДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфISEПредГодДеньНедели.Label = Коэф ISE факт, % пред. (1) Год тот же день недели;
SET КоэфISEПредГодДеньНедели.Comment = Коэффициент ISE факт, % за предыдущий тот же день недели год;
let ПроцентКоэфISEПредГодДеньНедели = replace(replace('Money(@(КоэфISE)/@(КоэфISEПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфISEПредГодДеньНедели.Label = % изм.Коэф ISE факт, % к пред. (1) Год тот же день недели;
SET ПроцентКоэфISEПредГодДеньНедели.Comment = Процент коэффициента ISE факт, % к предыдущему году тот же день недели;
let СуммаРостаКоэфISEПредГодДеньНедели = replace(replace('Money(@(КоэфISE)-@(КоэфISEПредГодДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфISEПредГодДеньНедели.Label = ∆ изм. Коэф ISE факт, % к пред. (1) Год тот же день недели;
SET СуммаРостаКоэфISEПредГодДеньНедели.Comment = Сумма роста коэффициента ISE факт, % к предыдущему году тот же день недели;
SET КоэфISEПредГод2ДеньНедели = Money(Max({<ТипДокумента = {'PlanISE'},_ФлагДействующаяДата={1},ТипПериода={'Год2ДеньНедели'}>}Себестоимость),'# ##0,00%');
SET КоэфISEПредГод2ДеньНедели.Label = Коэф обсл ISE, % пред. (2) Год тот же день недели;
SET КоэфISEПредГод2ДеньНедели.Comment = Коэффициент ISE факт, % за предпредыдущий тот же день недели год;
let ПроцентКоэфISEПредГод2ДеньНедели = replace(replace('Money(@(КоэфISE)/@(КоэфISEПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентКоэфISEПредГод2ДеньНедели.Label = % изм.Коэф обсл ISE, % к пред. (2) Год тот же день недели;
SET ПроцентКоэфISEПредГод2ДеньНедели.Comment = Процент коэффициента ISE факт, % к предпредыдущему году тот же день недели;
let СуммаРостаКоэфISEПредГод2ДеньНедели = replace(replace('Money(@(КоэфISE)-@(КоэфISEПредГод2ДеньНедели),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаКоэфISEПредГод2ДеньНедели.Label = ∆ изм. Коэф ISE факт, % к пред. (2) Год тот же день недели;
SET СуммаРостаКоэфISEПредГод2ДеньНедели.Comment = Сумма роста коэффициента ISE факт, % к предпредыдущему году тот же день недели;
SET Сезонность = Money(Max({<_ФлагДействующаяДата={1},ТипДокумента={'Season'},ТипПериода={'Current'},ШкалаЛиквидностиИсторическая,Склад>} Сумма),'# ##0,00');
SET Сезонность.Label = Сезонность;
SET Сезонность.Comment = Сезонность (коэффициент, помесячно);
SET СезонностьМесяцВперед = Money(Max({<ТипДокумента = {'Season'},_ФлагДействующаяДата={1}, ТипПериода={'ГодМесяцВперед'},ШкалаЛиквидностиИсторическая,Склад>}Сумма),'# ##0,00');
SET СезонностьМесяцВперед.Label = Сезонность сл. месяц;
SET СезонностьМесяцВперед.Comment = Сезонность в сл. месяце (коэффициент, помесячно);
let СуммаРостаСезонностьМесяцВперед = replace(replace('Money(@(СезонностьМесяцВперед)-@(Сезонность),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаСезонностьМесяцВперед.Label = ∆ изм. сезонность сл. месяц;
SET СуммаРостаСезонностьМесяцВперед.Comment = Сумма изменений сезонность в сл. месяце (коэффициент, помесячно);
let ПроцентСезонностьМесяцВперед = replace(replace('Money(@(СезонностьМесяцВперед)/@(Сезонность),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентСезонностьМесяцВперед.Label = % изм.Продаж к сл. месяцу;
SET ПроцентСезонностьМесяцВперед.Comment = Процент изменений сезонность к сл. месяце (коэффициент, помесячно);
let ОстаткиИзлишки540 = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540.Label = Излишки 540 по себестоимости на конец месяца, тыс.руб.;
SET ОстаткиИзлишки540.Comment = Излишки 540 по себестоимости на конец месяца, тыс.руб.;
let ОстаткиИзлишки540ПредМес = replace(replace('Money(Sum({<ТипПериода={~~~ГодМесяц~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540ПредМес.Label = Излишки 540 по себестоимости на конец пред мес, тыс.руб.;
SET ОстаткиИзлишки540ПредМес.Comment = Излишки 540 по себестоимости на конец предыдущего месяца, тыс.руб.;
let СуммаРостаОстаткиИзлишки540ПредМес = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки540ПредМес.Label = Сумма роста Излишки 540 по себестоимости на конец месяца, тыс.руб. к пред мес;
SET СуммаРостаОстаткиИзлишки540ПредМес.Comment = Сумма роста Излишки 540 по себестоимости на конец месяца, тыс.руб. к предыдущему месяцу;
let ОстаткиИзлишки540ПредГод = replace(replace('Money(Sum({<ТипПериода={~~~Год~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540ПредГод.Label = Излишки 540 по себестоимости на конец месяца, тыс.руб. пред. (1) Год;
SET ОстаткиИзлишки540ПредГод.Comment = Излишки 540 по себестоимости на конец месяца, тыс.руб. за пред год;
let ПроцентОстаткиИзлишки540ПредГод = replace(replace('Money(@(ОстаткиИзлишки540)/@(ОстаткиИзлишки540ПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиИзлишки540ПредГод.Label = % изм. Излишки 540 по себестоимости на конец месяца, тыс.руб. к пред. (1) Год;
SET ПроцентОстаткиИзлишки540ПредГод.Comment = Процент от Излишки 540 по себестоимости на конец месяца, тыс.руб. к предыдущему году;
let СуммаРостаОстаткиИзлишки540ПредГод = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки540ПредГод.Label = ∆ изм. Излишки 540по себестоимости на конец месяца, тыс.руб. к пред. (1) Год;
SET СуммаРостаОстаткиИзлишки540ПредГод.Comment = Изменение Излишки 540 по себестоимости на конец месяца, тыс.руб. к предыдущему году;
let ОстаткиИзлишки540ПредГод2 = replace(replace('Money(Sum({<ТипПериода={~~~Год-2~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540ПредГод2.Label = Излишки 540 по себестоимости на конец месяца, тыс.руб. пред. (2) Год;
SET ОстаткиИзлишки540ПредГод2.Comment = Излишки 540по себестоимости на конец месяца, тыс.руб. за предпред год;
let ПроцентОстаткиИзлишки540ПредГод2 = replace(replace('Money(@(ОстаткиИзлишки540)/@(ОстаткиИзлишки540ПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиИзлишки540ПредГод2.Label = % изм. Излишки 540 по себестоимости на конец месяца, тыс.руб. к пред. (2) Год;
SET ПроцентОстаткиИзлишки540ПредГод2.Comment = Процент Излишки 540 по себестоимости на конец месяца, тыс.руб. к предпредыдущему году;
let СуммаРостаОстаткиИзлишки540ПредГод2 = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки540ПредГод2.Label = ∆ изм. Излишки по себестоимости на конец месяца, тыс.руб. к пред. (2) Год;
SET СуммаРостаОстаткиИзлишки540ПредГод2.Comment = Изменение Излишки по себестоимости на конец месяца, тыс.руб. к предпредыдущему году;
let ОстаткиИзлишки90 = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 90~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки90.Label = Излишки 90 по себестоимости на конец месяца, тыс.руб.;
SET ОстаткиИзлишки90.Comment = Излишки 90 по себестоимости на конец месяца, тыс.руб.;
let ОстаткиИзлишки90ПредМес = replace(replace('Money(Sum({<ТипПериода={~~~ГодМесяц~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 90~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки90ПредМес.Label = Излишки 90 по себестоимости на конец пред мес, тыс.руб.;
SET ОстаткиИзлишки90ПредМес.Comment = Излишки 90 по себестоимости на конец предыдущего месяца, тыс.руб.;
let СуммаРостаОстаткиИзлишки90ПредМес = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредМес),~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки90ПредМес.Label = Сумма роста Излишки 90 по себестоимости на конец месяца, тыс.руб. к пред мес;
SET СуммаРостаОстаткиИзлишки90ПредМес.Comment = Сумма роста Излишки 90 по себестоимости на конец месяца, тыс.руб. к предыдущему месяцу;
let ОстаткиИзлишки90ПредГод = replace(replace('Money(Sum({<ТипПериода={~~~Год~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 90~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки90ПредГод.Label = Излишки 90 по себестоимости на конец месяца, тыс.руб. пред. (1) Год;
SET ОстаткиИзлишки90ПредГод.Comment = Излишки 90 по себестоимости на конец месяца, тыс.руб. за пред год;
let ПроцентОстаткиИзлишки90ПредГод = replace(replace('Money(@(ОстаткиИзлишки540)/@(ОстаткиИзлишки540ПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиИзлишки90ПредГод.Label = % изм. Излишки 90 по себестоимости на конец месяца, тыс.руб. к пред. (1) Год;
SET ПроцентОстаткиИзлишки90ПредГод.Comment = Процент от Излишки 90 по себестоимости на конец месяца, тыс.руб. к предыдущему году;
let СуммаРостаОстаткиИзлишки90ПредГод = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредГод),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки90ПредГод.Label = ∆ изм. Излишки 90 по себестоимости на конец месяца, тыс.руб. к пред. (1) Год;
SET СуммаРостаОстаткиИзлишки90ПредГод.Comment = Изменение Излишки 90 по себестоимости на конец месяца, тыс.руб. к предыдущему году;
let ОстаткиИзлишки90ПредГод2 = replace(replace('Money(Sum({<ТипПериода={~~~Год-2~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 90~~~},@(СбросФильтраПоОстаткам)>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки90ПредГод2.Label = Излишки 90 по себестоимости на конец месяца, тыс.руб. пред. (2) Год;
SET ОстаткиИзлишки90ПредГод2.Comment = Излишки 90 по себестоимости на конец месяца, тыс.руб. за предпред год;
let ПроцентОстаткиИзлишки90ПредГод2 = replace(replace('Money(@(ОстаткиИзлишки540)/@(ОстаткиИзлишки540ПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ПроцентОстаткиИзлишки90ПредГод2.Label = % изм. Излишки 90 по себестоимости на конец месяца, тыс.руб. к пред. (2) Год;
SET ПроцентОстаткиИзлишки90ПредГод2.Comment = Процент Излишки 90 по себестоимости на конец месяца, тыс.руб. к предпредыдущему году;
let СуммаРостаОстаткиИзлишки90ПредГод2 = replace(replace('Money(@(ОстаткиИзлишки540)-@(ОстаткиИзлишки540ПредГод2),~~~# ##0,00%~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET СуммаРостаОстаткиИзлишки90ПредГод2.Label = ∆ изм. Излишки 90 по себестоимости на конец месяца, тыс.руб. к пред. (2) Год;
SET СуммаРостаОстаткиИзлишки90ПредГод2.Comment = Изменение Излишки 90 по себестоимости на конец месяца, тыс.руб. к предпредыдущему году;
let ОстаткиИзлишки540НаКонецМесяца = replace(replace('Money(Sum({<ТипПериода={~~~Current~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам),_МесяцПоПорядку={~~~@(=Max({<_ФлагДействующаяДата={1}>} _МесяцПоПорядку))~~~}>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540НаКонецМесяца.Label = Излишки 540 по себестоимости на конец месяца, тыс.руб.;
SET ОстаткиИзлишки540НаКонецМесяца.Comment = Излишки 540 по себестоимости на конец месяца, тыс.руб.;
let ОстаткиИзлишки540ПредМесНаКонецМесяца = replace(replace('Money(Sum({<ТипПериода={~~~ГодМесяц~~~},ТипДокумента={~~~OnHandEoM~~~},ПризнакИзлишкиИсторический={~~~Излишки 540~~~},@(СбросФильтраПоОстаткам),_МесяцПоПорядку={~~~@(=Max({<_ФлагДействующаяДата={1}>} _МесяцПоПорядку))~~~}>} Себестоимость)/1000,~~~# ##0,00~~~)','~~~', chr(39)), '@(', chr(36) & '(');
SET ОстаткиИзлишки540ПредМесНаКонецМесяца.Label = Излишки 540 по себестоимости на конец пред мес, тыс.руб.;
SET ОстаткиИзлишки540ПредМесНаКонецМесяца.Comment = Излишки 540 по себестоимости на конец предыдущего месяца, тыс.руб.;
